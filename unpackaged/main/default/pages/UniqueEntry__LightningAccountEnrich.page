<apex:page standardController="Account" extensions="UniqueEntry.uniqueAccountEnrich">

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"></link>
  <apex:styleSheet value="{!URLFOR($Resource.UniqueEntry__bootstrap4, 'bootstrap-4.3.1-dist/css/bootstrap.min.css')}" />
  <apex:styleSheet value="{!URLFOR($Resource.UniqueEntry__fontAwesome, 'font-awesome-4.7.0/css/font-awesome.min.css')}" />
  <apex:includeScript value="{!$Resource.UniqueEntry__jQuery3}" />

 
  <style>
    div.logo {
      position: absolute; 
      top: 5px; 
      right: 5px;
      background-color: #ffffff;
      height: 40px;
      width: 200px;
    }

    ::-webkit-scrollbar {
          display: block !important;
          width: 3px;
          height: 3px;
    }

      /* Track */
    ::-webkit-scrollbar-track {
          box-shadow: inset 0 0 5px #0072BF; 
          border-radius: 5px;
      }
       
      /* Handle */
    ::-webkit-scrollbar-thumb {
          background: #0072BF; 
  
      }

      /* Handle on hover */
    ::-webkit-scrollbar-thumb:hover {
          background: grey; 
      }



    span{
      display: block;
    }

    p{
      display: inline;
      overflow-wrap: break-word;
    }

     #titlerow{
        height: 50px; z-index: 10;
        background-color: #ffffff;
        padding: 0 !important;
        -moz-border-radius: 4px;
        border-top: 1px solid #ddd;
        border-right: 1px solid #ddd;
        border-left: 1x solid #ddd;
        border-bottom: 1x solid #ddd;
        -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
        box-shadow: 0 6px 12px rgba(0,0,0,.175);
        -moz-box-shadow: 0 6px 12px rgba(0,0,0,.175);
        background-clip: padding-box;
        opacity: 0.97;
        filter: alpha(opacity=97);
        
    }

    div.row{
      margin-right: 0px;
      margin-left: 0px;

    }

    .container{
        width: 100% !important;
        display: inline-block;
        height: 550px;
    }

    .overviewdetails{
      line-height: 1.0;
      overflow-y: auto; 
      overflow-x: auto; 
      border: 0.5px;
      padding: 5px;
      -webkit-box-shadow: 0 7px 15px rgba(0,0,0,.175);
      box-shadow: 0 7px 15px rgba(0,0,0,.175);
      -moz-box-shadow: 0 7px 15px rgba(0,0,0,.175)

    }

    .ptitle{
      font-size: 50px; 
      font-weight: 300; 
      font-style: normal; 
      font-stretch: normal; 
      line-height: normal; 
      letter-spacing: normal; 
      color: #0072BF;
      border-bottom: #0072BF; 
      border-bottom-style: solid;
      text-align: center;
    }

    .pcontent{
      font-size: 25px; 
      font-weight: 300; 
      font-style: normal; 
      font-stretch: normal;  
      color: #333132;
      text-align: center;
      padding-top: 20px;
      line-height: 1.3;
    }

    .eimg{
        width: 500px;
    }


    .ringleadFont{
        font-family: Arial; 
        font-size: 30px; 
        color: #000000; 
        padding-left: 40px; 
        position: absolute; 
        margin-top: 10px
      }

      .enrichmentFont{
         font-family: Arial; 
         font-size: 30px; 
         font-weight: bold; 
         color: #0072BF; 
         position: absolute; 
         margin-top: 10px; 
         margin-left: 180px
      }

      .detailpagelogo{
        position: absolute; 
        top: 5px;
        right: 50px; 
        background-color: #ffffff 
      }

      .main{
        z-index: 10;
        background-color: #ffffff;
        padding: 0 !important;
        -moz-border-radius: 4px;
        border-bottom: :1px solid #ddd;
        border-left: :1px solid #ddd;
        border-right :1px solid #ddd;
        -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
        box-shadow: 0 6px 12px rgba(0,0,0,.175);
        -moz-box-shadow: 0 6px 12px rgba(0,0,0,.175);
        background-clip: padding-box;
        opacity: 0.97;
        filter: alpha(opacity=97);
        width: 100%;
      }

      .topnav {
        background-color: #ffffff;
        overflow: hidden;
      }

      .topnav a {
        float: left;
        display: block;
        color: #000;
        text-align: center;
        padding: 14px 16px;
        text-decoration: none;
        font-size: 17px;
      }

      a.active {
        color: #fff;
      }

      .topnav a:hover {
        background-color: #ddd;
        color: black;
        text-decoration: none;
      }

      .topnav .active {
        background-color: #0072BF;
        color: white;
      }

      .topnav .icon {
        display: none;
      }

      div.navtab div.navtab-content:not(.active){
        display: none;
      
      }

      .contactlogo {
        float: left; 
        padding-right: 20px; 
        padding-left: 10px;
        width: 98px; 
      }

      .displayText{
          font-family: Arial;
          font-size: 18px;
          font-weight: 2500;
          line-height: 1.6;
          color: #000000;
      }

      .titletext{
        font-weight: 600;
        font-size: 21px;
        color: #0072BF;
      }

      .lowertitle{
        font-weight: 200;
        font-size: 21px;
        color: #0072BF;
      }

      .reenrichbtn{
        height: 80px;
        width: 170px;
      }

      img{
        vertical-align: inherit;
      }



      .rightdiv{
          display: inline-block; 
          vertical-align: middle; 
          padding-left: 10px; 
          padding-right: 5px; 
          width: 60%;
          padding-top: 30px;

      }


      .description{
          opacity: 0.85; 
          border-radius: 5px; 
          box-shadow: 0 4px 6px 0 rgba(0, 0, 0, 0.5); 
          background-color: #eaeaea;
          border: solid 1px #cacaca; 
          padding-left: 10px; 
          padding-right: 10px; 
          padding-bottom: 10px; 
          padding-top: 10px; 
          height: 80px; 
          width: 100%; 
          overflow: auto 
      }
    
      .contactTitle{
        height: 80px;
      }

      .accordion {
          background-color: #ffffff !important;
          cursor: pointer;
          width: 100%;
          border: none;
          text-align: left;
          outline: none;
          font-size: 13px;
          transition: 0.4s;
          color: #0072BF;
      }

      .active, .accordion:hover {
          background-color: #ffffff;
      }

      .accordion:after {
          content: '\002B';
          color: #0072BF;
          font-weight: bold;
          float: right;
          margin-left: 5px;
      }

      .accordion.active:after {
          content: "\2212";
      }

      .panel {
          background-color: white;
          max-height: 0;
          overflow-y: auto;
          overflow-x: auto;
          transition: max-height 0.2s ease-out;
          border: none !important;
      }

      body button {

        border-radius: 0px !important; 
        background: #ffffff;
        margin: 3px;
        padding: 10px 11px;
        box-shadow: 0 2px 3px rgba(0,0,0,.18);
      }

      .col-3{
        padding-left: 5px;
        padding-right: 5px;
        box-shadow: 0 1px 2px rgba(0,0,0,.3);
      }

      .col-9{
        padding-left: 0px;
        padding-right: 5px;
        box-shadow: 0 1px 2px rgba(0,0,0,.18);
      }

      .col-12{
        padding-right: 0px;
        padding-left: 0px;
      }

      .savetosfbtn{
        height: 60px; 
        width: 180px;
      }

      #mySidebar{
        display: block;
      }

      #togglebtn{
        display: none;
      }

      #closebtn{
        border:none;
        float: right;
        box-shadow: 0 1px 2px rgba(0,0,0,.18);
      }

      .textNav{
        display: inline-flex;
      }

    @media screen and (min-width: 601px) {
      div.logo {
        position: absolute; 
        top: 0px;
        right: 5px; 
        background-color: #ffffff; 
        height: 30px;
        width: 150px;     
      }

      .eimg{
        width: 500px;
        margin-left: auto;
        margin-right: auto;
      }

     .ptitle{
      font-size: 35px; 
      font-weight: 300; 
      font-style: normal; 
      font-stretch: normal; 
      line-height: normal; 
      letter-spacing: normal; 
      color: #0072BF;
      border-bottom: #0072BF; 
      border-bottom-style: solid;
      text-align: center;
    }

    .pcontent{
      font-size: 20px; 
      font-weight: 300; 
      font-style: normal; 
      font-stretch: normal;  
      color: #000000;
      text-align: center;
      padding-top: 20px;
      line-height: 1.3;
    }

    .row{
      display: block;
    }

    .ringleadFont{
      font-size: 25px; 
    }

    .enrichmentFont{
      font-size: 25px; 
      margin-left: 180px;
    }

    .detailpagelogo{
        top: 5px;
        right: 50px; 
    }

    .topnav a {
      font-stretch: 15px;
    }

    body{
        line-height: 1.0;
    }

    .displayText{
          font-family: Arial;
          font-size: 13px;
          font-weight: 2500;
          line-height: 1.3;
          color: #000000;
    }

    .titletext{
        font-weight: 600;
        font-size: 16px;
        color: #0072BF;
    }

    .lowertitle{
        font-weight: 200;
        font-size: 16px;
        color: #0072BF;
    }


  }

    @media screen and (max-width: 600px) {
      div.logo {
        position: absolute; 
        top: 5px; 
        right: 5px;
        height: ;
        background-color: #ffffff;
        height: 25px;
        width: 85px;
      }

      .ptitle{
        font-size: 25px; 
        font-weight: 300; 
        font-style: normal; 
        font-stretch: normal; 
        line-height: normal; 
        letter-spacing: normal; 
        color: #0072BF;
        border-bottom: #0072BF; 
        border-bottom-style: solid;
        text-align: center;
      }

      .pcontent{
        font-size: 15px; 
        font-weight: 300; 
        font-style: normal; 
        font-stretch: normal;  
        color: #000000;
        text-align: center;
        padding-top: 20px;
        line-height: 1.5;
      }

      .eimg{
        width: 400px; 
        margin-left: auto;
        margin-right: auto;
      }

     .row{
        display: block;
      }

      .ringleadFont{
        font-size: 15px; 
        padding-left: 25px; 
      }

      .enrichmentFont{
        font-size: 15px; 
        margin-left: 110px
      }

      .detailpagelogo{
        top: 5px;
        right: 15px; 
      }

      #titlerow{
         height: 40px; 
      }

      body{
        line-height: 0.5;
      }

      .contactlogo {
        float: left; 
        padding-right: 20px; 
        padding-left: 10px;
      }

      .displayText{
          font-family: Arial;
          font-size: 14px;
          font-weight: 2500;
          line-height: 1.4;
          color: #000000;
      }

      .titletext{
        font-weight: 600;
        font-size: 16px;
        color: #0072BF;
      }

      .lowertitle{
        font-weight: 200;
        font-size: 16px;
        color: #0072BF;
      }

      .contactTitle{
        
      }

      .description{
        height: 65px; 
        width: 100%; 
      }

      .reenrichbtn{
        height: 70px;
        width: 150px;
      }

      .overviewdetails{
        padding-top: 0px;
      }


      .rightdiv{
          display: inline-block; 
          vertical-align: middle; 
          padding-left: 10px; 
          padding-top: 30px;
          box-shadow: 0 6px 12px rgba(0,0,0,.175);
          width: 100%;
          border-left: none;

      }


      #mySidebar{
        display: none;
      }

      #togglebtn{
        display: block;
      }


      #mySidebarCo{
        display: none;
      }

      #togglebtnCo{
        display: block;
      }

      .mainenrichbtn{
        height: 40px;
        width:150px;
      }

      .textNav{
        display: none;
      }

    }
  </style>
  <apex:form id="form">


    <apex:outputPanel id="display" rendered="{!isEnriched == false}">

    <div>

    <div>
      <div class= "logo">
<!--        <apex:image style="height:100%; width:100%" url="https://www.ringlead.com/wp-content/uploads/2018/01/RIngLead-AMP-Logo.png"> </apex:image>-->
        <apex:image url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/ringlead_new.png')}" height="40" width="110"/>
<!--          <apex:image url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/logo.png')}" width="30" height="30"/>-->

      </div>
      <div style="text-align: center;">
        <p class= "ptitle"> Let's Get Started </p>
      </div>
    </div>


    <div style="padding-top: 40px; text-align: center;"> 
      <p class="pcontent"> You can select the <b> Enrich button </b> if you want your records to be enriched based upon the <b> DMS Enrichment Package </b> you have selected. </p> <br/><br/> <br/> 
    </div>

    <div class="row">
      <div class="col-xs-12 text-center">
        <div class="eimg">
<!--          <apex:image style="padding-top: 5px; padding-bottom: 15px;  width: 100%; height: 100%" url="https://www.ringlead.com/wp-content/uploads/2018/11/JhAaP2nA.png"/>-->
          <apex:image style="padding-top: 5px; padding-bottom: 15px;  width: 100%; height: 100%" url="https://www.ringlead.com/wp-content/uploads/2020/04/enrich-front-text.jpg"/>
        </div>
      </div>
    </div>


    <div style="vertical-align:middle; text-align:center; padding-top: 20px;">

        <apex:actionStatus id="AddStatus">
          <apex:facet name="start">
              <apex:outputPanel >
                <img src="/img/loading32.gif" width="27" height="27" />
              <apex:outputLabel style="font-weight: 100px; font-size: 25px; color: #0072bf; padding-left: 20px;" value="Loading..."/>
          </apex:outputPanel> 
          </apex:facet>
          <apex:facet name="stop">
          <apex:commandbutton image="https://www.ringlead.com/wp-content/uploads/2020/04/enrich_account.jpg" id="updateSalesforceBtn"  action="{!enrichRecord}" status="AddStatus" reRender="form" onComplete="refreshPage();"/>
          </apex:facet>
        </apex:actionStatus>
    

    </div>
    </div>
  
  </apex:outputPanel>

  <apex:outputPanel id="enrichmentPanel" rendered="{!isEnriched == true}">

      <apex:outputPanel id="errorPanel" rendered="{!isError == true}">
        
          
          <div>
            <div class= "logo">
<!--              <apex:image style="height:100%; width:100%" url="https://www.ringlead.com/wp-content/uploads/2018/01/RIngLead-AMP-Logo.png"> </apex:image>-->
<!--              <apex:image url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/ringlead_new.png')}" height="40" width="110"/>-->
                <apex:image url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/logo.png')}" width="30" height="30"/>


            </div>
            <div style="text-align: center;">
              <p class= "ptitle"> Let's Get Started </p>
            </div>
           <div class="row main">
          </div>

          <div style="padding-left: 20px; padding-top: 30px; padding-right: 20px;">
            
            <p class="pcontent"> <apex:image title="Error" url="https://www.ringlead.com/wp-content/uploads/2018/11/outline-announcement-24px_OJ.png" width="35" height="35"/> &nbsp; {!errorMessage} </p>
            <p class="pcontent" style="padding-top: 20px; text-align: center;"> Please contact RingLead support. Ask your RingLead admin to log in to RingLead or send an email to <a href="email:support@ringlead.com">support@ringlead.com</a></p>

          </div>

      </div>
      
    </apex:outputPanel>

    <apex:outputPanel id="detailsPanel" rendered="{!isError == false}">

      <div class="container-fluid" id="container" style="padding-top: 20px; padding-right: 0px;">

        <div class ="row" id ="titlerow">
          <p><span class="ringleadFont"> RINGLEAD </span>
          <span class="enrichmentFont"> ENRICHMENT </span>
          </p>
        </div>

        <div class="row main">
          <div class="row ">

            <div class="topnav" id="myTopnav">
              <a href="#home" class="navItems active"><i class="fa fa-home"></i> <span class="textNav"> &nbsp;  Overview </span> </a>
              <a href="#company" class= "navItems"><i class="fa fa-building"></i> <span class="textNav"> &nbsp; Company </span> </a>
              <!-- <a href="javascript:void(0);" class="icon" onclick="myFunction()">
                <i class="fa fa-bars"></i>
              </a> -->
            </div>

            <div class="row navtab">
              <div class="navtab-content active">
                  <div class="overviewdetails" id="overviewdetails">
                      <div class="rightdiv">
                        <div class="contactTitle">
                            <div class="contactlogo" >
                              <apex:image url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/companyIcon.png')}" width="100%" />
                            </div>
                            <div style="display: grid;">
                              <span class="titletext" id="companyName" title="Company Name"></span>
                              <span class="displayText" id="public" title="Public"> </span> 
                              <span class="lowertitle" id="industryCo" title ="Industry">  </span> 
                            </div>
                          </div>
                          <br/>
                          <div class ="overviewContent" style="padding-left: 40px;">
                             <span> <apex:image title="Revenue" url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/revenue.png')}" width="20" height="20"/> <p class="displayText" id="revenue"> &ensp; </p> </span>
                           <span> <apex:image title="Number of Employees" url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/employees.png')}" width="20" height="20"/> <p class="displayText" id="employees"> &ensp;  </p> </span>
                           <span> <apex:image title="HQ Phone" url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/hphone.png')}" width="20" height="20"/> <p class="displayText" id="phoneco"> &ensp; </p> &nbsp; <apex:image value="https://www.ringlead.com/wp-content/uploads/2018/10/verification-Verified.png" width="20" height="20" rendered="{!verificationMap['Phone1']=='Verified'}" title="Phone- Verified" />  <apex:image title="Phone - Not Verified" value="https://www.ringlead.com/wp-content/uploads/2018/10/verification-Not-Verified.png" width="20" height="20" rendered="{!verificationMap['Phone1']=='Not Verified'}" /> </span>
                           <br/>
                           <span> <apex:image title="Location" url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/location.png')}" width="20" height="20"/> <p class="displayText" id="address"> &ensp;  </p> &nbsp; <apex:image value="https://www.ringlead.com/wp-content/uploads/2018/10/verification-Verified.png" width="20" height="20" rendered="{!verificationMap['WorkAddress']=='Verified'}" title="Address Verified"/>  <apex:image value="https://www.ringlead.com/wp-content/uploads/2018/10/verification-Not-Verified.png" width="20" height="20" rendered="{!verificationMap['WorkAddress']=='Not Verified'}" title="Address- Not Verified"/> </span>
                           <span> <apex:image title="Website" url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/website.png')}" width="20" height="20"/> <p class="displayText" id="website"> &ensp; </p> </span>
                           <span style="padding-top: 15px;"> <p class="displayText"> COMPANY DESCRIPTION </p> </span>
                           <span class="description"> <p class="displayText" style="" id="description"> </p> </span> 
                          </div>
                      </div>


                      <div class="col-12" style="padding-top: 30px; text-align: -webkit-center; ">
                        <div class="reenrichbtn">
                        <apex:actionStatus id="AddStatusEnrich">
                          <apex:facet name="start">
                            <apex:outputPanel >
                              <img src="/img/loading32.gif" width="27" height="27" />
                              <apex:outputLabel style="font-weight: 100px; font-size: 25px; color: #0072bf; padding-left: 20px;" value="Loading..."/>
                            </apex:outputPanel> 
                          </apex:facet>
                          <apex:facet name="stop">
                            <apex:commandbutton image="https://www.ringlead.com/wp-content/uploads/2020/04/reenrich.jpg"  action="{!reEnrichRecord}" style="width: 100%;" status="AddStatusEnrich" reRender="form" onComplete="refreshPage();"/>
                          </apex:facet>
                        </apex:actionStatus>
                        </div>
                      </div>
                    </div>

              </div>

              <div class="navtab-content" id="companyDetails">
                <div class = "row">         

                  <div class = "col-3" style="overflow: auto; float:left;">

                    <div class="w3-sidebar w3-bar-block w3-border-right" id="mySidebar">
                      <button onclick="w3_close(); return false; " type="button"  id="closebtn" class="w3-bar-item w3-large">Close &times;</button>
                      <button type="button" class="accordion active" id="profile" ><!--  <apex:image url="{!URLFOR($Resource.logos, 'logos/contactProfile.png')}"/>  -->  Company Basic </button>
                      <div class="panel" id="basicPanel" style ="max-height: 100px;"> </div>

                      <button type="button" class="accordion active" id="contact" > <!-- <apex:image url="{!URLFOR($Resource.logos, 'logos/industry.png')}" width="21" height="21"/>  --> Firmographics </button>
                      <div class="panel" id="firmoPanel" style ="max-height: 100px;"></div>

                      <button type="button" class="accordion active" id="employment" > <!-- <apex:image url="{!URLFOR($Resource.logos, 'logos/employment.png')}" width="21" height="21"/> --> Financial </button>
                      <div class="panel" id="financePanel" style ="max-height: 100px;"></div>

                      <button type="button" class="accordion active" id="employment" > <!-- <apex:image url="{!URLFOR($Resource.logos, 'logos/employment.png')}" width="21" height="21"/> --> Firmographic Location </button>
                    <div class="panel" id="firmographicPanel" style ="max-height: 100px;"></div>
                  </div>
                </div>


                <div id="enrichmentDiv" class = "col-9" style="overflow: auto;">
                  <button type="button" id="togglebtn" class="w3-button w3-teal w3-xlarge" onclick="w3_open()">☰</button>
                  <div class="col-12 text-center" id="Container">    
                      <table class="table table-striped" id = "fieldTable">
                        <thead id="tablehead">
                          <tr>
                            <th class="tableHeader"> FIELD </th>
                            <th class="tableHeader"> <apex:image url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/salesforce@2x.png')}" width="55" height="45"/> &nbsp; BEFORE ENRICHMENT</th>
                            <th class="tableHeader" style="color: #0072BF; "> <apex:image url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/logo.png')}" width="30" height="30"/> &nbsp; AFTER ENRICHMENT</th>
                          </tr>
                        </thead>
                        <tbody id="tablebody">
                          <tr></tr>
                        </tbody>
                      </table>
                      <div style="padding-top: 30px; padding-bottom: 30px; text-align: -webkit-center;">
                        <div class="savetosfbtn">
                          <apex:commandbutton image="https://www.ringlead.com/wp-content/uploads/2020/04/save_to_sf.jpg" id="updateSalesforce1" style="width:100%;" reRender="contactDetails" onclick="updateSalesforce();" />
                          <apex:actionFunction name="actionfunc" action="{!enrichButton}" oncomplete="refreshPage();">
                            <apex:param value="" name="array" assignTo="{!stringArr}" />
                        </apex:actionFunction>
                        </div>
                      </div>
                  </div>
                </div>


              </div>
            </div>


          </div>
        </div>
      </div>

      </div>

      <div class="detailpagelogo" >
<!--        <apex:image value="{!$Resource.RingleadLogo1}" /> -->
<!--        <apex:image url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/ringlead_new.png')}" height="40" width="100"/>-->
          <apex:image url="{!URLFOR($Resource.UniqueEntry__logos, 'logos/logo.png')}" width="30" height="30"/>

      </div>

    
    
    </apex:outputPanel>

  </apex:outputPanel>


  <script type="text/javascript">

        function myFunction() {
              var x = document.getElementById("myTopnav");
              if (x.className === "topnav") {
                x.className += " responsive";
              } else {
                x.className = "topnav";
              }
            }

            if ($(window).width() < 600) {
                $('#enrichmentDiv').addClass('col-9');

            } 

            $(window).on('resize', function(){
               var win = $(this);
               if (win.width() < 600) { 
                $('#enrichmentDiv').addClass('col-9');
               }
            });

           function w3_open() {
              document.getElementById("mySidebar").style.display = "block";
              document.getElementById("enrichmentDiv").className = "col-9";
              document.getElementById("togglebtn").style.display = "none";
          }

            function w3_close() {
              document.getElementById("mySidebar").style.display = "none";
              document.getElementById("enrichmentDiv").className = "col-12";
              document.getElementById("togglebtn").style.display = "block";
          }

            function myFunction() {
              var x = document.getElementById("myTopnav");
              if (x.className === "topnav") {
                x.className += " responsive";
              } else {
                x.className = "topnav";
              }
            }

            if ($(window).width() < 600) {
                $('#enrichmentDiv').addClass('col-12');

            } 

            $(window).on('resize', function(){
               var win = $(this);
               if (win.width() < 600) { 
                $('#enrichmentDiv').addClass('col-12');
               }
            });

          var beforeEnrichment = JSON.parse('{!JSENCODE(beforeEnrichment)}') ;
          var afterEnrichment= JSON.parse('{!JSENCODE(afterEnrichment)}');
          var companyFirmoApiNames = JSON.parse('{!JSENCODE(companyFirmoApiNames)}');
          var companyBasicApiNames = JSON.parse('{!JSENCODE(companyBasicApiNames)}');
          var financialApiNames = JSON.parse('{!JSENCODE(financialApiNames)}');
          var firmLocationApiNames = JSON.parse('{!JSENCODE(firmLocationApiNames)}');
          var overviewContact = JSON.parse('{!JSENCODE(overviewContact)}');
          var overviewCompany = JSON.parse('{!JSENCODE(overviewCompany)}');
          var verificatonDetails = JSON.parse('{!JSENCODE(verificationDetails)}');
          var labelMap = JSON.parse('{!JSENCODE(sFLabelDetails)}');
          var apiNames = []; 
          apiNames.push.apply(apiNames, companyFirmoApiNames);
          apiNames.push.apply(apiNames, companyBasicApiNames);
          apiNames.push.apply(apiNames, financialApiNames);
          apiNames.push.apply(apiNames, firmLocationApiNames);
          console.log('beforeEnrichment       ' + beforeEnrichment);
          console.log('afterEnrichment       ' + afterEnrichment);
          console.log('companyFirmoApiNames       ' + companyFirmoApiNames);
          console.log('companyBasicApiNames       ' + companyBasicApiNames);
          console.log('financialApiNames       ' + financialApiNames);
          console.log('firmLocationApiNames       ' + firmLocationApiNames);
          console.log('overviewContact       ' + overviewContact);
          console.log('overviewCompany       ' + overviewCompany);

     $("div.topnav>a").click(function(e) {
            e.preventDefault();
            $(this).siblings('a.active').removeClass("active");
            $(this).addClass("active");
            var index = $(this).index();
            $("div.navtab>div.navtab-content").removeClass("active");
            $("div.navtab>div.navtab-content").eq(index).addClass("active");
        });

 //var basicflag =0, firmoflag =0; financeflag =0, locationflag = 0; 
  var acc = document.getElementsByClassName("accordion");
  var i;



  //adding company details
  var hqcity = (overviewCompany['HQCity'] != null) ? overviewCompany['HQCity'] : '-';
  console.log('hqcity ' +hqcity);
  var hqcountry = (overviewCompany['HQCountry'] != null) ? overviewCompany['HQCountry'] : '-' ;
  console.log('hqcountry ' +hqcountry);
  var hqstate = (overviewCompany['HQState'] != null) ? overviewCompany['HQState'] : '-';
  console.log('hqstate' +hqstate);
  var hqzip = (overviewCompany['HQZip'] != null) ? overviewCompany['HQZip'] : '-';
  console.log('hqzip ' +hqzip);
  var comRevenue =  overviewCompany['Revenue'];
  formattedRevenue = formatNumber(comRevenue);
  var emp = overviewCompany['Employees'];
  formattedEmp = formatNumber(emp);
  document.getElementById("companyName").innerHTML = (overviewCompany['CompanyName'] != null) ? overviewCompany['CompanyName'] : '-';
  document.getElementById("public").innerHTML = (overviewCompany['Public'] != null) ? overviewCompany['Public'] : '-' ;
  document.getElementById("industryCo").innerHTML = (overviewCompany['Industry'] != null) ? overviewCompany['Industry'] : '-' ;
  document.getElementById("revenue").innerHTML += (overviewCompany['Revenue'] != null) ? formattedRevenue : '-' ;
  document.getElementById("employees").innerHTML += (overviewCompany['Employees'] != null) ? formattedEmp + '  employees' : '-' ;
  document.getElementById("phoneco").innerHTML += (overviewCompany['Phone1'] != null) ? overviewCompany['Phone1'] : '-' ;
  document.getElementById("address").innerHTML += (overviewCompany['HQStreet1'] != null) ? overviewCompany['HQStreet1'] : '-';
  document.getElementById("address").innerHTML += '    ' + hqcity + '    ' + hqstate + '    '+ hqcountry + '    ' + hqzip;
  var token = (overviewCompany['Website'] != null) ? overviewCompany['Website'] : '-';
  document.getElementById("website").innerHTML += "<a href='"+ token +"' >"+ token +"</a>";
 // document.getElementById("website").innerHTML += (overviewCompany['Website'] != null) ? overviewCompany['Website'] : '-' ;
  document.getElementById("description").innerHTML = (overviewCompany['CompanyDescription'] != null) ? overviewCompany['CompanyDescription'] : '-' ;


  //automatically add all the fields 
   var table = document.getElementById('fieldTable');
   console.log(fieldTable);
  //companyBasicApiNames

   for(var i=0; i<companyBasicApiNames.length; i++){
      var displayField = companyBasicApiNames[i];
      var rowCount = table.rows.length;
      console.log(rowCount);
      var row = table.insertRow(rowCount);
      var cell1 = row.insertCell(0);
      var element1 = document.createElement("label");
      element1.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      element1.innerHTML = labelMap[displayField];
      console.log(element1.innerHTML);
      cell1.appendChild(element1);
      var cell2 = row.insertCell(1);
      var element2 = document.createElement("label");
      element2.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      if(beforeEnrichment[displayField] === undefined){
          element2.innerHTML = '';
      }
      else{
          var beforeval = beforeEnrichment[displayField];
          try{
            // if(/^\d+$/.test(beforeval)){
            //   var test = formatNumber(beforeval);
            //   element2.innerHTML = test;
            // }
            //else{
              element2.innerHTML = beforeEnrichment[displayField];
            //}
          }
          catch(e){
            console.log('Exception:   ' + e);
          }
       
      }
          
      cell2.appendChild(element2);
      var cell3 = row.insertCell(2);
      var element3 = document.createElement("label");
      element3.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      var afterval = afterEnrichment[displayField];
      if(afterval == undefined){
          element3.innerHTML = '';
      }else{
        try{
          // if(/^\d+$/.test(afterval) ){
          //   var test = formatNumber(afterval);
          //   element3.innerHTML = test;
          // }
          // else{
              element3.innerHTML = afterEnrichment[displayField];
          // }
        }
        catch(e){
          console.log('Exception:: ' + e);
        }
      }
        
      cell3.appendChild(element3);
   }

//companyFirmoApiNames 

   for(var i=0; i<companyFirmoApiNames.length; i++){
      var displayField = companyFirmoApiNames[i];
      var rowCount = table.rows.length;
      console.log(rowCount);
      var row = table.insertRow(rowCount);
      var cell1 = row.insertCell(0);
      var element1 = document.createElement("label");
      element1.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      element1.innerHTML = labelMap[displayField];
      console.log(element1.innerHTML);
      cell1.appendChild(element1);
      var cell2 = row.insertCell(1);
      var element2 = document.createElement("label");
      element2.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      if(beforeEnrichment[displayField] === undefined){
          element2.innerHTML = '';
      }
      else{
          element2.innerHTML = beforeEnrichment[displayField];
      }
          
      cell2.appendChild(element2);
      var cell3 = row.insertCell(2);
      var element3 = document.createElement("label");
      element3.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      element3.innerHTML =  afterEnrichment[displayField];
      cell3.appendChild(element3);
   }

//financialApiNames

    for(var i=0; i<financialApiNames.length; i++){
      var displayField = financialApiNames[i];
      var rowCount = table.rows.length;
      console.log(rowCount);
      var row = table.insertRow(rowCount);
      var cell1 = row.insertCell(0);
      var element1 = document.createElement("label");
      element1.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      element1.innerHTML = labelMap[displayField];
      console.log(element1.innerHTML);
      cell1.appendChild(element1);
      var cell2 = row.insertCell(1);
      var element2 = document.createElement("label");
      element2.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      if(beforeEnrichment[displayField] === undefined){
          element2.innerHTML = '';
      }
      else{
        try{
            var val = beforeEnrichment[displayField];
            var isnum = /^\d+$/.test(val);
            if(isnum){
              var test = formatNumber(val);
              console.log('Formatted Revenue:::    ' + test);
              element2.innerHTML = test;
            }

            else{
              element2.innerHTML = beforeEnrichment[displayField];
            }
        }
        catch(e){
            console.log('Exception::    ' + e);
        }
            
      }
          
      cell2.appendChild(element2);
      var cell3 = row.insertCell(2);
      var element3 = document.createElement("label");
      element3.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      var afterval =  afterEnrichment[displayField];
        try{
          if(/^\d+$/.test(afterval)){
              var test = formatNumber(afterval);
              console.log('Formatted Revenue:::    ' + test);
              element3.innerHTML = test;
          }
          else{
            element3.innerHTML =  afterEnrichment[displayField];
          }
        }
        catch(e){
          console.log('Exception:   ' +e);
        }
       
        
        cell3.appendChild(element3);
     }


//firmLocationApiNames

  for(var i=0; i<firmLocationApiNames.length; i++){
      var displayField = firmLocationApiNames[i];
      var rowCount = table.rows.length;
      console.log(rowCount);
      var row = table.insertRow(rowCount);
      var cell1 = row.insertCell(0);
      var element1 = document.createElement("label");
      element1.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      element1.innerHTML = labelMap[displayField];
      console.log(element1.innerHTML);
      cell1.appendChild(element1);
      var cell2 = row.insertCell(1);
      var element2 = document.createElement("label");
      element2.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      if(beforeEnrichment[displayField] === undefined){
          element2.innerHTML = '';
      }
      else{
          element2.innerHTML = beforeEnrichment[displayField];
      }
          
      cell2.appendChild(element2);
      var cell3 = row.insertCell(2);
      var element3 = document.createElement("label");
      element3.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
      element3.innerHTML =  afterEnrichment[displayField];
      cell3.appendChild(element3);
   }

//adding to the panel:   

  for(var i=0; i<companyBasicApiNames.length; i++){
          var fieldname = companyBasicApiNames[i];
          //console.log(fieldname);
          var fieldLabel = labelMap[fieldname];
          var span = document.createElement('span');
          span.style = "  width: 200px;  font-family: Arial; font-weight: 400; font-size: 13px; font-style: normal;font-stretch: expanded;line-height: normal;letter-spacing: extra-expanded;color: #000000; padding-bottom: 2px; padding-top: 2px; padding-left: 5px;";
          var v = document.createElement('input');
          v.className = 'checkmark';
          v.type="checkbox";
          v.value=fieldLabel;
          v.id = fieldLabel;
          v.checked = true;
          //handleCheckboxChange();
          v.onclick = handleCheckboxChange;
          // v.style = "input:checked ~ .checkmark {background-color: #2196F3;} "
          span.appendChild(v);
          span.appendChild(document.createTextNode('   ' + fieldLabel));
          document.getElementById('basicPanel').appendChild(span);
  }

  for(var i=0; i<companyFirmoApiNames.length; i++){
          var fieldname = companyFirmoApiNames[i];
          //console.log(fieldname);
          var fieldLabel = labelMap[fieldname];
          var span = document.createElement('span');
          span.style = "  width: 200px; font-family: Arial; font-weight: 400; font-size: 13px; font-style: normal;font-stretch: expanded;line-height: normal;letter-spacing: extra-expanded  ;color: #000000; padding-bottom: 2px; padding-top: 2px; padding-left: 5px;";
          var v = document.createElement('input');
          v.className = 'checkmark';
          v.type="checkbox";
          // v.style = "input:checked ~ .checkmark {background-color: #2196F3;} "
          v.value=fieldLabel;
          v.id = fieldLabel;
          v.checked = true;
          //handleCheckboxChange();
          v.onclick = handleCheckboxChange;
          span.appendChild(v);
          span.appendChild(document.createTextNode('   ' + fieldLabel));
          document.getElementById('firmoPanel').appendChild(span);
  }

   for(var i=0; i<financialApiNames.length; i++){
          var fieldname = financialApiNames[i];
          //console.log(fieldname);
          var fieldLabel = labelMap[fieldname];
          var span = document.createElement('span');
          span.style = "  width: 200px;  font-family: Arial; font-weight: 400; font-size: 13px; font-style: normal;font-stretch: expanded;line-height: normal;letter-spacing: extra-expanded;color: #000000; padding-bottom: 2px; padding-top: 2px; padding-left: 5px;";
          var v = document.createElement('input');
          v.className = 'checkmark';
          v.type="checkbox";
          v.value=fieldLabel;
          v.id = fieldLabel;
          v.checked = true;
          //handleCheckboxChange();
          v.onclick = handleCheckboxChange;
          // v.style = "background-color: #2196F3;"
          span.appendChild(v);
          span.appendChild(document.createTextNode('   ' + fieldLabel));
          document.getElementById('financePanel').appendChild(span);
    }

  for(var i=0; i<firmLocationApiNames.length; i++){
          var fieldname = firmLocationApiNames[i];
          //console.log(fieldname);
          var fieldLabel = labelMap[fieldname];
          var span = document.createElement('span');
          span.style = "  width: 200px;  font-family: Arial; font-weight: 400; font-size: 13px; font-style: normal;font-stretch: expanded;line-height: normal;letter-spacing: extra-expanded;color: #000000; padding-bottom: 2px; padding-top: 2px; padding-left: 5px;";
          var v = document.createElement('input');
          v.className = 'checkmark';
          v.type="checkbox";
          v.value=fieldLabel;
          v.id = fieldLabel;
          v.checked = true;
          //handleCheckboxChange();
          v.onclick = handleCheckboxChange;
          // v.style = "background-color: #2196F3;"
          span.appendChild(v);
          span.appendChild(document.createTextNode('   ' + fieldLabel));
          document.getElementById('firmographicPanel').appendChild(span);
    }


  for (i = 0; i < acc.length; i++) {
    console.log('Accordion   ' + acc[i]);
    acc[i].addEventListener("click", function() {
      var id = document.querySelector('.accordion').id;
      //console.log(id);
      this.classList.toggle("active");
      var panel = this.nextElementSibling;
      //console.log(panel);
      if (panel.style.maxHeight){
        panel.style.maxHeight = null;
      } else {
        panel.style.maxHeight = panel.scrollHeight + "px";
      } 
      
      var panelId = document.querySelector('.panel').id;
      

    });
  }


    function refreshPage(){

      console.log('Refreshing Page');
      var url = '{!JSENCODE(url)}';
      try{
        window.top.location = url;
      }catch(e){
        console.log(e);
      }
     
    }



    function updateSalesforce(){

      console.log('API NAMES:' + apiNames);

      if(apiNames.length == 0){
        alert ('Please select fields to Enrich');
      }

      else{
        var stingList = apiNames.toString();
        actionfunc(stingList);

        refreshPage();

      }
    }


 function formatNumber(num){
       var result;
      try{
        if(num != null){
           var strNum = num.toString();
                if(strNum.length <=3){
                    return strNum;
                }
                result = strNum.charAt(strNum.length-1);
                count = 1;
                for(var i=strNum.length-2; i>=0; i--){
                    if(count == 3){
                        result = strNum.charAt(i)+',' + result;
                        count = 1;
                    }else{
                        result = strNum.charAt(i) + '' + result;
                        count++;
                    }
                }
        }
          
        return result;
      }
      catch(e){
        console.log(e);
        return null;
      }
    

    }
    function handleCheckboxChange(){
      console.log('Checkbox clicked');
      console.log(this.id);
      var id = this.id;
        const keyAPIName = Object.keys(labelMap).find(key => labelMap[key] === id);
        console.log(keyAPIName);

      //console.log(this.parent.id);
      if(document.getElementById(this.id).checked){
        apiNames.push(keyAPIName);
        console.log('checked');
        var table = document.getElementById('fieldTable');
        console.log(fieldTable);
        var rowCount = table.rows.length;
        console.log(rowCount);
        var row = table.insertRow(rowCount);
        var cell1 = row.insertCell(0);
        var element1 = document.createElement("label");
        element1.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
        element1.innerHTML = id;
        console.log(element1.innerHTML);
        cell1.appendChild(element1);

        var cell2 = row.insertCell(1);
        var element2 = document.createElement("label");
        element2.style = "font-weight: 400; font-size: 13px;line-height: 1.0;";
        if(beforeEnrichment[keyAPIName] === undefined){
          element2.innerHTML = '';
        }
        else{
          if(keyAPIName == 'NumberOfEmployees'|| keyAPIName == 'AnnualRevenue'){
              if(/^\d+$/.test(beforeEnrichment[keyAPIName])){
                  var test = formatNumber(beforeEnrichment[keyAPIName]);
                  console.log('Formatted Revenue:::    ' + test);
                  element2.innerHTML = test;
              }
            }
            else{
              element2.innerHTML = beforeEnrichment[keyAPIName];
            }

         // element2.innerHTML = beforeEnrichment[keyAPIName];
        }
        
        cell2.appendChild(element2);

        var cell3 = row.insertCell(2);
        var element3 = document.createElement("label");
        element3.style = "font-weight: 400; font-size: 13px;";
        if(keyAPIName == 'NumberOfEmployees'|| keyAPIName == 'AnnualRevenue'){
              if(/^\d+$/.test(afterEnrichment[keyAPIName])){
                  var test = formatNumber(afterEnrichment[keyAPIName]);
                  console.log('Formatted Revenue:::    ' + test);
                  element3.innerHTML = test;
              }
        }
        else{
              element3.innerHTML =  afterEnrichment[keyAPIName];
        }
        //element3.innerHTML =  afterEnrichment[keyAPIName];
        cell3.appendChild(element3);

      }

      else{

          console.log(apiNames);
          var index = apiNames.indexOf(keyAPIName);
          if (index > -1) {
            apiNames.splice(index, 1);
          }
          console.log(apiNames);
          console.log('unchecked');

          var table = document.getElementById('fieldTable');
          try{
          for (var i = 0, row; row = table.rows[i]; i++) {
            if(row.cells[0] == undefined){}
            else{
                console.log(row.cells[0].innerHTML);
                if((row.cells[0].innerHTML).includes(id)){
                    table.deleteRow(i);
                  }
              }

          }
          }catch(e){
            console.log('Exception:    ' + e);
          }

      }

    }

        //remove empty table rows
        $('#tablebody tr').each(function () {
            if (!$.trim($(this).text())) $(this).remove();
        });


  </script>

  </apex:form>


</apex:page>