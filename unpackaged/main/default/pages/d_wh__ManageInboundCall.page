<apex:page standardController="d_wh__Inbound_Call_Template__c" extensions="d_wh.ManageInboundCall" docType="html-5.0">

    <script src="{!URLFOR($Resource.jQuery)}"></script>
    <script>
        var j$ = jQuery.noConflict();
    </script>

    <apex:slds />

    <style>
        .vf-message-wrapper .message {
            margin: 0px;
        }
        .vf-message-wrapper .message table td:first-child {
            width: 35px;
        }
        .vf-message-wrapper a {
            color: rgba(1, 118, 211, 1) !important;
            font-size: 100% !important;
            margin: 0px !important;
        }
        .lookupInput a {
            border: 0px !important;
            width: 50px !important;
        }

        td.body-header {
            background-color: rgb(243, 243, 243);
            color: rgb(68, 68, 68);
            padding: 0.25rem 1.5rem;
            font-weight: 700;
            line-height: normal;
        }
    </style>

    <div class="slds-scope" style="padding: 20px;">

        <apex:form id="mainForm">

            <apex:actionStatus id="actionStatus">
                <apex:facet name="start">
                    <div style="width: 100%; height: 100%; position: fixed; z-index: 10000; background-color: rgba(255, 255, 255, 0.5);">
                        <div role="status" class="slds-spinner slds-spinner_medium">
                            <span class="slds-assistive-text">{!$Label.Loading}</span>
                            <div class="slds-spinner__dot-a"></div>
                            <div class="slds-spinner__dot-b"></div>
                        </div>
                    </div>
                </apex:facet>
            </apex:actionStatus>
            
            <apex:outputPanel layout="none" rendered="{!step == 1}">

                <div class="slds-page-header slds-page-header_record-home" style="max-width: 1000px; margin-left: auto; margin-right: auto;">
                    <div class="slds-page-header__row">
                        <div class="slds-page-header__col-title">
                            <div class="slds-media">
                                <div class="slds-media__body">
                                    <div class="slds-page-header__name">
                                        <div class="slds-page-header__name-title">
                                            <h1>
                                                <span>{!$Label.Edit_Inbound_Call_Template} : <b>{!callout.Name}</b></span>
                                                <span class="slds-page-header__title slds-truncate" title="{!$Label.Inbound_Call_Template_Details}">{!$Label.Inbound_Call_Template_Details}</span>
                                                <br />
                                            </h1>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="slds-page-header__col-actions">
                            <div class="slds-page-header__controls">
                                <div class="slds-page-header__control">
                                    <ul class="slds-button-group-list">
                                        <li>
                                            <apex:commandButton action="{!Cancel}" value="{!$Label.d_wh__Cancel}" styleClass="slds-button slds-button_neutral" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!SaveMainCalloutQuick}" value="{!$Label.d_wh__Quick_Save}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!SaveMainCalloutContinue}" value="{!$Label.d_wh__Save_and_Continue}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!SaveMainCalloutClose}" value="{!$Label.d_wh__Save_and_Close}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-page-header__row slds-page-header__row_gutters" style="background-color: white;">
                        <div class="slds-page-header__col-details">

                            <br />
                            <div class="vf-message-wrapper">
                                <apex:pageMessages />
                            </div>
                            <br />
                            
                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="{!$Component.nameInput}">
                                    <abbr class="slds-required" title="required">* </abbr>{!$Label.Inbound_Call_Name}
                                </label>
                                <div class="slds-form-element__control">
                                    <apex:inputText value="{!callout.Name}" id="nameInput" styleClass="slds-input" />
                                </div>
                            </div>
                            <br />
            
                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="{!$Component.activeInput}">
                                    {!$Label.Active}
                                </label>
                                <div class="slds-form-element__control">
                                    <apex:inputField value="{!callout.d_wh__Active__c}" id="activeInput" />
                                </div>
                            </div>
                            <br />
            
                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="{!$Component.methodInput}">
                                    <abbr class="slds-required" title="required">* </abbr>{!$Label.Method}
                                </label>
                                <div class="slds-form-element__control">
                                    <apex:inputField rendered="{!canEditMethod}" value="{!callout.d_wh__Method__c}" id="methodInput" styleClass="slds-input">
                                        <apex:actionSupport event="onchange" rerender="mainForm" status="actionStatus" />
                                    </apex:inputField>
                                    <apex:outputText rendered="{!!canEditMethod}" value="{!callout.d_wh__Method__c}" />
                                </div>
                            </div>
                            <br />

                            <apex:outputPanel layout="none" rendered="{!callout.d_wh__Method__c != 'GET'}">
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="{!$Component.reqBodyFormat}">
                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Request_Body_Format}
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:inputField rendered="{!canEditBodyFormat}" value="{!callout.d_wh__Request_Body_Format__c}" id="reqBodyFormat" styleClass="slds-input" />
                                        <apex:outputText rendered="{!!canEditBodyFormat}" value="{!RequestBodyLabel}" />
                                    </div>
                                </div>
                                <br />
                            </apex:outputPanel>
            
                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="{!$Component.objectNameInput}">
                                    {!$Label.d_wh__Main_Object}
                                </label>
                                <div class="slds-form-element__control">
                                    <apex:inputHidden id="MainObjectInput" value="{!callout.d_wh__Object__c}" />
                                    <c:SearchablePicklist rendered="{!canEditObject}" options="{!objectsOptions}" value="{!callout.d_wh__Object__c}" valueInputId="{!$Component.MainObjectInput}" />
                                    <apex:outputPanel rendered="{!!canEditObject}" layout="none">
                                        <apex:outputText rendered="{!callout.d_wh__Object__c != null}" value="{!callout.d_wh__Object__c}" />
                                        <apex:outputText rendered="{!callout.d_wh__Object__c == null}" value="{!$Label.d_wh__None_Picklist}" />
                                    </apex:outputPanel>

                                    <apex:outputPanel rendered="{!canEditObject}" layout="none">
                                        <small><a href="{!$Label.d_wh__Adding_Objects_Link}" target="_blank">{!$Label.d_wh__Adding_Objects_Title}</a></small>
                                    </apex:outputPanel>
                                </div>
                            </div>
                            <br />

                            <div class="slds-form-element">
                                <label class="slds-form-element__label" for="{!$Component.accessType}">
                                    <abbr class="slds-required" title="required">* </abbr>{!$ObjectType.Inbound_Call_Template__c.fields.Access_Type__c.Label}
                                </label>
                                <div class="slds-form-element__control">
                                    <apex:selectList value="{!callout.d_wh__Access_Type__c}" id="accessType" styleClass="slds-input" multiselect="false" size="1">
                                        <apex:selectOption itemLabel="{!$Label.d_wh__With_Public_URL}" itemValue="Public" />
                                        <apex:selectOption itemLabel="{!$Label.d_wh__Authenticated_with_REST_API}" itemValue="Authenticated" />
                                        <apex:selectOption itemLabel="{!$Label.d_wh__Basic_Username_and_Password}" itemValue="Basic" />
                                        <apex:selectOption itemLabel="{!$Label.d_wh__Bearer_Token}" itemValue="Bearer Token" />
                                        <apex:selectOption itemLabel="{!$Label.d_wh__API_Key}" itemValue="API Key" />
                                        <apex:selectOption itemLabel="{!$Label.d_wh__SHA_256_Signed_Body}" itemValue="SHA-256 Signed Body" />
                                        <apex:selectOption itemLabel="{!$Label.d_wh__Use_Apex_Class_To_Verify_Authentication}" itemValue="Apex" />
                                        <apex:actionSupport event="onchange" rerender="mainForm" status="actionStatus" />
                                    </apex:selectList>
                                </div>
                            </div>
                            <br />

                            <apex:outputPanel layout="none" rendered="{!callout.d_wh__Access_Type__c == 'SHA-256 Signed Body'}">

                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="{!$Component.signed1HeaderName}">
                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Signature_Header_Name}
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:inputText id="signed1HeaderName" value="{!creds.d_wh__Authorization_Key__c}" styleClass="slds-input" />
                                    </div>
                                </div>
                                <br />

                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="{!$Component.signed1Key}">
                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.Signature_Key}
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:inputText id="signed1Key" value="{!creds.d_wh__Authorization_Value__c}" styleClass="slds-input" />
                                    </div>
                                </div>
                                <br />

                            </apex:outputPanel>

                            <apex:outputPanel layout="none" rendered="{!callout.d_wh__Access_Type__c == 'Basic'}">

                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="{!$Component.signed4Username}">
                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Username}
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:inputText id="signed4Username" value="{!creds.d_wh__Authorization_Username__c}" styleClass="slds-input" />
                                    </div>
                                </div>
                                <br />

                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="{!$Component.signed4Password}">
                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.Password}
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:inputText id="signed4Password" value="{!creds.d_wh__Authorization_Password__c}" styleClass="slds-input" />
                                    </div>
                                </div>
                                <br />

                            </apex:outputPanel>

                            <apex:outputPanel layout="none" rendered="{!callout.d_wh__Access_Type__c == 'Bearer Token'}">

                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="{!$Component.signed2Key}">
                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Bearer_Token}
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:inputText id="signed2Key" value="{!creds.d_wh__Authorization_Value__c}" styleClass="slds-input" />
                                    </div>
                                </div>
                                <br />

                            </apex:outputPanel>

                            <apex:outputPanel layout="none" rendered="{!callout.d_wh__Access_Type__c == 'API Key'}">

                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="{!$Component.signed3HeaderName}">
                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Header_Name}
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:inputText id="signed3HeaderName" value="{!creds.d_wh__Authorization_Key__c}" styleClass="slds-input" />
                                    </div>
                                </div>
                                <br />

                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="{!$Component.signed3Key}">
                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.Header_Value}
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:inputText id="signed3Key" value="{!creds.d_wh__Authorization_Value__c}" styleClass="slds-input" />
                                    </div>
                                </div>
                                <br />

                            </apex:outputPanel>

                            <apex:outputPanel layout="none" rendered="{!callout.d_wh__Access_Type__c == 'Apex'}">

                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="{!$Component.signed5Key}">
                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Class_Name}
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:inputText id="signed5Key" value="{!creds.d_wh__Authorization_Key__c}" styleClass="slds-input" />
                                    </div>
                                </div>
                                <br />

                                <apex:outputText escape="false" value="{!$Label.d_wh__Apex_Inbound_Auth_Help}" />
                                <br /><br /><br />

                            </apex:outputPanel>

                            <apex:outputPanel layout="none" rendered="{!displayFailureCodeOption}">

                                <div class="slds-form-element">
                                    <label class="slds-form-element__label" for="{!$Component.failureChoice}">
                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__In_Case_Auth_Fails_Return_Code}
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:selectList id="failureChoice" value="{!callout.d_wh__Failed_Authentication_Code__c}" styleClass="slds-input" multiselect="false" size="1">
                                            <apex:selectOption itemLabel="401 Unauthorized" itemValue="401" />
                                            <apex:selectOption itemLabel="403 Forbidden" itemValue="403" />
                                        </apex:selectList>
                                    </div>
                                </div>
                                <br />

                            </apex:outputPanel>

                            <div class="slds-section slds-is-closed" id="advancedSection">
                                <h3 class="slds-section__title">
                                    <button aria-controls="expando-unique-id" aria-expanded="true" class="slds-button slds-section__title-action" onclick="SwitchAdvanced(); return false;" style="background-color: #EEE; border-radius: 0px; margin-top: 20px;">
                                        <span id="advancedButtonChevron" style="font-weight: bold;">&gt;</span>&nbsp;&nbsp;
                                        <span class="slds-truncate" title="{!$Label.Advanced}">{!$Label.Advanced}</span>
                                    </button>
                                </h3>
                                <div aria-hidden="false" class="slds-section__content" id="expando-unique-id">

                                    <br />

                                    <apex:inputCheckbox value="{!webhookValidation}" id="webhookValCB">
                                        <apex:actionSupport event="onchange" rerender="webhookValidationPanel" status="actionStatus" />
                                    </apex:inputCheckbox>
                                    {!$Label.Webhook_Requires_Validation}
                                    <br />
                                    <small>
                                        <apex:outputText value="{!$Label.d_wh__Webhook_Requires_Validation_Help}" escape="false"/>
                                    </small>
                                    <br /><br />

                                    <apex:outputPanel id="webhookValidationPanel">
                                        <apex:outputPanel layout="none" rendered="{!webhookValidation}">

                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label" for="{!$Component.webhookValCond}">
                                                    {!$Label.d_wh__Webhook_Validation_Condition}
                                                </label>
                                                <div class="slds-form-element__control">
                                                    <apex:inputText value="{!callout.d_wh__Webhook_Validation_Condition__c}" id="webhookValCond" styleClass="slds-input" />
                                                </div>
                                            </div>
                                            <br />

                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label" for="{!$Component.webhookValClass}">
                                                    {!$Label.Webhook_Validation_Class}
                                                </label>
                                                <div class="slds-form-element__control">
                                                    <apex:inputText value="{!callout.d_wh__Webhook_Validation_Class__c}" id="webhookValClass" styleClass="slds-input" />
                                                </div>
                                            </div>
                                            <br />

                                        </apex:outputPanel>
                                    </apex:outputPanel>

                                </div>
                                <script>
                                    function SwitchAdvanced() {
                                        var advancedSection = document.getElementById('advancedSection');
                                        var advancedButtonChevron = document.getElementById('advancedButtonChevron');
                                        if (advancedSection.classList.contains('slds-is-open')) {
                                            advancedSection.classList.add('slds-is-closed');
                                            advancedSection.classList.remove('slds-is-open');
                                            advancedButtonChevron.style.transform = 'rotate(0deg)';
                                        } else {
                                            advancedSection.classList.remove('slds-is-closed');
                                            advancedSection.classList.add('slds-is-open');
                                            advancedButtonChevron.style.transform = 'rotate(90deg)';
                                        }
                                    }
                                </script>
                            </div>
            
                        </div>
                    </div>
                </div>

            </apex:outputPanel>

            <apex:outputPanel layout="none" rendered="{!step == 2}">

                <div class="slds-page-header slds-page-header_record-home">
                    <div class="slds-page-header__row">
                        <div class="slds-page-header__col-title">
                            <div class="slds-media">
                                <div class="slds-media__body">
                                    <div class="slds-page-header__name">
                                        <div class="slds-page-header__name-title">
                                            <h1>
                                                <span>{!$Label.Edit_Inbound_Call_Template} : <b>{!callout.Name}</b></span>
                                                <span class="slds-page-header__title slds-truncate" title="{!$Label.Request_Body}">{!$Label.Request_Body}</span>
                                                <br />
                                            </h1>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="slds-page-header__col-actions">
                            <div class="slds-page-header__controls">
                                <div class="slds-page-header__control">
                                    <ul class="slds-button-group-list">
                                        <li>
                                            <apex:commandButton action="{!Cancel}" value="{!$Label.d_wh__Cancel}" styleClass="slds-button slds-button_neutral" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!GoBack}" value="{!$Label.d_wh__Back}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!SaveBodyQuick}" value="{!$Label.d_wh__Quick_Save}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!SaveBodyContinue}" value="{!$Label.d_wh__Save_and_Continue}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!SaveBodyClose}" value="{!$Label.d_wh__Save_and_Close}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-page-header__row slds-page-header__row_gutters" style="background-color: white;">
                        <div class="slds-page-header__col-details">
                            
                            <br />
                            <div class="vf-message-wrapper">
                                <apex:pageMessages />
                            </div>
                            <br />

                            <apex:outputPanel layout="none" rendered="{!callout.d_wh__Request_Body_Format__c == 'application/json'}">
                                <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_header-hidden" style="font-weight: bold; font-size: 120%;">
                                    <thead class="slds-assistive-text">
                                        <tr class="slds-line-height_reset">
                                            <th class="" scope="col"></th>
                                            <th class="" scope="col"></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <apex:repeat value="{!displayNodes}" var="node">
                                            <apex:outputPanel layout="none" rendered="{!node.closingNode != true}">
                                                <tr class="slds-hint-parent">
                                                    <td style="text-align: right; padding-right:20px; width:70px;">
                                                        <apex:outputPanel rendered="{!!node.node.mainObject}">
                                                            <apex:commandButton value="-" styleClass="slds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!RemoveNode}" rerender="mainForm" status="actionStatus">
                                                                <apex:param name="nodeGuid" value="{!node.node.guid}" />
                                                            </apex:commandButton>
                                                        </apex:outputPanel>
                                                        
                                                        <apex:commandLink styleClass="slds-button slslds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!OpenEditNode}" rerender="mainForm" status="actionStatus">
                                                            <img src="/img/func_icons/util/pencil12.gif" />
                                                            <apex:param name="nodeGuid" value="{!node.node.guid}" />
                                                        </apex:commandLink>
                                                    </td>
                                                    <td data-label="">
                                                        <div class="slds-truncate" title="">
                                                            <div style="display:inline-block; width: {!node.node.levelIdent}px;"></div>

                                                            <apex:outputPanel rendered="{!!node.node.mainObject}">
                                                                "<apex:outputText value="{!node.node.node.Name}" />" :&nbsp;
                                                            </apex:outputPanel>

                                                            <apex:outputText value="{" rendered="{!node.node.node.d_wh__Node_Type__c == 'Object'}" />

                                                            <apex:outputText value="[ {" rendered="{!node.node.node.d_wh__Node_Type__c == 'List'}" />

                                                            <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Type__c == 'Value'}">
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>...
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                            </apex:outputPanel>

                                                            <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Type__c == 'Array'}">
                                                                <apex:outputText value="[ " />
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>...
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                <apex:outputText value=" ]" />
                                                                <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                            </apex:outputPanel>

                                                        </div>
                                                    </td>
                                                </tr>
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="none" rendered="{!node.closingNode == true}">
                                                <tr class="slds-hint-parent">
                                                    <td></td>
                                                    <td data-label="">
                                                        <div class="slds-truncate" title="">
                                                            <div style="display:inline-block; width: {!node.node.nextLevelIdent}px;"></div>
                                                            <apex:commandButton value="+" styleClass="slds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!AddNode}" rerender="mainForm" status="actionStatus">
                                                                <apex:param name="parentGuid" value="{!node.node.guid}" />
                                                            </apex:commandButton>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr class="slds-hint-parent">
                                                    <td></td>
                                                    <td data-label="">
                                                        <div class="slds-truncate" title="">
                                                            <div style="display:inline-block; width: {!node.node.levelIdent}px;"></div>
                                                            <apex:outputText rendered="{!node.node.node.d_wh__Node_Type__c == 'List'}" value="} ]" />
                                                            <apex:outputText rendered="{!node.node.node.d_wh__Node_Type__c == 'Object'}" value="}" />
                                                            <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </apex:outputPanel>
                                        </apex:repeat>
                                    </tbody>
                                </table>

                                <br /><br />
                                <apex:commandButton styleClass="slds-button slds-button_brand" action="{!OpenJSONExampleForm}" value="{!$Label.d_wh__Create_from_sample_JSON_request}"  rerender="mainForm" status="actionStatus" />
                                <apex:commandButton styleClass="slds-button slds-button_brand" action="{!OpenJSONSObjectForm}" value="{!$Label.d_wh__Create_from_fields_of_Main_Object}"  rerender="mainForm" status="actionStatus" />
                                <br />
                                
                            </apex:outputPanel>

                            <apex:outputPanel layout="none" rendered="{!callout.d_wh__Request_Body_Format__c == 'application/x-www-form-urlencoded'}">

                                <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                    <thead>
                                        <tr class="slds-line-height_reset">
                                            <th class="" scope="col" style="width: 120px;">
                                                
                                            </th>
                                            <th class="" scope="col">
                                                <div class="slds-truncate" title="{!$Label.d_wh__Key}">{!$Label.d_wh__Key}</div>
                                            </th>
                                            <th class="" scope="col">
                                                <div class="slds-truncate" title="{!$Label.d_wh__Value}">{!$Label.d_wh__Value}</div>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <apex:repeat value="{!displayNodesForm}" var="node">
                                            <tr class="slds-hint-parent">
                                                <td data-label="">
                                                    <apex:commandButton value="-" styleClass="slds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!RemoveNode}" rerender="mainForm" status="actionStatus">
                                                        <apex:param name="nodeGuid" value="{!node.node.guid}" />
                                                    </apex:commandButton>
                                                    <apex:commandLink styleClass="slds-button slslds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!OpenEditNode}" rerender="mainForm" status="actionStatus">
                                                        <img src="/img/func_icons/util/pencil12.gif" />
                                                        <apex:param name="nodeGuid" value="{!node.node.guid}" />
                                                    </apex:commandLink>
                                                </td>
                                                <td data-label="{!$Label.d_wh__Key}">
                                                    <apex:outputText value="{!node.node.node.Name}" />
                                                </td>
                                                <td data-label="{!$Label.d_wh__Value}">
                                                    ...
                                                </td>
                                            </tr>
                                        </apex:repeat>
                                    </tbody>
                                </table>

                                <br />
                                {!$Label.Form_Encoded_Example} : &nbsp;
                                <b><apex:outputText value="{!formEncodedExampleBody}" escape="false" /></b>
                                <br />

                                <br />
                                <apex:commandButton value="{!$Label.d_wh__Add_Item}" styleClass="slds-button slds-button_brand" action="{!AddNode}" rerender="mainForm" status="actionStatus">
                                    <apex:param name="parentGuid" value="{!bodyItemsTree.guid}" />
                                </apex:commandButton>
                                <br />

                            </apex:outputPanel>

                            <br /><br />
                        </div>
                    </div>
                </div>

            </apex:outputPanel>

            <apex:outputPanel layout="none" rendered="{!step == 3}">

                <div class="slds-page-header slds-page-header_record-home">
                    <div class="slds-page-header__row">
                        <div class="slds-page-header__col-title">
                            <div class="slds-media">
                                <div class="slds-media__body">
                                    <div class="slds-page-header__name">
                                        <div class="slds-page-header__name-title">
                                            <h1>
                                                <span>{!$Label.Edit_Inbound_Call_Template} : <b>{!callout.Name}</b></span>
                                                <span class="slds-page-header__title slds-truncate" title="{!$Label.Inbound_Actions}">{!$Label.Inbound_Actions}</span>
                                                <br />
                                            </h1>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="slds-page-header__col-actions">
                            <div class="slds-page-header__controls">
                                <div class="slds-page-header__control">
                                    <ul class="slds-button-group-list">
                                        <li>
                                            <apex:commandButton action="{!Cancel}" value="{!$Label.d_wh__Cancel}" styleClass="slds-button slds-button_neutral" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!GoBack}" value="{!$Label.d_wh__Back}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!SaveActionsQuick}" value="{!$Label.d_wh__Quick_Save}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!SaveActionsContinue}" value="{!$Label.d_wh__Save_and_Continue}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!SaveActionsClose}" value="{!$Label.d_wh__Save_and_Close}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-page-header__row slds-page-header__row_gutters" style="background-color: white;">
                        <div class="slds-page-header__col-details">

                            <apex:actionFunction name="RefreshActionsPage" action="{!RefreshActionsPage}" reRender="mainForm" status="actionStatus" />

                            <apex:actionFunction name="ChangeActionDetailsCard" action="{!ChangeActionDetailsCard}" rerender="mainForm" status="actionStatus">
                                <apex:param name="actionCardGuid" value="" />
                            </apex:actionFunction>

                            <div class="slds-grid slds-m-vertical_small">
                                <div class="slds-col slds-size_1-of-3">
                                    <div style="font-weight: bold; padding: 10px 0px 15px 25px; font-size: 120%;">{!$Label.d_wh__Select_Action_Below}</div>
                                    <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                        <tbody>
                                            <tr class="slds-hint-parent" style="{!IF(displayActionDetails == 'main', 'background-color: #f3f2f2; font-weight: bold;', '')}">
                                                <td data-label="Action Name">
                                                    <div class="slds-truncate">
                                                        <a href="#" onclick="ChangeActionDetailsCard('main'); return false;">
                                                            {!$Label.d_wh__Find_a_main_record} ({!callout.d_wh__Object__c})
                                                        </a>
                                                    </div>
                                                </td>
                                                <td style="width:1px; padding-right: 5px;">
                                                    <apex:outputText rendered="{!displayActionDetails == 'main'}">>></apex:outputText>
                                                </td>
                                            </tr>
                                            <apex:repeat value="{!responseActions}" var="act">
                                                <apex:outputPanel layout="none" rendered="{!OR(act.action.d_wh__Type__c != 'Update Related Record', callout.d_wh__Object__c != null)}">
                                                    <tr class="slds-hint-parent" style="{!IF(displayActionDetails == act.guid, 'background-color: #f3f2f2; font-weight: bold;', '')}">
                                                        <td data-label="Action Name">
                                                            <div class="slds-truncate">
                                                                <a href="#" onclick="ChangeActionDetailsCard('{!act.guid}'); return false;">
                                                                    <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Create New Record'}" value="{!$Label.d_wh__Create_new_record + ': ' + act.action.d_wh__Object_API_Name__c}" />
                                                                    <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Update Related Record'}" value="{!$Label.d_wh__Update_related_record + ': ' + act.action.d_wh__Relationship_To_Main_Record__c}" />
                                                                    <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Upsert Single Record'}" value="{!$Label.d_wh__Upsert_single_record + ': ' + act.action.d_wh__Object_API_Name__c}" />
                                                                    <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Upsert List of Records'}" value="{!$Label.d_wh__Upsert_list_of_records + ': ' + act.action.d_wh__Object_API_Name__c}" />
                                                                    <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Create / Update File'}" value="{!$Label.d_wh__Create_update_file}" />
                                                                    <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Run Autolaunched Flow'}" value="{!$Label.d_wh__Run_Autolaunched_Flow + ': ' + act.action.d_wh__Flow_Name__c}" />
                                                                    <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Run Apex'}" value="{!$Label.d_wh__Run_Apex_Class + ': ' + act.action.d_wh__Apex_Class_Name__c}" />
                                                                </a>
                                                            </div>
                                                        </td>
                                                        <td style="width:1px; padding-right: 5px;">
                                                            <apex:outputText rendered="{!displayActionDetails == act.guid}">>></apex:outputText>
                                                        </td>
                                                    </tr>
                                                </apex:outputPanel>
                                            </apex:repeat>
                                        </tbody>
                                    </table>
                                    <br /><br />

                                    <div>
                                        <apex:actionFunction name="AddResponseAction" action="{!AddResponseAction}" rerender="mainForm" status="actionStatus">
                                            <apex:param name="actiontype" value="" />
                                        </apex:actionFunction>
                                        <div class="slds-button-group" role="group">
                                            <button onclick="showHideDropDownButtons(); return false;" class="slds-button slds-button_brand dropbtn">{!$Label.Add_New_Action}</button>
                                            <div class="slds-dropdown-trigger slds-dropdown-trigger_click slds-is-open">
                                                <div id="dropdown-buttons" class="slds-dropdown slds-dropdown_right slds-dropdown_actions" style="left: -100px; right: auto; display: none;">
                                                    <ul class="slds-dropdown__list" role="menu">
                                                        <li class="slds-dropdown__item" role="presentation">
                                                            <apex:commandLink styleClass="slds-button" value="{!$Label.d_wh__Add_New_Create_Record_Action}" onclick="AddResponseAction('Create New Record'); return false;" />
                                                        </li>
                                                        <apex:outputPanel layout="none" rendered="{!callout.d_wh__Object__c != null}">
                                                            <li class="slds-dropdown__item" role="presentation">
                                                                <apex:commandLink styleClass="slds-button" value="{!$Label.d_wh__Add_New_Update_Related_Record_Action}" onclick="AddResponseAction('Update Related Record'); return false;" />
                                                            </li>
                                                        </apex:outputPanel>
                                                        <li class="slds-dropdown__item" role="presentation">
                                                            <apex:commandLink styleClass="slds-button" value="{!$Label.d_wh__Add_Upsert_Single_Record_Action}" onclick="AddResponseAction('Upsert Single Record'); return false;" />
                                                        </li>
                                                        <apex:outputPanel layout="none" rendered="{!AND(callout.d_wh__Request_Body_Format__c == 'application/json', callout.d_wh__Method__c != 'GET')}">
                                                            <li class="slds-dropdown__item" role="presentation">
                                                                <apex:commandLink styleClass="slds-button" value="{!$Label.d_wh__Add_Upsert_List_Of_Records_Action}" onclick="AddResponseAction('Upsert List of Records'); return false;" />
                                                            </li>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="none" rendered="{!callout.d_wh__Method__c != 'GET'}">
                                                            <li class="slds-dropdown__item" role="presentation">
                                                                <apex:commandLink styleClass="slds-button" value="{!$Label.d_wh__Add_Create_Update_File_Action}" onclick="AddResponseAction('Create / Update File'); return false;" />
                                                            </li>
                                                        </apex:outputPanel>
                                                        <li class="slds-dropdown__item" role="presentation">
                                                            <apex:commandLink styleClass="slds-button" value="{!$Label.d_wh__Add_Run_Autolaunched_Flow_Action}" onclick="AddResponseAction('Run Autolaunched Flow'); return false;" />
                                                        </li>
                                                        <li class="slds-dropdown__item" role="presentation">
                                                            <apex:commandLink styleClass="slds-button" value="{!$Label.d_wh__Add_Run_Apex_Action}" onclick="AddResponseAction('Run Apex'); return false;" />
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <script>
                                                function showHideDropDownButtons() {
                                                    var btndiv = document.getElementById('dropdown-buttons');
                                                    if (btndiv.style.display == 'none') {
                                                        btndiv.style.display = 'block';
                                                    } else {
                                                        btndiv.style.display = 'none';
                                                    }
                                                }
    
                                                window.onclick = function(event) {
                                                    if (!event.target.matches('.dropbtn')) {
                                                        var btndiv = document.getElementById('dropdown-buttons');
                                                        btndiv.style.display = 'none';
                                                    }
                                                } 
                                            </script>
                                            <button onclick="showHideDropDownButtons(); return false;" class="slds-button slds-button_brand" style="padding: 0 4px 0 0;"></button>
                                        </div>
                                    </div>

                                    <br /><br />
                                    <div class="vf-message-wrapper">
                                        <apex:pageMessages />
                                    </div>
                                    
                                </div>
                                <div class="slds-col slds-size_2-of-3" style="padding-left: 20px;">
                                    <article class="slds-card">
                                        <div class="slds-card__body slds-card__body_inner">
                                            <apex:outputPanel layout="none" rendered="{!displayActionDetails == 'main'}">
                                                
                                                <div style="padding: 10px 10px 30px 10px;">
                                                    <span style="font-weight: bold; font-size: 130%;">{!$Label.d_wh__Find_a_main_record}</span>
                                                </div>
                
                                                <apex:outputPanel rendered="{!callout.d_wh__Object__c != null}" layout="none">

                                                    <table class="slds-table slds-table_cell-buffer slds-table_bordered" aria-label="Example default base table of Opportunities">
                                                        <thead>
                                                            <tr class="slds-line-height_reset">
                                                                <th class="" scope="col">
                                                                    <div class="slds-truncate">{!$Label.Match_main_record_by}</div>
                                                                </th>
                                                                <th class="" scope="col">
                                                                    <div class="slds-truncate">{!$Label.to}</div>
                                                                </th>
                                                                <th class="" scope="col"></th>
                                                                <th class="" scope="col" width="1%">
                                                                    <apex:commandButton rendered="{!identificationRows < 3}" value="+" styleClass="slds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!AddIdentificationRow}" rerender="mainForm" status="actionStatus" />
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr class="slds-hint-parent">
                                                                <td>
                                                                    <b>{!callout.d_wh__Object__c} -> </b>
                                                                    <div style="width: 300px; display: inline-block; vertical-align: middle; padding-top: 3px;">
                                                                        <apex:inputHidden id="SelObjectInputX2" value="{!callout.d_wh__Identify_Object_By_Field__c}" />
                                                                        <c:SearchablePicklist options="{!fieldsOptions}" value="{!callout.d_wh__Identify_Object_By_Field__c}" valueInputId="{!$Component.SelObjectInputX2}" uniqueIdent="9991" />
                                                                    </div>
                                                                </td>
                                                                <td>
                                                                    <apex:selectList value="{!identificationType1}" styleClass="slds-input" multiselect="false" size="1">
                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__Request_Body_Node}" itemValue="Request Body Node" rendered="{!callout.d_wh__Method__c != 'GET'}" />
                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__URL_Parameter}" itemValue="URL Parameter" />
                                                                        <apex:actionSupport event="onchange" rerender="ident1Panel" status="actionStatus" />
                                                                    </apex:selectList>
                                                                </td>
                                                                <td>
                                                                    <apex:outputPanel id="ident1Panel">
                                                                        <apex:outputPanel layout="none" rendered="{!identificationType1 == 'URL Parameter'}">
                                                                            <apex:inputText value="{!callout.d_wh__Identify_Object_By_URL_Param__c}" styleClass="slds-input" />
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel layout="none" rendered="{!identificationType1 == 'Request Body Node'}">
                                                                            <b>
                                                                                <apex:outputPanel layout="inline" rendered="{!callout.d_wh__Identify_Object_By_JSON_Value__c == null}" style="color:red;">{!$Label.d_wh__None}</apex:outputPanel>
                                                                                <apex:outputPanel layout="inline" rendered="{!callout.d_wh__Identify_Object_By_JSON_Value__c != null}" style="color:green;">{!callout.d_wh__Identify_Object_By_JSON_Value__c}</apex:outputPanel> &nbsp;
                                                                            </b>
                                                                            <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                <apex:param name="guid1" value="main" />
                                                                                <apex:param name="guid2" value="main" />
                                                                            </apex:commandButton>
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                </td>
                                                                <td></td>
                                                            </tr>
                                                            <apex:outputPanel layout="none" rendered="{!identificationRows >= 2}">
                                                                <tr class="slds-hint-parent">
                                                                    <td scope="col" class="body-header">
                                                                        <div class="slds-truncate">{!$Label.Match_main_record_by_2}</div>
                                                                    </td>
                                                                    <td scope="col" class="body-header">
                                                                        <div class="slds-truncate">{!$Label.to}</div>
                                                                    </td>
                                                                    <td scope="col" class="body-header">
                                                                    </td>
                                                                </tr>
                                                                <tr class="slds-hint-parent">
                                                                    <td>
                                                                        <b>{!callout.d_wh__Object__c} -> </b>
                                                                        <div style="width: 300px; display: inline-block; vertical-align: middle; padding-top: 3px;">
                                                                            <apex:inputHidden id="SelObjectInputX22" value="{!callout.d_wh__Identify_Object_By_Field_2__c}" />
                                                                            <c:SearchablePicklist options="{!fieldsOptions}" value="{!callout.d_wh__Identify_Object_By_Field_2__c}" valueInputId="{!$Component.SelObjectInputX22}" uniqueIdent="9992" />
                                                                        </div>
                                                                    </td>
                                                                    <td>
                                                                        <apex:selectList value="{!identificationType2}" styleClass="slds-input" multiselect="false" size="1">
                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Request_Body_Node}" itemValue="Request Body Node" rendered="{!callout.d_wh__Method__c != 'GET'}" />
                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__URL_Parameter}" itemValue="URL Parameter" />
                                                                            <apex:actionSupport event="onchange" rerender="ident2Panel" status="actionStatus" />
                                                                        </apex:selectList>
                                                                    </td>
                                                                    <td>
                                                                        <apex:outputPanel id="ident2Panel">
                                                                            <apex:outputPanel layout="none" rendered="{!identificationType2 == 'URL Parameter'}">
                                                                                <apex:inputText value="{!callout.d_wh__Identify_Object_By_URL_Param_2__c}" styleClass="slds-input" />
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel layout="none" rendered="{!identificationType2 == 'Request Body Node'}">
                                                                                <b>
                                                                                    <apex:outputPanel layout="inline" rendered="{!callout.d_wh__Identify_Object_By_JSON_Value_2__c == null}" style="color:red;">{!$Label.d_wh__None}</apex:outputPanel>
                                                                                    <apex:outputPanel layout="inline" rendered="{!callout.d_wh__Identify_Object_By_JSON_Value_2__c != null}" style="color:green;">{!callout.d_wh__Identify_Object_By_JSON_Value_2__c}</apex:outputPanel> &nbsp;
                                                                                </b>
                                                                                <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                    <apex:param name="guid1" value="main" />
                                                                                    <apex:param name="guid2" value="main2" />
                                                                                </apex:commandButton>
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                    </td>
                                                                    <td></td>
                                                                </tr>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="none" rendered="{!identificationRows >= 3}">
                                                                <tr class="slds-hint-parent">
                                                                    <td scope="col" class="body-header">
                                                                        <div class="slds-truncate">{!$Label.Match_main_record_by_2}</div>
                                                                    </td>
                                                                    <td scope="col" class="body-header">
                                                                        <div class="slds-truncate">{!$Label.to}</div>
                                                                    </td>
                                                                    <td scope="col" class="body-header">
                                                                    </td>
                                                                </tr>
                                                                <tr class="slds-hint-parent">
                                                                    <td>
                                                                        <b>{!callout.d_wh__Object__c} -> </b>
                                                                        <div style="width: 300px; display: inline-block; vertical-align: middle; padding-top: 3px;">
                                                                            <apex:inputHidden id="SelObjectInputX23" value="{!callout.d_wh__Identify_Object_By_Field_3__c}" />
                                                                            <c:SearchablePicklist options="{!fieldsOptions}" value="{!callout.d_wh__Identify_Object_By_Field_3__c}" valueInputId="{!$Component.SelObjectInputX23}" uniqueIdent="9993" />
                                                                        </div>
                                                                    </td>
                                                                    <td>
                                                                        <apex:selectList value="{!identificationType3}" styleClass="slds-input" multiselect="false" size="1">
                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Request_Body_Node}" itemValue="Request Body Node" rendered="{!callout.d_wh__Method__c != 'GET'}" />
                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__URL_Parameter}" itemValue="URL Parameter" />
                                                                            <apex:actionSupport event="onchange" rerender="ident3Panel" status="actionStatus" />
                                                                        </apex:selectList>
                                                                    </td>
                                                                    <td>
                                                                        <apex:outputPanel id="ident3Panel">
                                                                            <apex:outputPanel layout="none" rendered="{!identificationType3 == 'URL Parameter'}">
                                                                                <apex:inputText value="{!callout.d_wh__Identify_Object_By_URL_Param_3__c}" styleClass="slds-input" />
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel layout="none" rendered="{!identificationType3 == 'Request Body Node'}">
                                                                                <b>
                                                                                    <apex:outputPanel layout="inline" rendered="{!callout.d_wh__Identify_Object_By_JSON_Value_3__c == null}" style="color:red;">{!$Label.d_wh__None}</apex:outputPanel>
                                                                                    <apex:outputPanel layout="inline" rendered="{!callout.d_wh__Identify_Object_By_JSON_Value_3__c != null}" style="color:green;">{!callout.d_wh__Identify_Object_By_JSON_Value_3__c}</apex:outputPanel> &nbsp;
                                                                                </b>
                                                                                <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                    <apex:param name="guid1" value="main" />
                                                                                    <apex:param name="guid2" value="main3" />
                                                                                </apex:commandButton>
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                    </td>
                                                                    <td></td>
                                                                </tr>
                                                            </apex:outputPanel>
                                                        </tbody>
                                                    </table>

                                                    <br /><br />

                                                    <div class="slds-grid slds-wrap slds-gutters">
                                                        <div class="slds-col slds-size_1-of-2">
                                                            <div style="font-size: 120%; padding: 10px;">
                                                                <apex:inputCheckbox value="{!updateResponseAction.action.d_wh__Update_if_match_found__c}">
                                                                    <apex:actionSupport event="onchange" rerender="mainForm" status="actionStatus" />
                                                                </apex:inputCheckbox>
                                                                {!$Label.d_wh__Update_main_record}: <b>{!callout.d_wh__Object__c}</b>
                                                            </div>
                                                        </div> 

                                                        <div class="slds-col slds-size_1-of-2">
                                                            <div style="font-size: 120%; padding: 10px;">
                                                                <apex:inputField value="{!updateResponseAction.action.d_wh__Create_if_not_found__c}">
                                                                    <apex:actionSupport event="onchange" rerender="mainForm" status="actionStatus" />
                                                                </apex:inputField>
                                                                {!$Label.d_wh__Create_record_if_not_found}
                                                            </div>
                                                            <br />
                                                        </div>
                                                    </div>

                                                    <apex:outputPanel layout="none" rendered="{!OR(updateResponseAction.action.d_wh__Update_if_match_found__c, updateResponseAction.action.d_wh__Create_if_not_found__c)}">
                                                        <div style="width: 100%; overflow-x: auto;">
                                                            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                                <thead>
                                                                    <tr class="slds-line-height_reset">
                                                                        <th class="" scope="col">
                                                                        </th>
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate" title="{!$Label.d_wh__Field}">{!$Label.d_wh__Field}</div>
                                                                        </th>
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate" title="{!$Label.d_wh__Type}">{!$Label.d_wh__Type}</div>
                                                                        </th>
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate" title="{!$Label.d_wh__Value}">{!$Label.d_wh__Value}</div>
                                                                        </th>
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate" title="Ignore if empty">Ignore if empty</div>
                                                                        </th>
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate" title="{!$Label.d_wh__Only_When_Creating}">{!$Label.d_wh__Only_When_Creating}</div>
                                                                        </th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <apex:variable var="indx" value="{!0}" />
                                                                    <apex:repeat value="{!updateResponseAction.mapping}" var="mp">
                                                                        <tr class="slds-hint-parent">
                                                                            <td data-label="">
                                                                                <div class="slds-truncate">
                                                                                    <apex:commandButton value="{!$Label.d_wh__Remove_Field}" action="{!UpdateActionRemoveField}" styleClass="slds-button slds-button_text-destructive" style="white-space: nowrap;" rerender="mainForm" status="actionStatus">
                                                                                        <apex:param name="guid" value="{!mp.guid}" />
                                                                                    </apex:commandButton>
                                                                                </div>
                                                                            </td>
                                                                            <td data-label="{!$Label.d_wh__Field}">
                                                                                <div class="slds-truncate">
                                                                                    <apex:inputHidden id="SelObjectInput3" value="{!mp.f}" />
                                                                                    <c:SearchablePicklist options="{!fieldsOptionsEditable}" value="{!mp.f}" valueInputId="{!$Component.SelObjectInput3}" uniqueIdent="{!indx}" />
                                                                                </div>
                                                                            </td>
                                                                            <td data-label="{!$Label.d_wh__Type}">
                                                                                <div class="slds-truncate">
                                                                                    <apex:selectList value="{!mp.t}" styleClass="slds-input" multiselect="false" size="1">
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__Request_Element_Mapping}" itemValue="true" rendered="{!callout.d_wh__Method__c != 'GET'}" />
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__URL_Parameter}" itemValue="param" />
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__Formula}" itemValue="formula" />
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__Static_Value}" itemValue="false" />
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Metadata}" itemValue="mdt" />
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Settings}" itemValue="cs" />
                                                                                        <apex:actionSupport event="onchange" rerender="mappingInputs" status="actionStatus" />
                                                                                    </apex:selectList>
                                                                                </div>
                                                                            </td>
                                                                            <td data-label="{!$Label.d_wh__Value}">
                                                                                <div class="slds-truncate">
                                                                                    <apex:outputPanel id="mappingInputs">
                                                                                        <apex:inputText value="{!mp.s}" rendered="{!mp.t == 'false'}" styleClass="slds-input" />
                                                                                        <apex:inputText value="{!mp.p}" rendered="{!mp.t == 'param'}" styleClass="slds-input" />
                                                                                        <apex:outputPanel rendered="{!mp.t == 'formula'}">
                                                                                            <apex:inputTextarea id="fieldFormulaHidden" value="{!mp.g}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                            <c:FormulaEditor inboundRequest="{!bodyItemsTree}" acceptParameters="true" acceptHeaders="true" formula="{!mp.g}" inputValueId="{!$Component.fieldFormulaHidden}" />
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel rendered="{!mp.t == 'true'}">
                                                                                            {!$Label.Mapped_To}: &nbsp;
                                                                                            <apex:outputPanel layout="inline" rendered="{!mp.m == null}" style="color:red;">{!$Label.d_wh__Nothing}</apex:outputPanel>
                                                                                            <apex:outputPanel layout="inline" rendered="{!mp.m != null}" style="font-weight: bold;">{!mp.m_esc}</apex:outputPanel> &nbsp;
                                                                                            <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                                <apex:param name="guid1" value="main" />
                                                                                                <apex:param name="guid2" value="{!mp.guid}" />
                                                                                            </apex:commandButton>
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel rendered="{!mp.t == 'mdt'}">
                                                                                            <apex:inputTextarea id="fieldMetadataHidden" value="{!mp.mdt}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                            <c:MetadataSelector inputValueId="{!$Component.fieldMetadataHidden}" selectedValue="{!mp.mdt}" />
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel rendered="{!mp.t == 'cs'}">
                                                                                            <apex:inputTextarea id="fieldSettingHidden" value="{!mp.cs}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                            <c:CustomSettingsSelector inputValueId="{!$Component.fieldSettingHidden}" selectedValue="{!mp.cs}" />
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                </div>
                                                                            </td>
                                                                            <td data-label="Ignore if empty">
                                                                                <div class="slds-truncate">
                                                                                    <apex:inputCheckbox value="{!mp.ig}" />
                                                                                    Ignore if empty
                                                                                </div>
                                                                            </td>
                                                                            <td data-label="{!$Label.d_wh__Only_When_Creating}">
                                                                                <div class="slds-truncate">
                                                                                    <apex:inputCheckbox value="{!mp.c}" />
                                                                                    {!$Label.d_wh__Only_When_Creating}
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                        <apex:variable var="indx" value="{!indx + 1}" />
                                                                    </apex:repeat>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <br />
                                                        <apex:commandButton value="{!$Label.d_wh__Add_Field}" action="{!UpdateActionAddField}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus" />
                                                    </apex:outputPanel>

                                                    <br /><br /><hr />
                                                    <div style="font-size: 120%; padding: 10px;">
                                                        {!$Label.This_Action_Runs}:
                                                        <b>
                                                            {!updateResponseAction.criteria.Summary} &nbsp; &nbsp;
                                                            <apex:commandLink action="{!OpenActionCriteriaDetails}" value="[{!$Label.d_wh__Customize}]" reRender="mainForm" status="actionStatus" rendered="{!!updateResponseAction.criteriaOpen}">
                                                                <apex:param name="guid1" value="main" />
                                                            </apex:commandLink>
                                                        </b>
                                                    </div>
                                                    <apex:outputPanel layout="none" rendered="{!updateResponseAction.criteriaOpen}">
                                                        <br /><br />
                                                        <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                            <thead>
                                                                <tr class="slds-line-height_reset">
                                                                    <th class="" scope="col">
                                                                    </th>
                                                                    <th class="" scope="col">
                                                                        <div class="slds-truncate" title="{!$Label.Item}">{!$Label.Item}</div>
                                                                    </th>
                                                                    <th class="" scope="col">
                                                                        <div class="slds-truncate" title="{!$Label.Operator}">{!$Label.Operator}</div>
                                                                    </th>
                                                                    <th class="" scope="col">
                                                                        <div class="slds-truncate" title="{!$Label.d_wh__Value}">{!$Label.d_wh__Value}</div>
                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <apex:repeat value="{!updateResponseAction.criteria.hs}" var="crit">
                                                                    <tr class="slds-hint-parent">
                                                                        <td data-label="">
                                                                            <div class="">
                                                                                <apex:commandButton value="{!$Label.d_wh__Remove}" action="{!RemoveActionCriteria}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                    <apex:param name="guid1" value="main" />
                                                                                    <apex:param name="guid2" value="{!crit.guid}" />
                                                                                </apex:commandButton>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.Header}">
                                                                            <div class="">
                                                                                <b>{!$Label.Header} :</b>&nbsp;
                                                                                <apex:inputText value="{!crit.n}" styleClass="slds-input" style="width: 60%;" />
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Operator}">
                                                                            <div class="">
                                                                                <apex:selectList value="{!crit.o}" size="1" multiselect="false" styleClass="slds-input">
                                                                                    <apex:selectOption itemValue="" itemLabel="-- Please select --" />
                                                                                    <apex:selectOption itemValue="=" itemLabel="=" />
                                                                                    <apex:selectOption itemValue="!=" itemLabel="!=" />
                                                                                    <apex:selectOption itemValue="CONTAINS" itemLabel="CONTAINS" />
                                                                                    <apex:selectOption itemValue="ISNULL" itemLabel="EXISTS" />
                                                                                    <apex:selectOption itemValue="ISNOTNULL" itemLabel="DOES NOT EXIST" />
                                                                                    <apex:actionSupport event="onchange" reRender="mainForm" status="actionStatus" />
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Value}">
                                                                            <div class="">
                                                                                <apex:inputText value="{!crit.v}" styleClass="slds-input" rendered="{!AND(crit.o != null, crit.o != '', crit.o != 'ISNULL', crit.o != 'ISNOTNULL')}" />
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                </apex:repeat>
                                                                <apex:repeat value="{!updateResponseAction.criteria.cs}" var="crit">
                                                                    <tr class="slds-hint-parent">
                                                                        <td data-label="">
                                                                            <div class="">
                                                                                <apex:commandButton value="{!$Label.d_wh__Remove}" action="{!RemoveActionCriteria}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                    <apex:param name="guid1" value="main" />
                                                                                    <apex:param name="guid2" value="{!crit.guid}" />
                                                                                </apex:commandButton>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.Node}">
                                                                            <div class="">
                                                                                <b>
                                                                                    {!$Label.Node} : &nbsp;
                                                                                    <apex:outputPanel layout="inline" rendered="{!OR(crit.n == null, crit.n == '')}" style="color:red;">{!$Label.d_wh__None}</apex:outputPanel>
                                                                                    <apex:outputPanel layout="inline" rendered="{!AND(crit.n != null, crit.n != '')}" style="color:green;">{!crit.n}</apex:outputPanel> &nbsp;
                                                                                </b>
                                                                                <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                    <apex:param name="guid1" value="main" />
                                                                                    <apex:param name="guid2" value="crit-{!crit.guid}" />
                                                                                </apex:commandButton>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Operator}">
                                                                            <div class="">
                                                                                <apex:selectList value="{!crit.o}" size="1" multiselect="false" styleClass="slds-input">
                                                                                    <apex:selectOption itemValue="" itemLabel="-- Please select --" />
                                                                                    <apex:selectOption itemValue="=" itemLabel="=" />
                                                                                    <apex:selectOption itemValue="!=" itemLabel="!=" />
                                                                                    <apex:selectOption itemValue=">" itemLabel=">" />
                                                                                    <apex:selectOption itemValue="<" itemLabel="<" />
                                                                                    <apex:selectOption itemValue=">=" itemLabel=">=" />
                                                                                    <apex:selectOption itemValue="<=" itemLabel="<=" />
                                                                                    <apex:selectOption itemValue="CONTAINS" itemLabel="CONTAINS" />
                                                                                    <apex:selectOption itemValue="ISNULL" itemLabel="IS NULL" />
                                                                                    <apex:selectOption itemValue="ISNOTNULL" itemLabel="IS NOT NULL" />
                                                                                    <apex:actionSupport event="onchange" reRender="mainForm" status="actionStatus" />
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Value}">
                                                                            <div class="">
                                                                                <apex:inputText value="{!crit.v}" styleClass="slds-input" rendered="{!AND(crit.o != null, crit.o != '', crit.o != 'ISNULL', crit.o != 'ISNOTNULL')}" />
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                </apex:repeat>
                                                                <apex:repeat value="{!updateResponseAction.criteria.ps}" var="crit">
                                                                    <tr class="slds-hint-parent">
                                                                        <td data-label="">
                                                                            <div class="">
                                                                                <apex:commandButton value="{!$Label.d_wh__Remove}" action="{!RemoveActionCriteria}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                    <apex:param name="guid1" value="main" />
                                                                                    <apex:param name="guid2" value="{!crit.guid}" />
                                                                                </apex:commandButton>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__URL_Parameter}">
                                                                            <div class="">
                                                                                <b>{!$Label.d_wh__URL_Parameter} :</b> &nbsp;
                                                                                <apex:inputText value="{!crit.n}" styleClass="slds-input" style="width: 60%;" />
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Operator}">
                                                                            <div class="">
                                                                                <apex:selectList value="{!crit.o}" size="1" multiselect="false" styleClass="slds-input">
                                                                                    <apex:selectOption itemValue="" itemLabel="-- Please select --" />
                                                                                    <apex:selectOption itemValue="=" itemLabel="=" />
                                                                                    <apex:selectOption itemValue="!=" itemLabel="!=" />
                                                                                    <apex:selectOption itemValue=">" itemLabel=">" />
                                                                                    <apex:selectOption itemValue="<" itemLabel="<" />
                                                                                    <apex:selectOption itemValue=">=" itemLabel=">=" />
                                                                                    <apex:selectOption itemValue="<=" itemLabel="<=" />
                                                                                    <apex:selectOption itemValue="CONTAINS" itemLabel="CONTAINS" />
                                                                                    <apex:selectOption itemValue="ISNULL" itemLabel="IS NULL" />
                                                                                    <apex:selectOption itemValue="ISNOTNULL" itemLabel="IS NOT NULL" />
                                                                                    <apex:actionSupport event="onchange" reRender="mainForm" status="actionStatus" />
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Value}">
                                                                            <div class="">
                                                                                <apex:inputText value="{!crit.v}" styleClass="slds-input" rendered="{!AND(crit.o != null, crit.o != '', crit.o != 'ISNULL', crit.o != 'ISNOTNULL')}" />
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                </apex:repeat>
                                                                <apex:outputPanel layout="none" rendered="{!updateResponseAction.criteria.showBooleanCriteria}">
                                                                    <tr class="slds-hint-parent">
                                                                        <td data-label="" colspan="4">
                                                                            <div class="">
                                                                                <b>{!$Label.Run_Action_If}:&nbsp;</b>
                                                                                <apex:selectList value="{!updateResponseAction.criteria.o}" size="1" multiselect="false" styleClass="slds-input" style="width:300px;">
                                                                                    <apex:selectOption itemValue="AND" itemLabel="{!$Label.d_wh__All_Criteria_Is_Satisfied}" />
                                                                                    <apex:selectOption itemValue="OR" itemLabel="{!$Label.d_wh__Any_Criteria_Is_Satisfied}" />
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                </apex:outputPanel>
                                                            </tbody>
                                                        </table>
                                                        <br />
                                                        <apex:commandButton value="{!$Label.d_wh__Add_Header_Criteria}" action="{!AddActionCriteriaHeader}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                            <apex:param name="guid1" value="main" />
                                                        </apex:commandButton>
                                                        <apex:commandButton value="{!$Label.d_wh__Add_Node_Criteria}" action="{!AddActionCriteriaNode}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                            <apex:param name="guid1" value="main" />
                                                        </apex:commandButton>
                                                        <apex:commandButton value="{!$Label.d_wh__Add_URL_Criteria}" action="{!AddActionCriteriaURL}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                            <apex:param name="guid1" value="main" />
                                                        </apex:commandButton>
                                                    </apex:outputPanel>
                                                    <br />

                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!callout.d_wh__Object__c == null}" layout="none">
                                                    <b>{!$Label.d_wh__Cannot_Find_Main_Record_Object_Is_Not_Set}</b>
                                                </apex:outputPanel>
                                            </apex:outputPanel>

                                            <apex:repeat value="{!responseActions}" var="act">
                                                <apex:outputPanel layout="none" rendered="{!displayActionDetails == act.guid}">

                                                    <div style="padding: 10px 10px 30px 10px;">
                                                        <span style="font-weight: bold; font-size: 130%;">
                                                            <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Create New Record'}" value="{!$Label.d_wh__Create_new_record}" />
                                                            <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Update Related Record'}" value="{!$Label.d_wh__Update_related_record}" />
                                                            <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Upsert Single Record'}" value="{!$Label.d_wh__Upsert_single_record}" />
                                                            <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Upsert List of Records'}" value="{!$Label.d_wh__Upsert_list_of_records}" />
                                                            <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Create / Update File'}" value="{!$Label.d_wh__Create_update_file}" />
                                                            <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Run Autolaunched Flow'}" value="{!$Label.d_wh__Run_Autolaunched_Flow}" />
                                                            <apex:outputText rendered="{!act.action.d_wh__Type__c == 'Run Apex'}" value="{!$Label.d_wh__Run_Apex_Class}" />
                                                        </span>
                                                    </div>

                                                    <apex:outputPanel layout="none" rendered="{!act.action.d_wh__Type__c == 'Create New Record'}">

                                                        <div class="slds-grid slds-wrap slds-gutters">
                                                            <div class="slds-col slds-size_1-of-2">
                                                                <div class="slds-form-element">
                                                                    <label class="slds-form-element__label">
                                                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Object_type}
                                                                    </label>
                                                                    <div class="slds-form-element__control">
                                                                        <apex:outputPanel rendered="{!!act.CanChangeObject}" layout="none">
                                                                            <b>{!act.action.d_wh__Object_API_Name__c}</b>
                                                                            <span style="font-size:75%;">({!$Label.d_wh__You_cannot_change_the_object_name_when_fields_mapping_are_added})</span>
                                                                        </apex:outputPanel>
                                                                        <apex:inputHidden id="SelObjectInput4" value="{!act.action.d_wh__Object_API_Name__c}" />
                                                                        <c:SearchablePicklist rendered="{!act.CanChangeObject}" options="{!objectsOptions}" value="{!act.action.d_wh__Object_API_Name__c}" valueInputId="{!$Component.SelObjectInput4}" functionToCall="RefreshActionsPage" />
                                                                    </div>
                                                                </div>
                                                                <br />
                                                            </div>
                                                            <div class="slds-col slds-size_1-of-2">
                                                                <apex:outputPanel rendered="{!callout.d_wh__Object__c != null}" layout="none">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">
                                                                            {!$Label.d_wh__Related_to_the_main_object}
                                                                        </label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:selectList id="relatedFieldsInput" value="{!act.action.d_wh__Relationship_To_Main_Record__c}" styleClass="slds-input" multiselect="false" size="1">
                                                                                <apex:selectOptions value="{!act.fieldOptions}" />
                                                                            </apex:selectList>
                                                                        </div>
                                                                    </div>
                                                                    <br />
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                        
                                                        <div style="width: 100%; overflow-x: auto;">
                                                            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                                <thead>
                                                                    <tr class="slds-line-height_reset">
                                                                        <th class="" scope="col">
                                                                        </th>
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate" title="{!$Label.d_wh__Field}">{!$Label.d_wh__Field}</div>
                                                                        </th>
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate" title="{!$Label.d_wh__Type}">{!$Label.d_wh__Type}</div>
                                                                        </th>
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate" title="{!$Label.d_wh__Value}">{!$Label.d_wh__Value}</div>
                                                                        </th>
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate" title="Ignore if empty">Ignore if empty</div>
                                                                        </th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <apex:variable var="indx" value="{!0}" />
                                                                    <apex:repeat value="{!act.mapping}" var="mp">
                                                                        <tr class="slds-hint-parent">
                                                                            <td data-label="">
                                                                                <div class="slds-truncate">
                                                                                    <apex:commandButton value="{!$Label.d_wh__Remove_Field}" action="{!ResponseActionRemoveField}" styleClass="slds-button slds-button_text-destructive" style="white-space: nowrap;" rerender="mainForm" status="actionStatus">
                                                                                        <apex:param name="guid1" value="{!act.guid}" />
                                                                                        <apex:param name="guid2" value="{!mp.guid}" />
                                                                                    </apex:commandButton>
                                                                                </div>
                                                                            </td>
                                                                            <td data-label="{!$Label.d_wh__Field}">
                                                                                <div class="slds-truncate">
                                                                                    <apex:inputHidden id="SelObjectInput11" value="{!mp.f}" />
                                                                                    <c:SearchablePicklist options="{!act.allFieldOptionsListEditable}" value="{!mp.f}" valueInputId="{!$Component.SelObjectInput11}" uniqueIdent="{!indx}" />
                                                                                </div>
                                                                            </td>
                                                                            <td data-label="{!$Label.d_wh__Type}">
                                                                                <div class="slds-truncate">
                                                                                    <apex:selectList value="{!mp.t}" styleClass="slds-input" multiselect="false" size="1">
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__Request_Element_Mapping}" itemValue="true" rendered="{!callout.d_wh__Method__c != 'GET'}" />
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__URL_Parameter}" itemValue="param" />
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__Formula}" itemValue="formula" />
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__Static_Value}" itemValue="false" />
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Metadata}" itemValue="mdt" />
                                                                                        <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Settings}" itemValue="cs" />
                                                                                        <apex:actionSupport event="onchange" rerender="mappingInputs" status="actionStatus" />
                                                                                    </apex:selectList>
                                                                                </div>
                                                                            </td>
                                                                            <td data-label="{!$Label.d_wh__Value}">
                                                                                <div class="slds-truncate">
                                                                                    <apex:outputPanel id="mappingInputs">
                                                                                        <apex:inputText value="{!mp.s}" rendered="{!mp.t == 'false'}" styleClass="slds-input" />
                                                                                        <apex:inputText value="{!mp.p}" rendered="{!mp.t == 'param'}" styleClass="slds-input" />
                                                                                        <apex:outputPanel rendered="{!mp.t == 'formula'}">
                                                                                            <apex:inputTextarea id="fieldFormulaHidden" value="{!mp.g}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                            <c:FormulaEditor inboundRequest="{!bodyItemsTree}" acceptParameters="true" acceptHeaders="true" formula="{!mp.g}" inputValueId="{!$Component.fieldFormulaHidden}" />
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel rendered="{!mp.t == 'true'}">
                                                                                            {!$Label.Mapped_To}: &nbsp;
                                                                                            <apex:outputPanel layout="inline" rendered="{!mp.m == null}" style="color:red;">{!$Label.d_wh__Nothing}</apex:outputPanel>
                                                                                            <apex:outputPanel layout="inline" rendered="{!mp.m != null}" style="font-weight: bold;">{!mp.m_esc}</apex:outputPanel> &nbsp;
                                                                                            <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                                <apex:param name="guid1" value="{!act.guid}" />
                                                                                                <apex:param name="guid2" value="{!mp.guid}" />
                                                                                            </apex:commandButton>
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel rendered="{!mp.t == 'mdt'}">
                                                                                            <apex:inputTextarea id="fieldMetadataHidden" value="{!mp.mdt}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                            <c:MetadataSelector inputValueId="{!$Component.fieldMetadataHidden}" selectedValue="{!mp.mdt}" />
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel rendered="{!mp.t == 'cs'}">
                                                                                            <apex:inputTextarea id="fieldSettingHidden" value="{!mp.cs}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                            <c:CustomSettingsSelector inputValueId="{!$Component.fieldSettingHidden}" selectedValue="{!mp.cs}" />
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                </div>
                                                                            </td>
                                                                            <td data-label="Ignore if empty">
                                                                                <div class="slds-truncate">
                                                                                    <apex:inputCheckbox value="{!mp.ig}" />
                                                                                    Ignore if empty
                                                                                </div>
                                                                            </td>
                                                                        </tr>
                                                                        <apex:variable var="indx" value="{!indx + 1}" />
                                                                    </apex:repeat>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                        <br />
                                                        <apex:outputPanel id="mappingButtons">
                                                            <apex:commandButton rendered="{!act.action.d_wh__Object_API_Name__c != null}" value="{!$Label.d_wh__Add_Field}" action="{!ResponseActionAddField}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                <apex:param name="guid1" value="{!act.guid}" />
                                                            </apex:commandButton>
                                                            <apex:commandButton rendered="{!act.action.d_wh__Object_API_Name__c == null}" value="{!$Label.d_wh__Add_Field}" styleClass="slds-button slds-button_neutral" onclick="alert('{!$Label.d_wh__Please_select_an_Object_type_first}'); return false;" />
                                                        </apex:outputPanel>

                                                    </apex:outputPanel>

                                                    <apex:outputPanel layout="none" rendered="{!act.action.d_wh__Type__c == 'Update Related Record'}">
                                                        <apex:outputPanel rendered="{!callout.d_wh__Object__c != null}" layout="none">
                                                            <div class="slds-grid slds-wrap slds-gutters">
                                                                <div class="slds-col slds-size_1-of-2">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">
                                                                            <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Related_Record}
                                                                        </label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:outputPanel rendered="{!!act.CanChangeObject}" layout="none">
                                                                                <b>{!act.action.d_wh__Relationship_To_Main_Record__c}</b>
                                                                                <span style="font-size:75%;">({!$Label.d_wh__You_cannot_change_the_related_record_when_fields_mapping_are_added})</span>
                                                                            </apex:outputPanel>
                                                                            <apex:selectList rendered="{!act.CanChangeObject}" value="{!act.action.d_wh__Relationship_To_Main_Record__c}" styleClass="slds-input" multiselect="false" size="1">
                                                                                <apex:selectOptions value="{!act.relFieldOptions}" />
                                                                                <apex:actionSupport event="onchange" action="{!UpdateActionRelFieldSelected}" reRender="mainForm" status="actionStatus">
                                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                                </apex:actionSupport>
                                                                            </apex:selectList>
                                                                        </div>
                                                                    </div>
                                                                    <br />
                                                                </div>
                                                            </div>

                                                            <div style="width: 100%; overflow-x: auto;">
                                                                <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                                    <thead>
                                                                        <tr class="slds-line-height_reset">
                                                                            <th class="" scope="col">
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.d_wh__Field}">{!$Label.d_wh__Field}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.Type}">{!$Label.Type}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.d_wh__Value}">{!$Label.d_wh__Value}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="Ignore if empty">Ignore if empty</div>
                                                                            </th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <apex:variable var="indx" value="{!0}" />
                                                                        <apex:repeat value="{!act.mapping}" var="mp">
                                                                            <tr class="slds-hint-parent">
                                                                                <td data-label="">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:commandButton value="{!$Label.d_wh__Remove_Field}" action="{!ResponseActionRemoveField}" styleClass="slds-button slds-button_text-destructive" style="white-space: nowrap;" rerender="mainForm" status="actionStatus">
                                                                                            <apex:param name="guid1" value="{!act.guid}" />
                                                                                            <apex:param name="guid2" value="{!mp.guid}" />
                                                                                        </apex:commandButton>
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Field}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:inputHidden id="SelObjectInput11" value="{!mp.f}" />
                                                                                        <c:SearchablePicklist options="{!act.allFieldOptionsListEditable}" value="{!mp.f}" valueInputId="{!$Component.SelObjectInput11}" uniqueIdent="{!indx}" />
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Type}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:selectList value="{!mp.t}" styleClass="slds-input" multiselect="false" size="1">
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Request_Element_Mapping}" itemValue="true" rendered="{!callout.d_wh__Method__c != 'GET'}" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__URL_Parameter}" itemValue="param" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Formula}" itemValue="formula" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Static_Value}" itemValue="false" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Metadata}" itemValue="mdt" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Settings}" itemValue="cs" />
                                                                                            <apex:actionSupport event="onchange" rerender="mappingInputs" status="actionStatus" />
                                                                                        </apex:selectList>
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Value}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:outputPanel id="mappingInputs">
                                                                                            <apex:inputText value="{!mp.s}" rendered="{!mp.t == 'false'}" styleClass="slds-input" />
                                                                                            <apex:inputText value="{!mp.p}" rendered="{!mp.t == 'param'}" styleClass="slds-input" />
                                                                                            <apex:outputPanel rendered="{!mp.t == 'formula'}">
                                                                                                <apex:inputTextarea id="fieldFormulaHidden" value="{!mp.g}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:FormulaEditor inboundRequest="{!bodyItemsTree}" acceptParameters="true" acceptHeaders="true" formula="{!mp.g}" inputValueId="{!$Component.fieldFormulaHidden}" />
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel rendered="{!mp.t == 'true'}">
                                                                                                {!$Label.Mapped_To}: &nbsp;
                                                                                                <apex:outputPanel layout="inline" rendered="{!mp.m == null}" style="color:red;">{!$Label.d_wh__Nothing}</apex:outputPanel>
                                                                                                <apex:outputPanel layout="inline" rendered="{!mp.m != null}" style="font-weight: bold;">{!mp.m_esc}</apex:outputPanel> &nbsp;
                                                                                                <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                                                    <apex:param name="guid2" value="{!mp.guid}" />
                                                                                                </apex:commandButton>
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel rendered="{!mp.t == 'mdt'}">
                                                                                                <apex:inputTextarea id="fieldMetadataHidden" value="{!mp.mdt}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:MetadataSelector inputValueId="{!$Component.fieldMetadataHidden}" selectedValue="{!mp.mdt}" />
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel rendered="{!mp.t == 'cs'}">
                                                                                                <apex:inputTextarea id="fieldSettingHidden" value="{!mp.cs}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:CustomSettingsSelector inputValueId="{!$Component.fieldSettingHidden}" selectedValue="{!mp.cs}" />
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="Ignore if empty">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:inputCheckbox value="{!mp.ig}" />
                                                                                        Ignore if empty
                                                                                    </div>
                                                                                </td>
                                                                            </tr>
                                                                            <apex:variable var="indx" value="{!indx + 1}" />
                                                                        </apex:repeat>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <br />
                                                            <apex:outputPanel id="mappingButtons2">
                                                                <apex:commandButton rendered="{!act.action.d_wh__Object_API_Name__c != null}" value="{!$Label.d_wh__Add_Field}" action="{!ResponseActionAddField}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                </apex:commandButton>
                                                                <apex:commandButton rendered="{!act.action.d_wh__Object_API_Name__c == null}" value="{!$Label.d_wh__Add_Field}" styleClass="slds-button slds-button_neutral" onclick="alert('{!$Label.d_wh__Please_select_an_Object_type_first}'); return false;" />
                                                            </apex:outputPanel>

                                                        </apex:outputPanel>

                                                    </apex:outputPanel>

                                                    <apex:outputPanel layout="none" rendered="{!act.action.d_wh__Type__c == 'Upsert Single Record'}">
                                                        
                                                        <div class="slds-grid slds-wrap slds-gutters">
                                                            <div class="slds-col slds-size_1-of-2">
                                                                <div class="slds-form-element">
                                                                    <label class="slds-form-element__label">
                                                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Object_type}
                                                                    </label>
                                                                    <div class="slds-form-element__control">
                                                                        <apex:outputPanel rendered="{!!act.CanChangeObject}" layout="none">
                                                                            <b>{!act.action.d_wh__Object_API_Name__c}</b>
                                                                            <span style="font-size:75%;">({!$Label.d_wh__You_cannot_change_the_object_name_when_fields_mapping_are_added})</span>
                                                                        </apex:outputPanel>
                                                                        <apex:inputHidden id="SelObjectInput1" value="{!act.action.d_wh__Object_API_Name__c}" />
                                                                        <c:SearchablePicklist rendered="{!act.CanChangeObject}" options="{!objectsOptions}" value="{!act.action.d_wh__Object_API_Name__c}" valueInputId="{!$Component.SelObjectInput1}" functionToCall="RefreshActionsPage" />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="slds-col slds-size_1-of-2">
                                                                <apex:outputPanel rendered="{!callout.d_wh__Object__c != null}" layout="none">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">
                                                                            {!$Label.d_wh__Related_to_the_main_object}
                                                                        </label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:selectList id="relatedFieldsInput2" value="{!act.action.d_wh__Relationship_To_Main_Record__c}" styleClass="slds-input" multiselect="false" size="1">
                                                                                <apex:selectOptions value="{!act.fieldOptions}" />
                                                                            </apex:selectList>
                                                                        </div>
                                                                    </div>
                                                                    <br />
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <br />

                                                        <apex:outputPanel layout="none" rendered="{!AND(act.action.d_wh__Object_API_Name__c != null, act.action.d_wh__Object_API_Name__c != '')}">

                                                            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                                <thead>
                                                                    <tr class="slds-line-height_reset">
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate">{!$Label.d_wh__Match_record_by}</div>
                                                                        </th>
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate">{!$Label.to}</div>
                                                                        </th>
                                                                        <th class="" scope="col"></th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="slds-hint-parent">
                                                                        <td>
                                                                            <b>{!act.action.d_wh__Object_API_Name__c} -> </b>
                                                                            <div style="width: 300px; display: inline-block; vertical-align: middle;">
                                                                                <apex:inputHidden id="SelObjectInputX3" value="{!act.action.d_wh__Identify_Object_By_Field__c}" />
                                                                                <c:SearchablePicklist options="{!act.allFieldOptionsList}" value="{!act.action.d_wh__Identify_Object_By_Field__c}" valueInputId="{!$Component.SelObjectInputX3}" uniqueIdent="999" />
                                                                            </div>
                                                                        </td>
                                                                        <td>
                                                                            <apex:selectList value="{!act.identificationType}" styleClass="slds-input" multiselect="false" size="1">
                                                                                <apex:selectOption itemLabel="{!$Label.d_wh__Request_Body_Node}" itemValue="Request Body Node" rendered="{!callout.d_wh__Method__c != 'GET'}" />
                                                                                <apex:selectOption itemLabel="{!$Label.d_wh__URL_Parameter}" itemValue="URL Parameter" />
                                                                                <apex:actionSupport event="onchange" rerender="identXPanel" status="actionStatus" />
                                                                            </apex:selectList>
                                                                        </td>
                                                                        <td>
                                                                            <apex:outputPanel id="identXPanel">
                                                                                <apex:outputPanel layout="none" rendered="{!act.identificationType == 'URL Parameter'}">
                                                                                    <apex:inputText value="{!act.action.d_wh__Identify_Object_By_URL_Param__c}" styleClass="slds-input" />
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel layout="none" rendered="{!act.identificationType == 'Request Body Node'}">
                                                                                    <b>
                                                                                        <apex:outputPanel layout="inline" rendered="{!act.action.d_wh__Identify_Object_By_JSON_Value__c == null}" style="color:red;">{!$Label.d_wh__None}</apex:outputPanel>
                                                                                        <apex:outputPanel layout="inline" rendered="{!act.action.d_wh__Identify_Object_By_JSON_Value__c != null}" style="color:green;">{!act.action.d_wh__Identify_Object_By_JSON_Value__c}</apex:outputPanel> &nbsp;
                                                                                    </b>
                                                                                    <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                        <apex:param name="guid1" value="{!act.guid}" />
                                                                                        <apex:param name="guid2" value="main" />
                                                                                    </apex:commandButton>
                                                                                </apex:outputPanel>
                                                                            </apex:outputPanel>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            
                                                            <div class="slds-grid slds-wrap slds-gutters">
                                                                <div class="slds-col slds-size_1-of-2">
                                                                    <div style="font-size: 120%; padding: 17px 10px;">
                                                                        <apex:inputField value="{!act.action.d_wh__Create_if_not_found__c}">
                                                                            <apex:actionSupport event="onchange" rerender="mainForm" status="actionStatus" />
                                                                        </apex:inputField>
                                                                        {!$Label.d_wh__Create_record_if_not_found}
                                                                    </div>
                                                                    <br />
                                                                </div>
                                                                <div class="slds-col slds-size_1-of-2">
                                                                    
                                                                </div>
                                                            </div>

                                                            <br />
                                                            <div style="width: 100%; overflow-x: auto;">
                                                                <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                                    <thead>
                                                                        <tr class="slds-line-height_reset">
                                                                            <th class="" scope="col">
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.d_wh__Field}">{!$Label.d_wh__Field}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.Type}">{!$Label.Type}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.d_wh__Value}">{!$Label.d_wh__Value}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="Ignore if empty">Ignore if empty</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.Only_When_Creating}">{!$Label.Only_When_Creating}</div>
                                                                            </th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <apex:variable var="indx" value="{!0}" />
                                                                        <apex:repeat value="{!act.mapping}" var="mp">
                                                                            <tr class="slds-hint-parent">
                                                                                <td data-label="">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:commandButton value="{!$Label.d_wh__Remove_Field}" action="{!ResponseActionRemoveField}" styleClass="slds-button slds-button_text-destructive" style="white-space: nowrap;" rerender="mainForm" status="actionStatus">
                                                                                            <apex:param name="guid1" value="{!act.guid}" />
                                                                                            <apex:param name="guid2" value="{!mp.guid}" />
                                                                                        </apex:commandButton>
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Field}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:inputHidden id="SelObjectInput11" value="{!mp.f}" />
                                                                                        <c:SearchablePicklist options="{!act.allFieldOptionsListEditable}" value="{!mp.f}" valueInputId="{!$Component.SelObjectInput11}" uniqueIdent="{!indx}" />
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Type}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:selectList value="{!mp.t}" styleClass="slds-input" multiselect="false" size="1">
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Request_Element_Mapping}" itemValue="true" rendered="{!callout.d_wh__Method__c != 'GET'}" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__URL_Parameter}" itemValue="param" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Formula}" itemValue="formula" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Static_Value}" itemValue="false" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Metadata}" itemValue="mdt" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Settings}" itemValue="cs" />
                                                                                            <apex:actionSupport event="onchange" rerender="mappingInputs" status="actionStatus" />
                                                                                        </apex:selectList>
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Value}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:outputPanel id="mappingInputs">
                                                                                            <apex:inputText value="{!mp.s}" rendered="{!mp.t == 'false'}" styleClass="slds-input" />
                                                                                            <apex:inputText value="{!mp.p}" rendered="{!mp.t == 'param'}" styleClass="slds-input" />
                                                                                            <apex:outputPanel rendered="{!mp.t == 'formula'}">
                                                                                                <apex:inputTextarea id="fieldFormulaHidden" value="{!mp.g}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:FormulaEditor inboundRequest="{!bodyItemsTree}" acceptParameters="true" acceptHeaders="true" formula="{!mp.g}" inputValueId="{!$Component.fieldFormulaHidden}" />
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel rendered="{!mp.t == 'true'}">
                                                                                                {!$Label.Mapped_To}: &nbsp;
                                                                                                <apex:outputPanel layout="inline" rendered="{!mp.m == null}" style="color:red;">{!$Label.d_wh__Nothing}</apex:outputPanel>
                                                                                                <apex:outputPanel layout="inline" rendered="{!mp.m != null}" style="font-weight: bold;">{!mp.m_esc}</apex:outputPanel> &nbsp;
                                                                                                <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                                                    <apex:param name="guid2" value="{!mp.guid}" />
                                                                                                </apex:commandButton>
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel rendered="{!mp.t == 'mdt'}">
                                                                                                <apex:inputTextarea id="fieldMetadataHidden" value="{!mp.mdt}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:MetadataSelector inputValueId="{!$Component.fieldMetadataHidden}" selectedValue="{!mp.mdt}" />
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel rendered="{!mp.t == 'cs'}">
                                                                                                <apex:inputTextarea id="fieldSettingHidden" value="{!mp.cs}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:CustomSettingsSelector inputValueId="{!$Component.fieldSettingHidden}" selectedValue="{!mp.cs}" />
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="Ignore if empty">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:inputCheckbox value="{!mp.ig}" />
                                                                                        Ignore if empty
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Only_When_Creating}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:inputCheckbox value="{!mp.c}" />
                                                                                        {!$Label.d_wh__Only_When_Creating}
                                                                                    </div>
                                                                                </td>
                                                                            </tr>
                                                                            <apex:variable var="indx" value="{!indx + 1}" />
                                                                        </apex:repeat>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <br />
                                                            <apex:outputPanel id="mappingButtons3">
                                                                <apex:commandButton rendered="{!act.action.d_wh__Object_API_Name__c != null}" value="{!$Label.d_wh__Add_Field}" action="{!ResponseActionAddField}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                </apex:commandButton>
                                                                <apex:commandButton rendered="{!act.action.d_wh__Object_API_Name__c == null}" value="{!$Label.d_wh__Add_Field}" styleClass="slds-button slds-button_neutral" onclick="alert('{!$Label.d_wh__Please_select_an_Object_type_first}'); return false;" />
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>

                                                    </apex:outputPanel>

                                                    <apex:outputPanel layout="none" rendered="{!act.action.d_wh__Type__c == 'Upsert List of Records'}">
                                                        
                                                        <div class="slds-grid slds-wrap slds-gutters">
                                                            <div class="slds-col slds-size_1-of-2">
                                                                <div class="slds-form-element">
                                                                    <label class="slds-form-element__label">
                                                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Object_type}
                                                                    </label>
                                                                    <div class="slds-form-element__control">
                                                                        <apex:outputPanel rendered="{!!act.CanChangeObject}" layout="none">
                                                                            <b>{!act.action.d_wh__Object_API_Name__c}</b>
                                                                            <span style="font-size:75%;">({!$Label.d_wh__You_cannot_change_the_object_name_when_fields_mapping_are_added})</span>
                                                                        </apex:outputPanel>
                                                                        <apex:inputHidden id="SelObjectInput2" value="{!act.action.d_wh__Object_API_Name__c}" />
                                                                        <c:SearchablePicklist rendered="{!act.CanChangeObject}" options="{!objectsOptions}" value="{!act.action.d_wh__Object_API_Name__c}" valueInputId="{!$Component.SelObjectInput2}" functionToCall="RefreshActionsPage" />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="slds-col slds-size_1-of-2">
                                                                <apex:outputPanel rendered="{!callout.d_wh__Object__c != null}" layout="none">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">
                                                                            {!$Label.d_wh__Related_to_the_main_object}
                                                                        </label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:selectList id="relatedFieldsInput3" value="{!act.action.d_wh__Relationship_To_Main_Record__c}" styleClass="slds-input" multiselect="false" size="1">
                                                                                <apex:selectOptions value="{!act.fieldOptions}" />
                                                                            </apex:selectList>
                                                                        </div>
                                                                    </div>
                                                                    <br />
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <br />

                                                        <div style="font-size: 120%; padding: 10px;">
                                                            {!$Label.Mapped_From_JSON_List}: &nbsp;
                                                            <b>
                                                                <apex:outputPanel layout="inline" rendered="{!act.action.d_wh__JSON_Node__c == null}" style="color:red;">{!$Label.d_wh__None}</apex:outputPanel>
                                                                <apex:outputPanel layout="inline" rendered="{!act.action.d_wh__JSON_Node__c != null}" style="font-weight: bold;">{!act.jsonNodeEsc}</apex:outputPanel> &nbsp;
                                                            </b>
                                                            <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                <apex:param name="guid1" value="{!act.guid}" />
                                                                <apex:param name="guid2" value="list" />
                                                            </apex:commandButton>
                                                        </div>
                                                        <br />

                                                        <apex:outputPanel layout="none" rendered="{!AND(act.action.d_wh__Object_API_Name__c != null, act.action.d_wh__Object_API_Name__c != '', act.action.d_wh__JSON_Node__c != null, act.action.d_wh__JSON_Node__c != '')}">
                                                            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                                <thead>
                                                                    <tr class="slds-line-height_reset">
                                                                        <th class="" scope="col">
                                                                            <div class="slds-truncate">{!$Label.d_wh__Match_record_by}</div>
                                                                        </th>
                                                                        <th class="" scope="col">
                                                                            <apex:outputText value="{!$Label.d_wh__Matching_JSON_Value}" rendered="{!callout.d_wh__Request_Body_Format__c == 'application/json'}" />
                                                                            <apex:outputText value="{!$Label.d_wh__Matching_Body_Value}" rendered="{!callout.d_wh__Request_Body_Format__c == 'application/x-www-form-urlencoded'}" />
                                                                        </th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="slds-hint-parent">
                                                                        <td>
                                                                            <b>{!act.action.d_wh__Object_API_Name__c} -> </b>
                                                                            <div style="width: 300px; display: inline-block; vertical-align: middle;">
                                                                                <apex:inputHidden id="SelObjectInputX2" value="{!act.action.d_wh__Identify_Object_By_Field__c}" />
                                                                                <c:SearchablePicklist options="{!act.allFieldOptionsList}" value="{!act.action.d_wh__Identify_Object_By_Field__c}" valueInputId="{!$Component.SelObjectInputX2}" uniqueIdent="999" />
                                                                            </div>
                                                                        </td>
                                                                        <td>
                                                                            <b>
                                                                                <apex:outputPanel layout="inline" rendered="{!act.action.d_wh__Identify_Object_By_JSON_Value__c == null}" style="color:red;">{!$Label.d_wh__None}</apex:outputPanel>
                                                                                <apex:outputPanel layout="inline" rendered="{!act.action.d_wh__Identify_Object_By_JSON_Value__c != null}" style="color:green;">{!act.jsonIdentEsc}</apex:outputPanel> &nbsp;
                                                                            </b>
                                                                            <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                <apex:param name="guid1" value="{!act.guid}" />
                                                                                <apex:param name="guid2" value="main" />
                                                                            </apex:commandButton>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <br />
                                                            
                                                            <div class="slds-grid slds-wrap slds-gutters">
                                                                <div class="slds-col slds-size_1-of-2">
                                                                    <div style="font-size: 120%; padding: 17px 10px;">
                                                                        <apex:inputField value="{!act.action.d_wh__Create_if_not_found__c}">
                                                                            <apex:actionSupport event="onchange" rerender="mainForm" status="actionStatus" />
                                                                        </apex:inputField>
                                                                        {!$Label.d_wh__Create_record_if_not_found}
                                                                    </div>
                                                                    <br />
                                                                </div>
                                                                <div class="slds-col slds-size_1-of-2">
                                                                    
                                                                </div>
                                                            </div>

                                                            <br />
                                                            <div style="width: 100%; overflow-x: auto;">
                                                                <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                                    <thead>
                                                                        <tr class="slds-line-height_reset">
                                                                            <th class="" scope="col">
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.d_wh__Field}">{!$Label.d_wh__Field}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.Type}">{!$Label.Type}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.d_wh__Value}">{!$Label.d_wh__Value}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="Ignore if empty">Ignore if empty</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.Only_When_Creating}">{!$Label.Only_When_Creating}</div>
                                                                            </th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <apex:variable var="indx" value="{!0}" />
                                                                        <apex:repeat value="{!act.mapping}" var="mp">
                                                                            <tr class="slds-hint-parent">
                                                                                <td data-label="">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:commandButton value="{!$Label.d_wh__Remove_Field}" action="{!ResponseActionRemoveField}" styleClass="slds-button slds-button_text-destructive" style="white-space: nowrap;" rerender="mainForm" status="actionStatus">
                                                                                            <apex:param name="guid1" value="{!act.guid}" />
                                                                                            <apex:param name="guid2" value="{!mp.guid}" />
                                                                                        </apex:commandButton>
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Field}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:inputHidden id="SelObjectInput11" value="{!mp.f}" />
                                                                                        <c:SearchablePicklist options="{!act.allFieldOptionsListEditable}" value="{!mp.f}" valueInputId="{!$Component.SelObjectInput11}" uniqueIdent="{!indx}" />
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Type}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:selectList value="{!mp.t}" styleClass="slds-input" multiselect="false" size="1">
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Request_Element_Mapping}" itemValue="true" rendered="{!callout.d_wh__Method__c != 'GET'}" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__URL_Parameter}" itemValue="param" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Formula}" itemValue="formula" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Static_Value}" itemValue="false" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Metadata}" itemValue="mdt" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Settings}" itemValue="cs" />
                                                                                            <apex:actionSupport event="onchange" rerender="mappingInputs" status="actionStatus" />
                                                                                        </apex:selectList>
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Value}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:outputPanel id="mappingInputs">
                                                                                            <apex:inputText value="{!mp.s}" rendered="{!mp.t == 'false'}" styleClass="slds-input" />
                                                                                            <apex:inputText value="{!mp.p}" rendered="{!mp.t == 'param'}" styleClass="slds-input" />
                                                                                            <apex:outputPanel rendered="{!mp.t == 'formula'}">
                                                                                                <apex:inputTextarea id="fieldFormulaHidden" value="{!mp.g}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:FormulaEditor inboundRequest="{!bodyItemsTree}" startNode="{!IF(act.action.d_wh__JSON_Node__c == 'Main Node', '', act.action.d_wh__JSON_Node__c)}" acceptParameters="true" acceptHeaders="true" formula="{!mp.g}" inputValueId="{!$Component.fieldFormulaHidden}" />
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel rendered="{!mp.t == 'true'}">
                                                                                                {!$Label.Mapped_To}: &nbsp;
                                                                                                <apex:outputPanel layout="inline" rendered="{!mp.m == null}" style="color:red;">{!$Label.d_wh__Nothing}</apex:outputPanel>
                                                                                                <apex:outputPanel layout="inline" rendered="{!mp.m != null}" style="font-weight: bold;">{!mp.m_esc}</apex:outputPanel> &nbsp;
                                                                                                <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                                                    <apex:param name="guid2" value="{!mp.guid}" />
                                                                                                </apex:commandButton>
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel rendered="{!mp.t == 'mdt'}">
                                                                                                <apex:inputTextarea id="fieldMetadataHidden" value="{!mp.mdt}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:MetadataSelector inputValueId="{!$Component.fieldMetadataHidden}" selectedValue="{!mp.mdt}" />
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel rendered="{!mp.t == 'cs'}">
                                                                                                <apex:inputTextarea id="fieldSettingHidden" value="{!mp.cs}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:CustomSettingsSelector inputValueId="{!$Component.fieldSettingHidden}" selectedValue="{!mp.cs}" />
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="Ignore if empty">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:inputCheckbox value="{!mp.ig}" />
                                                                                        Ignore if empty
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Only_When_Creating}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:inputCheckbox value="{!mp.c}" />
                                                                                        {!$Label.d_wh__Only_When_Creating}
                                                                                    </div>
                                                                                </td>
                                                                            </tr>
                                                                            <apex:variable var="indx" value="{!indx + 1}" />
                                                                        </apex:repeat>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <br />
                                                            <apex:outputPanel id="mappingButtons4">
                                                                <apex:commandButton rendered="{!act.action.d_wh__Object_API_Name__c != null}" value="{!$Label.d_wh__Add_Field}" action="{!ResponseActionAddField}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                </apex:commandButton>
                                                                <apex:commandButton rendered="{!act.action.d_wh__Object_API_Name__c == null}" value="{!$Label.d_wh__Add_Field}" styleClass="slds-button slds-button_neutral" onclick="alert('{!$Label.d_wh__Please_select_an_Object_type_first}'); return false;" />
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>

                                                    <apex:outputPanel layout="none" rendered="{!act.action.d_wh__Type__c == 'Create / Update File'}">
                                                        
                                                        <div class="slds-grid slds-wrap slds-gutters">
                                                            <div class="slds-col slds-size_1-of-2">
                                                                <div class="slds-form-element">
                                                                    <label class="slds-form-element__label">
                                                                        <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Object_type}
                                                                    </label>
                                                                    <div class="slds-form-element__control">
                                                                        <apex:selectList value="{!act.action.d_wh__Object_API_Name__c}" styleClass="slds-input" multiselect="false" size="1">
                                                                            <apex:selectOption itemLabel="File (ContentDocument)" itemValue="ContentVersion" />
                                                                            <apex:selectOption itemLabel="Attachment" itemValue="Attachment" />
                                                                            <apex:actionSupport event="onchange" action="{!RefreshFileMapping}" rerender="mappingInputs,relationOutputs" status="actionStatus" />
                                                                        </apex:selectList>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="slds-col slds-size_1-of-2">
                                                                <apex:outputPanel rendered="{!callout.d_wh__Object__c != null}" layout="none">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">
                                                                            {!$Label.d_wh__Related_to_the_main_object}
                                                                        </label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:outputPanel id="relationOutputs">
                                                                                <apex:outputText rendered="{!act.action.d_wh__Object_API_Name__c == 'Attachment'}" value="ParentId" />
                                                                                <apex:outputText rendered="{!act.action.d_wh__Object_API_Name__c == 'ContentVersion'}" value="ContentDocumentLink record" />
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </div>
                                                                    <br />
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <br />

                                                        <apex:outputPanel id="mappingInputs">

                                                            <div style="font-size: 120%; padding: 10px;">
                                                                {!$Label.d_wh__Match_record_by}:
                                                                <b>{!act.action.d_wh__Object_API_Name__c} -> </b>
                                                                <div style="width: 300px; display: inline-block; vertical-align: middle;">
                                                                    <apex:inputHidden id="SelObjectInputX9" value="{!act.action.d_wh__Identify_Object_By_Field__c}" />
                                                                    <c:SearchablePicklist options="{!act.allFieldOptionsList}" value="{!act.action.d_wh__Identify_Object_By_Field__c}" valueInputId="{!$Component.SelObjectInputX9}" uniqueIdent="999" />
                                                                </div>
                                                                {!$Label.d_wh__Matching_JSON_Value}:&nbsp;
                                                                <b>
                                                                    <apex:outputPanel layout="inline" rendered="{!act.action.d_wh__Identify_Object_By_JSON_Value__c == null}" style="color:red;">{!$Label.d_wh__None}</apex:outputPanel>
                                                                    <apex:outputPanel layout="inline" rendered="{!act.action.d_wh__Identify_Object_By_JSON_Value__c != null}" style="color:green;">{!act.action.d_wh__Identify_Object_By_JSON_Value__c}</apex:outputPanel> &nbsp;
                                                                </b>
                                                                <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                    <apex:param name="guid2" value="main" />
                                                                </apex:commandButton>
                                                            </div>
                                                            <br />
                                                                
                                                            <div class="slds-grid slds-wrap slds-gutters">
                                                                <div class="slds-col slds-size_1-of-1">
                                                                    <div style="font-size: 120%; padding: 17px 10px;">
                                                                        <apex:outputPanel rendered="{!OR(callout.d_wh__Object__c != null, act.action.d_wh__Object_API_Name__c == 'ContentVersion')}">
                                                                            <apex:inputField value="{!act.action.d_wh__Create_if_not_found__c}">
                                                                                <apex:actionSupport event="onchange" rerender="mainForm" status="actionStatus" />
                                                                            </apex:inputField>
                                                                            {!$Label.d_wh__Create_record_if_not_found}
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel rendered="{!AND(callout.d_wh__Object__c = null, act.action.d_wh__Object_API_Name__c == 'Attachment')}">
                                                                            <span style="color: gray;">{!$Label.d_wh__Attachment_without_parent_Warning}</span>
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                    <br />
                                                                </div>
                                                            </div>

                                                            <br />
                                                            <div style="width: 100%; overflow-x: auto; padding-right: 9px; padding-bottom: 7px;">
                                                                <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                                    <thead>
                                                                        <tr class="slds-line-height_reset">
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.d_wh__Field}">{!$Label.d_wh__Field}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.Type}">{!$Label.Type}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.d_wh__Value}">{!$Label.d_wh__Value}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.Convert_From}">{!$Label.Convert_From}</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="Ignore if empty">Ignore if empty</div>
                                                                            </th>
                                                                            <th class="" scope="col">
                                                                                <div class="slds-truncate" title="{!$Label.Only_When_Creating}">{!$Label.Only_When_Creating}</div>
                                                                            </th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <apex:variable var="indx" value="{!0}" />
                                                                        <apex:repeat value="{!act.mapping}" var="mp">
                                                                            <tr class="slds-hint-parent">
                                                                                <td data-label="{!$Label.d_wh__Field}">
                                                                                    <div class="slds-truncate" style="padding-top:3px;">
                                                                                        {!mp.f}
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Type}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:selectList value="{!mp.t}" styleClass="slds-input" multiselect="false" size="1">
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__No_Mapping}" itemValue="none" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__JSON_Mapping}" itemValue="true" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Formula}" itemValue="formula" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Static_Value}" itemValue="false" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Metadata}" itemValue="mdt" />
                                                                                            <apex:selectOption itemLabel="{!$Label.d_wh__Custom_Settings}" itemValue="cs" />
                                                                                            <apex:actionSupport event="onchange" rerender="mappingInputs" status="actionStatus" />
                                                                                        </apex:selectList>
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Value}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:outputPanel id="mappingInputs">
                                                                                            <apex:outputPanel rendered="{!mp.t == 'true'}">
                                                                                                {!$Label.Mapped_To}: &nbsp;
                                                                                                <apex:outputPanel layout="inline" rendered="{!mp.m == null}" style="color:red;">{!$Label.d_wh__Nothing}</apex:outputPanel>
                                                                                                <apex:outputPanel layout="inline" rendered="{!mp.m != null}" style="font-weight: bold;">{!mp.m_esc}</apex:outputPanel> &nbsp;
                                                                                                <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                                                    <apex:param name="guid2" value="{!mp.guid}" />
                                                                                                </apex:commandButton>
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel rendered="{!mp.t == 'formula'}">
                                                                                                <apex:inputTextarea id="fieldFormulaHidden" value="{!mp.g}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:FormulaEditor inboundRequest="{!bodyItemsTree}" formula="{!mp.g}" inputValueId="{!$Component.fieldFormulaHidden}" />
                                                                                            </apex:outputPanel>
                                                                                            <apex:inputText value="{!mp.s}" rendered="{!mp.t == 'false'}" styleClass="slds-input" />
                                                                                            <apex:outputPanel rendered="{!mp.t == 'mdt'}">
                                                                                                <apex:inputTextarea id="fieldMetadataHidden" value="{!mp.mdt}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:MetadataSelector inputValueId="{!$Component.fieldMetadataHidden}" selectedValue="{!mp.mdt}" />
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel rendered="{!mp.t == 'cs'}">
                                                                                                <apex:inputTextarea id="fieldSettingHidden" value="{!mp.cs}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                                                <c:CustomSettingsSelector inputValueId="{!$Component.fieldSettingHidden}" selectedValue="{!mp.cs}" />
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Convert_From}">
                                                                                    <apex:selectList rendered="{!AND(mp.t != 'none', OR(mp.f == 'Body', mp.f == 'VersionData'))}" value="{!mp.conv}" styleClass="slds-input" multiselect="false" size="1">
                                                                                        <apex:selectOption itemLabel="Base64" itemValue="Base64" />
                                                                                        <apex:selectOption itemLabel="Hex" itemValue="Hex" />
                                                                                        <apex:selectOption itemLabel="Store the raw text" itemValue="Raw" />
                                                                                    </apex:selectList>
                                                                                </td>
                                                                                <td data-label="Ignore if empty">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:inputCheckbox value="{!mp.ig}" />
                                                                                        Ignore if empty
                                                                                    </div>
                                                                                </td>
                                                                                <td data-label="{!$Label.d_wh__Only_When_Creating}">
                                                                                    <div class="slds-truncate">
                                                                                        <apex:inputCheckbox value="{!mp.c}" />
                                                                                        {!$Label.d_wh__Only_When_Creating}
                                                                                    </div>
                                                                                </td>
                                                                            </tr>
                                                                            <apex:variable var="indx" value="{!indx + 1}" />
                                                                        </apex:repeat>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </apex:outputPanel>

                                                    </apex:outputPanel>

                                                    <apex:outputPanel layout="none" rendered="{!act.action.d_wh__Type__c == 'Run Autolaunched Flow'}">

                                                        <div class="slds-form-element">
                                                            <label class="slds-form-element__label">
                                                                <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Please_Select_Flow}
                                                            </label>
                                                            <div class="slds-form-element__control">
                                                                <apex:selectList value="{!act.action.d_wh__Flow_Name__c}" styleClass="slds-input" multiselect="false" size="1">
                                                                    <apex:selectOptions value="{!availableFlows}" />
                                                                    <apex:actionSupport event="onchange" rerender="availableFlowVariables" status="actionStatus" action="{!RefreshFlowVars}" />
                                                                </apex:selectList>
                                                            </div>
                                                        </div>

                                                        <apex:outputPanel id="availableFlowVariables">

                                                            <apex:outputPanel layout="none" rendered="{!act.hasFlowVariables}">

                                                                <br /><br />
                                                                <b>{!$Label.Flow_Variables}</b>
                                                                <br /><br />

                                                                <div style="width: 100%; overflow-x: auto;">
                                                                    <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                                        <thead>
                                                                            <tr class="slds-line-height_reset">
                                                                                <th class="" scope="col">
                                                                                    <div class="slds-truncate" title="{!$Label.Variable_Name}">{!$Label.Variable_Name}</div>
                                                                                </th>
                                                                                <th class="" scope="col">
                                                                                    <div class="slds-truncate" title="{!$Label.Type}">{!$Label.Type}</div>
                                                                                </th>
                                                                                <th class="" scope="col">
                                                                                    <div class="slds-truncate" title="{!$Label.d_wh__Value}">{!$Label.d_wh__Value}</div>
                                                                                </th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <apex:repeat value="{!act.flowVariables}" var="flowVar">
                                                                                <tr class="slds-hint-parent">
                                                                                    <td data-label="{!$Label.d_wh__Variable_Name}">
                                                                                        <div class="slds-truncate">
                                                                                            {!flowVar.v}
                                                                                        </div>
                                                                                    </td>
                                                                                    <td data-label="{!$Label.d_wh__Type}">
                                                                                        <div class="slds-truncate">
                                                                                            <apex:selectList value="{!flowVar.t}" styleClass="slds-input" multiselect="false" size="1">
                                                                                                <apex:selectOption itemLabel="{!$Label.d_wh__No_Mapping}" itemValue="" />
                                                                                                <apex:selectOption itemLabel="{!$Label.d_wh__Main_Record_Id}" itemValue="i" />
                                                                                                <apex:selectOption itemLabel="{!$Label.d_wh__Request_Element_Mapping}" itemValue="n" rendered="{!callout.d_wh__Method__c != 'GET'}" />
                                                                                                <apex:selectOption itemLabel="{!$Label.d_wh__URL_Parameter}" itemValue="p" />
                                                                                                <apex:actionSupport event="onchange" rerender="flowVarInputs" status="actionStatus" />
                                                                                            </apex:selectList>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td data-label="{!$Label.d_wh__Value}">
                                                                                        <div class="slds-truncate">
                                                                                            <apex:outputPanel id="flowVarInputs">
                                                                                                <apex:outputPanel rendered="{!flowVar.t == 'i'}">
                                                                                                    <apex:outputText escape="false" value="{!$Label.d_wh__Main_Record_Id_Help}" />
                                                                                                </apex:outputPanel>
                                                                                                <apex:outputPanel rendered="{!flowVar.t == 'n'}">
                                                                                                    {!$Label.Mapped_To}: &nbsp;
                                                                                                    <apex:outputPanel layout="inline" rendered="{!flowVar.m == null}" style="color:red;">{!$Label.d_wh__Nothing}</apex:outputPanel>
                                                                                                    <apex:outputPanel layout="inline" rendered="{!flowVar.m != null}" style="font-weight: bold;">{!flowVar.m_esc}</apex:outputPanel> &nbsp;
                                                                                                    <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                                        <apex:param name="guid1" value="{!act.guid}" />
                                                                                                        <apex:param name="guid2" value="{!flowVar.v}" />
                                                                                                    </apex:commandButton>
                                                                                                </apex:outputPanel>
                                                                                                <apex:outputPanel rendered="{!flowVar.t == 'p'}">
                                                                                                    <apex:inputText value="{!flowVar.p}" styleClass="slds-input" />
                                                                                                </apex:outputPanel>
                                                                                            </apex:outputPanel>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            </apex:repeat>
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="none" rendered="{!!act.hasFlowVariables}">
                                                                <br /><br />
                                                                <b>{!$Label.This_Flow_has_no_variables}</b>
                                                                <br /><br />
                                                            </apex:outputPanel>

                                                        </apex:outputPanel>

                                                    </apex:outputPanel>

                                                    <apex:outputPanel layout="none" rendered="{!act.action.d_wh__Type__c == 'Run Apex'}">

                                                        <div class="slds-form-element">
                                                            <label class="slds-form-element__label">
                                                                <abbr class="slds-required" title="required">* </abbr>{!$Label.d_wh__Apex_Class_Name}
                                                            </label>
                                                            <div class="slds-form-element__control">
                                                                <apex:inputField value="{!act.action.d_wh__Apex_Class_Name__c}" styleClass="slds-input" />
                                                            </div>
                                                        </div>
                                                        <br />
                                                        <br />
                                                        <apex:outputText value="{!$Label.d_wh__Inbound_Action_Apex_Help}" escape="false" />

                                                    </apex:outputPanel>

                                                    <br /><br /><br />
                                                    <apex:inputCheckbox value="{!act.action.d_wh__Skip_if_no_main_record__c}" />
                                                    {!$Label.Skip_if_no_main_record}

                                                    <br /><hr />

                                                    <div style="font-size: 120%; padding: 10px;">
                                                        {!$Label.This_Action_Runs}:
                                                        <b>
                                                            {!act.criteria.Summary} &nbsp; &nbsp;
                                                            <apex:commandLink action="{!OpenActionCriteriaDetails}" value="[{!$Label.d_wh__Customize}]" reRender="mainForm" status="actionStatus" rendered="{!!act.criteriaOpen}">
                                                                <apex:param name="guid1" value="{!act.guid}" />
                                                            </apex:commandLink>
                                                        </b>
                                                    </div>
                                                    <apex:outputPanel layout="none" rendered="{!act.criteriaOpen}">
                                                        <br /><br />
                                                        <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                                            <thead>
                                                                <tr class="slds-line-height_reset">
                                                                    <th class="" scope="col">
                                                                    </th>
                                                                    <th class="" scope="col">
                                                                        <div class="slds-truncate" title="{!$Label.Item}">{!$Label.Item}</div>
                                                                    </th>
                                                                    <th class="" scope="col">
                                                                        <div class="slds-truncate" title="{!$Label.Operator}">{!$Label.Operator}</div>
                                                                    </th>
                                                                    <th class="" scope="col">
                                                                        <div class="slds-truncate" title="{!$Label.d_wh__Value}">{!$Label.d_wh__Value}</div>
                                                                    </th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <apex:repeat value="{!act.criteria.hs}" var="crit">
                                                                    <tr class="slds-hint-parent">
                                                                        <td data-label="">
                                                                            <div class="">
                                                                                <apex:commandButton value="{!$Label.d_wh__Remove}" action="{!RemoveActionCriteria}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                                    <apex:param name="guid2" value="{!crit.guid}" />
                                                                                </apex:commandButton>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.Header}">
                                                                            <div class="">
                                                                                <b>{!$Label.Header} :</b> &nbsp;
                                                                                <apex:inputText value="{!crit.n}" styleClass="slds-input" style="width: 60%;" />
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Operator}">
                                                                            <div class="">
                                                                                <apex:selectList value="{!crit.o}" size="1" multiselect="false" styleClass="slds-input">
                                                                                    <apex:selectOption itemValue="" itemLabel="-- Please select --" />
                                                                                    <apex:selectOption itemValue="=" itemLabel="=" />
                                                                                    <apex:selectOption itemValue="!=" itemLabel="!=" />
                                                                                    <apex:selectOption itemValue="CONTAINS" itemLabel="CONTAINS" />
                                                                                    <apex:selectOption itemValue="ISNULL" itemLabel="EXISTS" />
                                                                                    <apex:selectOption itemValue="ISNOTNULL" itemLabel="DOES NOT EXIST" />
                                                                                    <apex:actionSupport event="onchange" reRender="mainForm" status="actionStatus" />
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Value}">
                                                                            <div class="">
                                                                                <apex:inputText value="{!crit.v}" styleClass="slds-input" rendered="{!AND(crit.o != null, crit.o != '', crit.o != 'ISNULL', crit.o != 'ISNOTNULL')}" />
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                </apex:repeat>
                                                                <apex:repeat value="{!act.criteria.cs}" var="crit">
                                                                    <tr class="slds-hint-parent">
                                                                        <td data-label="">
                                                                            <div class="">
                                                                                <apex:commandButton value="{!$Label.d_wh__Remove}" action="{!RemoveActionCriteria}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                                    <apex:param name="guid2" value="{!crit.guid}" />
                                                                                </apex:commandButton>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.Node}">
                                                                            <div class="">
                                                                                <b>
                                                                                    {!$Label.Node} : &nbsp;
                                                                                    <apex:outputPanel layout="inline" rendered="{!OR(crit.n == null, crit.n == '')}" style="color:red;">{!$Label.d_wh__None}</apex:outputPanel>
                                                                                    <apex:outputPanel layout="inline" rendered="{!AND(crit.n != null, crit.n != '')}" style="color:green;">{!crit.n}</apex:outputPanel> &nbsp;
                                                                                </b>
                                                                                <apex:commandButton value="{!$Label.d_wh__Select}" action="{!OpenJSONSelector}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                                    <apex:param name="guid2" value="crit-{!crit.guid}" />
                                                                                </apex:commandButton>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Operator}">
                                                                            <div class="">
                                                                                <apex:selectList value="{!crit.o}" size="1" multiselect="false" styleClass="slds-input">
                                                                                    <apex:selectOption itemValue="" itemLabel="-- Please select --" />
                                                                                    <apex:selectOption itemValue="=" itemLabel="=" />
                                                                                    <apex:selectOption itemValue="!=" itemLabel="!=" />
                                                                                    <apex:selectOption itemValue=">" itemLabel=">" />
                                                                                    <apex:selectOption itemValue="<" itemLabel="<" />
                                                                                    <apex:selectOption itemValue=">=" itemLabel=">=" />
                                                                                    <apex:selectOption itemValue="<=" itemLabel="<=" />
                                                                                    <apex:selectOption itemValue="CONTAINS" itemLabel="CONTAINS" />
                                                                                    <apex:selectOption itemValue="ISNULL" itemLabel="IS NULL" />
                                                                                    <apex:selectOption itemValue="ISNOTNULL" itemLabel="IS NOT NULL" />
                                                                                    <apex:actionSupport event="onchange" reRender="mainForm" status="actionStatus" />
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Value}">
                                                                            <div class="">
                                                                                <apex:inputText value="{!crit.v}" styleClass="slds-input" rendered="{!AND(crit.o != null, crit.o != '', crit.o != 'ISNULL', crit.o != 'ISNOTNULL')}" />
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                </apex:repeat>
                                                                <apex:repeat value="{!act.criteria.ps}" var="crit">
                                                                    <tr class="slds-hint-parent">
                                                                        <td data-label="">
                                                                            <div class="">
                                                                                <apex:commandButton value="{!$Label.d_wh__Remove}" action="{!RemoveActionCriteria}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                                                    <apex:param name="guid1" value="{!act.guid}" />
                                                                                    <apex:param name="guid2" value="{!crit.guid}" />
                                                                                </apex:commandButton>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__URL_Parameter}">
                                                                            <div class="">
                                                                                <b>{!$Label.d_wh__URL_Parameter} :</b> &nbsp;
                                                                                <apex:inputText value="{!crit.n}" styleClass="slds-input" style="width: 60%;" />
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Operator}">
                                                                            <div class="">
                                                                                <apex:selectList value="{!crit.o}" size="1" multiselect="false" styleClass="slds-input">
                                                                                    <apex:selectOption itemValue="" itemLabel="-- Please select --" />
                                                                                    <apex:selectOption itemValue="=" itemLabel="=" />
                                                                                    <apex:selectOption itemValue="!=" itemLabel="!=" />
                                                                                    <apex:selectOption itemValue=">" itemLabel=">" />
                                                                                    <apex:selectOption itemValue="<" itemLabel="<" />
                                                                                    <apex:selectOption itemValue=">=" itemLabel=">=" />
                                                                                    <apex:selectOption itemValue="<=" itemLabel="<=" />
                                                                                    <apex:selectOption itemValue="CONTAINS" itemLabel="CONTAINS" />
                                                                                    <apex:selectOption itemValue="ISNULL" itemLabel="IS NULL" />
                                                                                    <apex:selectOption itemValue="ISNOTNULL" itemLabel="IS NOT NULL" />
                                                                                    <apex:actionSupport event="onchange" reRender="mainForm" status="actionStatus" />
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </td>
                                                                        <td data-label="{!$Label.d_wh__Value}">
                                                                            <div class="">
                                                                                <apex:inputText value="{!crit.v}" styleClass="slds-input" rendered="{!AND(crit.o != null, crit.o != '', crit.o != 'ISNULL', crit.o != 'ISNOTNULL')}" />
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                </apex:repeat>
                                                                <apex:outputPanel layout="none" rendered="{!act.criteria.showBooleanCriteria}">
                                                                    <tr class="slds-hint-parent">
                                                                        <td data-label="" colspan="4">
                                                                            <div class="">
                                                                                <b>{!$Label.Run_Action_If}:&nbsp;</b>
                                                                                <apex:selectList value="{!act.criteria.o}" size="1" multiselect="false" styleClass="slds-input" style="width:300px;">
                                                                                    <apex:selectOption itemValue="AND" itemLabel="{!$Label.d_wh__All_Criteria_Is_Satisfied}" />
                                                                                    <apex:selectOption itemValue="OR" itemLabel="{!$Label.d_wh__Any_Criteria_Is_Satisfied}" />
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </td>
                                                                    </tr>
                                                                </apex:outputPanel>
                                                            </tbody>
                                                        </table>
                                                        <br />
                                                        <apex:commandButton value="{!$Label.d_wh__Add_Header_Criteria}" action="{!AddActionCriteriaHeader}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                            <apex:param name="guid1" value="{!act.guid}" />
                                                        </apex:commandButton>
                                                        <apex:commandButton value="{!$Label.d_wh__Add_Node_Criteria}" action="{!AddActionCriteriaNode}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                            <apex:param name="guid1" value="{!act.guid}" />
                                                        </apex:commandButton>
                                                        <apex:commandButton value="{!$Label.d_wh__Add_URL_Criteria}" action="{!AddActionCriteriaURL}" styleClass="slds-button slds-button_brand" rerender="mainForm" status="actionStatus">
                                                            <apex:param name="guid1" value="{!act.guid}" />
                                                        </apex:commandButton>
                                                    </apex:outputPanel>
                                                    <br />

                                                </apex:outputPanel>
                                            </apex:repeat>
                                        </div>

                                        <footer class="slds-card__footer" style="text-align: right;">
                                            <apex:commandButton action="{!SaveActionsQuick}" value="{!$Label.d_wh__Save_Changes}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                            <apex:repeat value="{!responseActions}" var="act">
                                                <apex:outputPanel layout="none" rendered="{!displayActionDetails == act.guid}">
                                                        <apex:commandButton styleClass="slds-button slds-button_text-destructive" value="{!$Label.d_wh__Remove_Action}" action="{!RemoveResponseAction}" rerender="mainForm" status="actionStatus">
                                                            <apex:param name="guid" value="{!act.guid}" />
                                                        </apex:commandButton>
                                                </apex:outputPanel>
                                            </apex:repeat>
                                        </footer>
                                    </article>
                                </div>
                            </div>

                            <br />
                            <br />

                        </div>
                    </div>
                </div>

            </apex:outputPanel>

            <apex:outputPanel layout="none" rendered="{!step == 4}">

                <div class="slds-page-header slds-page-header_record-home">
                    <div class="slds-page-header__row">
                        <div class="slds-page-header__col-title">
                            <div class="slds-media">
                                <div class="slds-media__body">
                                    <div class="slds-page-header__name">
                                        <div class="slds-page-header__name-title">
                                            <h1>
                                                <span>{!$Label.Edit_Inbound_Call_Template} : <b>{!callout.Name}</b></span>
                                                <span class="slds-page-header__title slds-truncate" title="{!$Label.Response_Body}">{!$Label.Response_Body}</span>
                                                <br />
                                            </h1>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="slds-page-header__col-actions">
                            <div class="slds-page-header__controls">
                                <div class="slds-page-header__control">
                                    <ul class="slds-button-group-list">
                                        <li>
                                            <apex:commandButton action="{!Cancel}" value="{!$Label.d_wh__Cancel}" styleClass="slds-button slds-button_neutral" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!GoBack}" value="{!$Label.d_wh__Back}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!SaveResponseQuick}" value="{!$Label.d_wh__Quick_Save}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                        <li>
                                            <apex:commandButton action="{!SaveResponseClose}" value="{!$Label.d_wh__Save_and_Close}" styleClass="slds-button slds-button_brand" reRender="mainForm" status="actionStatus" />
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="slds-page-header__row slds-page-header__row_gutters" style="background-color: white;">
                        <div class="slds-page-header__col-details">
                            
                            <br />
                            <div class="vf-message-wrapper">
                                <apex:pageMessages />
                            </div>
                            <br />

                            <apex:actionFunction name="ChangeResponseTab" action="{!ChangeResponseTab}" rerender="mainForm" status="actionStatus">
                                <apex:param name="tabName" value="2XX" />
                            </apex:actionFunction>

                            <div class="slds-tabs_default">
                                <ul class="slds-tabs_default__nav" role="tablist">
                                    <li class="slds-tabs_default__item {!IF(currentResponseType == '2XX', 'slds-is-active', '')}" title="Success (200)" role="presentation">
                                        <a class="slds-tabs_default__link" href="#" role="tab" aria-selected="false" aria-controls="tab-default-1" id="tab-default-1__item" onclick="ChangeResponseTab('2XX'); return false;">{!$Label.Success_200}</a>
                                    </li>
                                    <li class="slds-tabs_default__item {!IF(currentResponseType == '4XX', 'slds-is-active', '')}" title="Error (4XX)" role="presentation">
                                        <a class="slds-tabs_default__link" href="#" role="tab" aria-selected="false" aria-controls="tab-default-2" id="tab-default-2__item" onclick="ChangeResponseTab('4XX'); return false;">{!$Label.Error_4XX}</a>
                                    </li>
                                    <li class="slds-tabs_default__item {!IF(currentResponseType == '5XX', 'slds-is-active', '')}" title="Error (5XX)" role="presentation">
                                        <a class="slds-tabs_default__link" href="#" role="tab" aria-selected="false" aria-controls="tab-default-3" id="tab-default-3__item" onclick="ChangeResponseTab('5XX'); return false;">{!$Label.Error_5XX}</a>
                                    </li>
                                </ul>

                                <div id="tab-default-1" class="slds-tabs_default__content {!IF(currentResponseType == '2XX', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="tab-default-1__item">
                                    <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_header-hidden" style="font-weight: bold; font-size: 120%;">
                                        <thead class="slds-assistive-text">
                                            <tr class="slds-line-height_reset">
                                                <th class="" scope="col"></th>
                                                <th class="" scope="col"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <apex:repeat value="{!displayRespNodes2XX}" var="node">
                                                <apex:outputPanel layout="none" rendered="{!node.closingNode != true}">
                                                    <tr class="slds-hint-parent">
                                                        <td style="text-align: right; padding-right:20px; width:70px;">
                                                            <apex:outputPanel rendered="{!!node.node.mainObject}">
                                                                <apex:commandButton value="-" styleClass="slds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!RemoveNode}" rerender="mainForm" status="actionStatus">
                                                                    <apex:param name="nodeGuid" value="{!node.node.guid}" />
                                                                </apex:commandButton>
                                                            </apex:outputPanel>
                                                            
                                                            <apex:commandLink styleClass="slds-button slslds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!OpenEditNode}" rerender="mainForm" status="actionStatus">
                                                                <img src="/img/func_icons/util/pencil12.gif" />
                                                                <apex:param name="nodeGuid" value="{!node.node.guid}" />
                                                            </apex:commandLink>
                                                        </td>
                                                        <td data-label="">
                                                            <div class="slds-truncate" title="">
                                                                <div style="display:inline-block; width: {!node.node.levelIdent}px;"></div>
        
                                                                <apex:outputPanel rendered="{!!node.node.mainObject}">
                                                                    "<apex:outputText value="{!node.node.node.Name}" />" :&nbsp;
                                                                </apex:outputPanel>
        
                                                                <apex:outputText value="{" rendered="{!node.node.node.d_wh__Node_Type__c == 'Object'}" />
        
                                                                <apex:outputText value="[ {" rendered="{!node.node.node.d_wh__Node_Type__c == 'List'}" />
        
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Type__c == 'Value'}">
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Field'}" value="{!'{{' + NULLVALUE(node.node.currentObject, callout.d_wh__Object__c) + '.' + node.node.node.d_wh__Field_Reference__c + '}}'}" style="color: blue;" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Static'}" value="{!node.node.node.d_wh__Static_Value__c}" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Formula'}" value="{{{!node.node.formulaTrimmed}}}" style="color: blue;" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Metadata'}" value="{{{!node.node.metadataDisplay}}}" style="color: blue;" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Setting'}" value="{{{!node.node.settingDisplay}}}" style="color: blue;" />
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                                </apex:outputPanel>
        
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Type__c == 'Array'}">
                                                                    <apex:outputText value="[ " />
        
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Field'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{!'{{' + NULLVALUE(node.node.currentObject, callout.d_wh__Object__c) + '.' + node.node.node.d_wh__Field_Reference__c + '}}'}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Static'}">
                                                                        <apex:variable var="firstArrayItem" value="true" />
                                                                        <apex:repeat value="{!node.node.ArrayStaticItems}" var="arrayItem">
                                                                            <apex:outputPanel layout="none" rendered="{!firstArrayItem == 'false'}">,&nbsp;</apex:outputPanel>
                                                                            <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                            <apex:outputText value="{!arrayItem}" />
                                                                            <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                            <apex:variable var="firstArrayItem" value="false" />
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Formula'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{{{!node.node.formulaTrimmed}}}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Metadata'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{{{!node.node.metadataDisplay}}}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Setting'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{{{!node.node.settingDisplay}}}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
        
                                                                    <apex:outputText value=" ]" />
                                                                    <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                                </apex:outputPanel>
        
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Type__c == 'Apex'}">
                                                                    <apex:outputText value="{!$Label.d_wh__Generated_Using_Apex_Class + ' (' + node.node.node.d_wh__Apex_Class_Name__c + ')'}" style="color: blue;" />
                                                                </apex:outputPanel>
        
                                                                <div style="display:inline-block; width:70px;"></div>
                                                                <apex:outputText rendered="{!AND(node.node.node.d_wh__Node_Type__c == 'List', node.node.node.d_wh__Related_List_API_Name__c != null, node.node.node.d_wh__Related_List_API_Name__c != '')}" value="{!'(' + IF(node.node.node.d_wh__Related_List_API_Name__c == 'Main List Of Records', '', callout.d_wh__Object__c + '.') + node.node.node.d_wh__Related_List_API_Name__c + ')'}" style="color:blue;" />
                                                                
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!node.closingNode == true}">
                                                    <tr class="slds-hint-parent">
                                                        <td></td>
                                                        <td data-label="">
                                                            <div class="slds-truncate" title="">
                                                                <div style="display:inline-block; width: {!node.node.nextLevelIdent}px;"></div>
                                                                <apex:commandButton value="+" styleClass="slds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!AddNode}" rerender="mainForm" status="actionStatus">
                                                                    <apex:param name="parentGuid" value="{!node.node.guid}" />
                                                                </apex:commandButton>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr class="slds-hint-parent">
                                                        <td></td>
                                                        <td data-label="">
                                                            <div class="slds-truncate" title="">
                                                                <div style="display:inline-block; width: {!node.node.levelIdent}px;"></div>
                                                                <apex:outputText rendered="{!node.node.node.d_wh__Node_Type__c == 'List'}" value="} ]" />
                                                                <apex:outputText rendered="{!node.node.node.d_wh__Node_Type__c == 'Object'}" value="}" />
                                                                <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </apex:outputPanel>
                                            </apex:repeat>
                                        </tbody>
                                    </table>
        
                                    <br /><br />
                                    <apex:commandButton styleClass="slds-button slds-button_brand" action="{!OpenJSONExampleForm}" value="{!$Label.d_wh__Create_from_sample_JSON_request}"  rerender="mainForm" status="actionStatus" />
                                    <apex:commandButton styleClass="slds-button slds-button_brand" action="{!OpenJSONSObjectForm}" value="{!$Label.d_wh__Create_from_fields_of_Main_Object}"  rerender="mainForm" status="actionStatus" />
                                    <br />
        
                                </div>

                                <div id="tab-default-2" class="slds-tabs_default__content {!IF(currentResponseType == '4XX', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="tab-default-2__item">
                                    <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_header-hidden" style="font-weight: bold; font-size: 120%;">
                                        <thead class="slds-assistive-text">
                                            <tr class="slds-line-height_reset">
                                                <th class="" scope="col"></th>
                                                <th class="" scope="col"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <apex:repeat value="{!displayRespNodes4XX}" var="node">
                                                <apex:outputPanel layout="none" rendered="{!node.closingNode != true}">
                                                    <tr class="slds-hint-parent">
                                                        <td style="text-align: right; padding-right:20px; width:70px;">
                                                            <apex:outputPanel rendered="{!!node.node.mainObject}">
                                                                <apex:commandButton value="-" styleClass="slds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!RemoveNode}" rerender="mainForm" status="actionStatus">
                                                                    <apex:param name="nodeGuid" value="{!node.node.guid}" />
                                                                </apex:commandButton>
                                                            </apex:outputPanel>
                                                            
                                                            <apex:commandLink styleClass="slds-button slslds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!OpenEditNode}" rerender="mainForm" status="actionStatus">
                                                                <img src="/img/func_icons/util/pencil12.gif" />
                                                                <apex:param name="nodeGuid" value="{!node.node.guid}" />
                                                            </apex:commandLink>
                                                        </td>
                                                        <td data-label="">
                                                            <div class="slds-truncate" title="">
                                                                <div style="display:inline-block; width: {!node.node.levelIdent}px;"></div>
        
                                                                <apex:outputPanel rendered="{!!node.node.mainObject}">
                                                                    "<apex:outputText value="{!node.node.node.Name}" />" :&nbsp;
                                                                </apex:outputPanel>
        
                                                                <apex:outputText value="{" rendered="{!node.node.node.d_wh__Node_Type__c == 'Object'}" />
        
                                                                <apex:outputText value="[ {" rendered="{!node.node.node.d_wh__Node_Type__c == 'List'}" />
        
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Type__c == 'Value'}">
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Field'}" value="{!'{{' + NULLVALUE(node.node.currentObject, callout.d_wh__Object__c) + '.' + node.node.node.d_wh__Field_Reference__c + '}}'}" style="color: blue;" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Static'}" value="{!node.node.node.d_wh__Static_Value__c}" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Formula'}" value="{{{!node.node.formulaTrimmed}}}" style="color: blue;" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Metadata'}" value="{{{!node.node.metadataDisplay}}}" style="color: blue;" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Setting'}" value="{{{!node.node.settingDisplay}}}" style="color: blue;" />
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                                </apex:outputPanel>
        
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Type__c == 'Array'}">
                                                                    <apex:outputText value="[ " />
        
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Field'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{!'{{' + NULLVALUE(node.node.currentObject, callout.d_wh__Object__c) + '.' + node.node.node.d_wh__Field_Reference__c + '}}'}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Static'}">
                                                                        <apex:variable var="firstArrayItem" value="true" />
                                                                        <apex:repeat value="{!node.node.ArrayStaticItems}" var="arrayItem">
                                                                            <apex:outputPanel layout="none" rendered="{!firstArrayItem == 'false'}">,&nbsp;</apex:outputPanel>
                                                                            <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                            <apex:outputText value="{!arrayItem}" />
                                                                            <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                            <apex:variable var="firstArrayItem" value="false" />
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Formula'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{{{!node.node.formulaTrimmed}}}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Metadata'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{{{!node.node.metadataDisplay}}}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Setting'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{{{!node.node.settingDisplay}}}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    
                                                                    <apex:outputText value=" ]" />
                                                                    <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                                </apex:outputPanel>
        
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Type__c == 'Apex'}">
                                                                    <apex:outputText value="{!$Label.d_wh__Generated_Using_Apex_Class + ' (' + node.node.node.d_wh__Apex_Class_Name__c + ')'}" style="color: blue;" />
                                                                </apex:outputPanel>
        
                                                                <div style="display:inline-block; width:70px;"></div>
                                                                <apex:outputText rendered="{!AND(node.node.node.d_wh__Node_Type__c == 'List', node.node.node.d_wh__Related_List_API_Name__c != null, node.node.node.d_wh__Related_List_API_Name__c != '')}" value="{!'(' + IF(node.node.node.d_wh__Related_List_API_Name__c == 'Main List Of Records', '', callout.d_wh__Object__c + '.') + node.node.node.d_wh__Related_List_API_Name__c + ')'}" style="color:blue;" />
                                                                
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!node.closingNode == true}">
                                                    <tr class="slds-hint-parent">
                                                        <td></td>
                                                        <td data-label="">
                                                            <div class="slds-truncate" title="">
                                                                <div style="display:inline-block; width: {!node.node.nextLevelIdent}px;"></div>
                                                                <apex:commandButton value="+" styleClass="slds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!AddNode}" rerender="mainForm" status="actionStatus">
                                                                    <apex:param name="parentGuid" value="{!node.node.guid}" />
                                                                </apex:commandButton>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr class="slds-hint-parent">
                                                        <td></td>
                                                        <td data-label="">
                                                            <div class="slds-truncate" title="">
                                                                <div style="display:inline-block; width: {!node.node.levelIdent}px;"></div>
                                                                <apex:outputText rendered="{!node.node.node.d_wh__Node_Type__c == 'List'}" value="} ]" />
                                                                <apex:outputText rendered="{!node.node.node.d_wh__Node_Type__c == 'Object'}" value="}" />
                                                                <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </apex:outputPanel>
                                            </apex:repeat>
                                        </tbody>
                                    </table>
        
                                    <br /><br />
                                    <apex:commandButton styleClass="slds-button slds-button_brand" action="{!OpenJSONExampleForm}" value="{!$Label.d_wh__Create_from_sample_JSON_request}"  rerender="mainForm" status="actionStatus" />
                                    <apex:commandButton styleClass="slds-button slds-button_brand" action="{!OpenJSONSObjectForm}" value="{!$Label.d_wh__Create_from_fields_of_Main_Object}"  rerender="mainForm" status="actionStatus" />
                                    <br />
        
                                </div>

                                <div id="tab-default-3" class="slds-tabs_default__content {!IF(currentResponseType == '5XX', 'slds-show', 'slds-hide')}" role="tabpanel" aria-labelledby="tab-default-3__item">
                                    <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-table_header-hidden" style="font-weight: bold; font-size: 120%;">
                                        <thead class="slds-assistive-text">
                                            <tr class="slds-line-height_reset">
                                                <th class="" scope="col"></th>
                                                <th class="" scope="col"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <apex:repeat value="{!displayRespNodes5XX}" var="node">
                                                <apex:outputPanel layout="none" rendered="{!node.closingNode != true}">
                                                    <tr class="slds-hint-parent">
                                                        <td style="text-align: right; padding-right:20px; width:70px;">
                                                            <apex:outputPanel rendered="{!!node.node.mainObject}">
                                                                <apex:commandButton value="-" styleClass="slds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!RemoveNode}" rerender="mainForm" status="actionStatus">
                                                                    <apex:param name="nodeGuid" value="{!node.node.guid}" />
                                                                </apex:commandButton>
                                                            </apex:outputPanel>
                                                            
                                                            <apex:commandLink styleClass="slds-button slslds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!OpenEditNode}" rerender="mainForm" status="actionStatus">
                                                                <img src="/img/func_icons/util/pencil12.gif" />
                                                                <apex:param name="nodeGuid" value="{!node.node.guid}" />
                                                            </apex:commandLink>
                                                        </td>
                                                        <td data-label="">
                                                            <div class="slds-truncate" title="">
                                                                <div style="display:inline-block; width: {!node.node.levelIdent}px;"></div>
        
                                                                <apex:outputPanel rendered="{!!node.node.mainObject}">
                                                                    "<apex:outputText value="{!node.node.node.Name}" />" :&nbsp;
                                                                </apex:outputPanel>
        
                                                                <apex:outputText value="{" rendered="{!node.node.node.d_wh__Node_Type__c == 'Object'}" />
        
                                                                <apex:outputText value="[ {" rendered="{!node.node.node.d_wh__Node_Type__c == 'List'}" />
        
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Type__c == 'Value'}">
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Field'}" value="{!'{{' + NULLVALUE(node.node.currentObject, callout.d_wh__Object__c) + '.' + node.node.node.d_wh__Field_Reference__c + '}}'}" style="color: blue;" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Static'}" value="{!node.node.node.d_wh__Static_Value__c}" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Formula'}" value="{{{!node.node.formulaTrimmed}}}" style="color: blue;" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Metadata'}" value="{{{!node.node.metadataDisplay}}}" style="color: blue;" />
                                                                    <apex:outputText rendered="{!node.node.node.d_wh__Value_Source__c == 'Setting'}" value="{{{!node.node.settingDisplay}}}" style="color: blue;" />
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                                </apex:outputPanel>
        
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Type__c == 'Array'}">
                                                                    <apex:outputText value="[ " />
        
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Field'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{!'{{' + NULLVALUE(node.node.currentObject, callout.d_wh__Object__c) + '.' + node.node.node.d_wh__Field_Reference__c + '}}'}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Static'}">
                                                                        <apex:variable var="firstArrayItem" value="true" />
                                                                        <apex:repeat value="{!node.node.ArrayStaticItems}" var="arrayItem">
                                                                            <apex:outputPanel layout="none" rendered="{!firstArrayItem == 'false'}">,&nbsp;</apex:outputPanel>
                                                                            <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                            <apex:outputText value="{!arrayItem}" />
                                                                            <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                            <apex:variable var="firstArrayItem" value="false" />
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Formula'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{{{!node.node.formulaTrimmed}}}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Metadata'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{{{!node.node.metadataDisplay}}}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Value_Source__c == 'Setting'}">
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                        <apex:outputText value="{{{!node.node.settingDisplay}}}" style="color: blue;" />
                                                                        <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Data_Type__c == 'String'}">"</apex:outputPanel>
                                                                    </apex:outputPanel>
        
                                                                    <apex:outputText value=" ]" />
                                                                    <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                                </apex:outputPanel>
        
                                                                <apex:outputPanel layout="none" rendered="{!node.node.node.d_wh__Node_Type__c == 'Apex'}">
                                                                    <apex:outputText value="{!$Label.d_wh__Generated_Using_Apex_Class + ' (' + node.node.node.d_wh__Apex_Class_Name__c + ')'}" style="color: blue;" />
                                                                </apex:outputPanel>
        
                                                                <div style="display:inline-block; width:70px;"></div>
                                                                <apex:outputText rendered="{!AND(node.node.node.d_wh__Node_Type__c == 'List', node.node.node.d_wh__Related_List_API_Name__c != null, node.node.node.d_wh__Related_List_API_Name__c != '')}" value="{!'(' + IF(node.node.node.d_wh__Related_List_API_Name__c == 'Main List Of Records', '', callout.d_wh__Object__c + '.') + node.node.node.d_wh__Related_List_API_Name__c + ')'}" style="color:blue;" />
                                                                
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="none" rendered="{!node.closingNode == true}">
                                                    <tr class="slds-hint-parent">
                                                        <td></td>
                                                        <td data-label="">
                                                            <div class="slds-truncate" title="">
                                                                <div style="display:inline-block; width: {!node.node.nextLevelIdent}px;"></div>
                                                                <apex:commandButton value="+" styleClass="slds-button slds-button_icon slds-button_icon-small slds-button_icon-brand" action="{!AddNode}" rerender="mainForm" status="actionStatus">
                                                                    <apex:param name="parentGuid" value="{!node.node.guid}" />
                                                                </apex:commandButton>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr class="slds-hint-parent">
                                                        <td></td>
                                                        <td data-label="">
                                                            <div class="slds-truncate" title="">
                                                                <div style="display:inline-block; width: {!node.node.levelIdent}px;"></div>
                                                                <apex:outputText rendered="{!node.node.node.d_wh__Node_Type__c == 'List'}" value="} ]" />
                                                                <apex:outputText rendered="{!node.node.node.d_wh__Node_Type__c == 'Object'}" value="}" />
                                                                <apex:outputPanel layout="none" rendered="{!!node.node.last}">,</apex:outputPanel>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </apex:outputPanel>
                                            </apex:repeat>
                                        </tbody>
                                    </table>
        
                                    <br /><br />
                                    <apex:commandButton styleClass="slds-button slds-button_brand" action="{!OpenJSONExampleForm}" value="{!$Label.d_wh__Create_from_sample_JSON_request}"  rerender="mainForm" status="actionStatus" />
                                    <apex:commandButton styleClass="slds-button slds-button_brand" action="{!OpenJSONSObjectForm}" value="{!$Label.d_wh__Create_from_fields_of_Main_Object}"  rerender="mainForm" status="actionStatus" />
                                    <br />
        
                                </div>
                            </div>

                            <apex:outputPanel layout="none" rendered="{!responseHasApex}">

                                <br /><br /><br />
                                <apex:outputText escape="false" value="{!$Label.d_wh__Cache_Apex_Help_Pre}" />

                                <br /><br />
                                <div class="slds-form-element">
                                    <label class="slds-form-element__label">
                                        {!$Label.Apex_Class_Name}
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:inputField value="{!callout.d_wh__Caching_Class_Name__c}" styleClass="slds-input" />
                                    </div>
                                </div>
                                <br />

                                <apex:outputText escape="false" value="{!$Label.d_wh__Cache_Apex_Help}" />

                            </apex:outputPanel>
                            
                            <br />
                        </div>
                    </div>
                </div>

            </apex:outputPanel>

            <apex:outputPanel layout="none" rendered="{!JSONEditMode}">
                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                    <apex:outputPanel layout="none" rendered="{!OR(callout.d_wh__Request_Body_Format__c == 'application/json', step == 4)}">
                        <div class="slds-modal__container">
                            <header class="slds-modal__header">
                                <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">{!$Label.Edit_Node_Details}</h2>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                                
                                <apex:outputPanel layout="block" id="modalForm">

                                        <apex:outputPanel rendered="{!JSONEditItem.mainObject}">
                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label">
                                                    {!$Label.d_wh__Node_Type}
                                                </label>
                                                <div class="slds-form-element__control">
                                                    <apex:selectList size="1" multiselect="false" value="{!JSONEditItem.node.d_wh__Node_Type__c}" styleClass="slds-input">
                                                        <apex:selectOption itemValue="Object" itemLabel="{!$Label.d_wh__Object}" />
                                                        <apex:selectOption itemValue="List" itemLabel="{!$Label.d_wh__List}" />
                                                        <apex:selectOption itemValue="Apex" itemLabel="{!$Label.d_wh__Apex}" rendered="{!step == 4}" />
                                                        <apex:actionSupport event="onchange" rerender="modalForm" status="actionStatus" />
                                                    </apex:selectList>
                                                </div>
                                            </div>
                                            <br />
                                            <apex:outputPanel layout="none" rendered="{!JSONEditItem.node.d_wh__Node_Type__c == 'Apex'}">
                                                <div class="slds-form-element">
                                                    <label class="slds-form-element__label">
                                                        {!$Label.d_wh__Apex_Class_Name} <span style="color: red;">*</span>
                                                    </label>
                                                    <div class="slds-form-element__control">
                                                        <apex:inputField value="{!JSONEditItem.node.d_wh__Apex_Class_Name__c}" styleClass="slds-input" />
                                                    </div>
                                                </div>
                                                <br />

                                                <apex:outputText escape="false" value="{!$Label.d_wh__JSON_Node_Apex_Help}" />
                                                <br />
                                            </apex:outputPanel>
                                        </apex:outputPanel>

                                        <apex:outputPanel rendered="{!!JSONEditItem.mainObject}">
                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label">
                                                    {!$Label.d_wh__Node_Name} <span style="color: red;">*</span>
                                                </label>
                                                <div class="slds-form-element__control">
                                                    <apex:inputText value="{!JSONEditItem.node.Name}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                            <br />

                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label">
                                                    {!$Label.d_wh__Node_Type}
                                                </label>
                                                <div class="slds-form-element__control">
                                                    <apex:selectList size="1" multiselect="false" value="{!JSONEditItem.node.d_wh__Node_Type__c}" styleClass="slds-input">
                                                        <apex:selectOption itemValue="Object" itemLabel="{!$Label.d_wh__Object}" />
                                                        <apex:selectOption itemValue="List" itemLabel="{!$Label.d_wh__List}" />
                                                        <apex:selectOption itemValue="Value" itemLabel="{!$Label.d_wh__Value}" />
                                                        <apex:selectOption itemValue="Array" itemLabel="{!$Label.d_wh__Array}" />
                                                        <apex:selectOption itemValue="Apex" itemLabel="{!$Label.d_wh__Apex}" rendered="{!step == 4}" />
                                                        <apex:actionSupport event="onchange" rerender="modalForm" status="actionStatus" />
                                                    </apex:selectList>
                                                </div>
                                            </div>
                                            <br />

                                            <apex:outputPanel layout="none" rendered="{!AND(JSONEditItem.node.d_wh__Node_Type__c == 'List', step == 4)}">
                                                <apex:outputPanel layout="none" rendered="{!callout.d_wh__Object__c != null}">
                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label">
                                                            {!$Label.d_wh__Salesforce_Related_List}
                                                        </label>
                                                        <div class="slds-form-element__control">
                                                            <apex:inputHidden id="listValHidden" value="{!JSONEditItem.node.d_wh__Related_List_API_Name__c}" />
                                                            <c:FieldSelector listType="{!JSONEditItem.ListFieldSelectorType}" objectName="{!JSONEditItem.currentObject}" fieldPath="{!JSONEditItem.node.d_wh__Related_List_API_Name__c}" inputValueId="{!$Component.listValHidden}" />
                                                        </div>
                                                    </div>
                                                    <br />

                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label">
                                                            {!$Label.Related_List_SOQL_WHERE_Clause}
                                                        </label>
                                                        <div class="slds-form-element__control">
                                                            <apex:inputField value="{!JSONEditItem.node.d_wh__Related_List_SOQL_Filter__c}" styleClass="slds-input" />
                                                        </div>
                                                    </div>
                                                    <br />
                                                </apex:outputPanel>

                                                <apex:outputPanel layout="none" rendered="{!callout.d_wh__Object__c == null}">
                                                    <b>{!$Label.d_wh__You_cannot_select_a_field_reference_to_map_if_you_didn_t_match_an_Object}</b>
                                                </apex:outputPanel>
                                            </apex:outputPanel>

                                            <apex:outputPanel layout="none" rendered="{!OR(JSONEditItem.node.d_wh__Node_Type__c == 'Value', JSONEditItem.node.d_wh__Node_Type__c == 'Array')}">
                                                <div class="slds-form-element">
                                                    <label class="slds-form-element__label">
                                                        {!$Label.d_wh__Node_Data_Type}
                                                    </label>
                                                    <div class="slds-form-element__control">
                                                        <apex:inputField value="{!JSONEditItem.node.d_wh__Node_Data_Type__c}" styleClass="slds-input">
                                                            <apex:actionSupport event="onchange" rerender="modalForm" status="actionStatus" />
                                                        </apex:inputField>
                                                        <apex:outputPanel layout="none" rendered="{!JSONEditItem.node.d_wh__Node_Data_Type__c == 'Legacy'}">
                                                            <br />
                                                            <div class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_warning" role="alert">
                                                                <span class="slds-assistive-text">{!$Label.Warning}</span>
                                                                <h2>{!$Label.Node_Data_Type_Warning}</h2>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <br />

                                                <apex:outputPanel layout="none" rendered="{!step == 4}">

                                                    <apex:outputPanel layout="none" rendered="{!JSONEditItem.node.d_wh__Node_Data_Type__c == 'String'}">
                                                        <div class="slds-form-element">
                                                            <label class="slds-form-element__label">
                                                                {!$ObjectType.d_wh__Callout_JSON_Body_Node__c.fields.d_wh__Send_null_as_empty_string__c.Label}
                                                            </label>
                                                            <div class="slds-form-element__control">
                                                                <apex:inputField value="{!JSONEditItem.node.d_wh__Send_null_as_empty_string__c}" />
                                                            </div>
                                                        </div>
                                                        <br />
                                                    </apex:outputPanel>

                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label">
                                                            {!$Label.d_wh__Value_Source}
                                                        </label>
                                                        <div class="slds-form-element__control">
                                                            <apex:selectList size="1" multiselect="false" value="{!JSONEditItem.node.d_wh__Value_Source__c}" styleClass="slds-input">
                                                                <apex:selectOption itemValue="Field" itemLabel="{!$Label.d_wh__Field}" />
                                                                <apex:selectOption itemValue="Static" itemLabel="{!$Label.d_wh__Static}" />
                                                                <apex:selectOption itemValue="Formula" itemLabel="{!$Label.d_wh__Formula}" />
                                                                <apex:selectOption itemValue="Metadata" itemLabel="{!$Label.d_wh__Custom_Metadata}" />
                                                                <apex:selectOption itemValue="Setting" itemLabel="{!$Label.d_wh__Custom_Setting}" />
                                                                <apex:actionSupport event="onchange" rerender="modalForm" status="actionStatus" />
                                                            </apex:selectList>
                                                        </div>
                                                    </div>
                                                    <br />

                                                    <apex:outputPanel layout="none" rendered="{!JSONEditItem.node.d_wh__Value_Source__c == 'Static'}">
                                                        <apex:outputPanel layout="none" rendered="{!JSONEditItem.node.d_wh__Node_Type__c == 'Value'}">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label">
                                                                    {!$Label.Enter_Value}
                                                                </label>
                                                                <div class="slds-form-element__control">
                                                                    <input type="text" value="{!JSONEditItem.node.d_wh__Static_Value__c}" class="slds-input" onchange="SetStaticValue(this);" id="staticValueInput" />
                                                                    <apex:inputHidden value="{!JSONEditItem.node.d_wh__Static_Value__c}" id="staticValueHidden" />
                                                                    <!-- To avoid an ugly Visualforce issue -->
                                                                    <script> 
                                                                        function SetStaticValue(input) {
                                                                            document.getElementById('{!$Component.staticValueHidden}').value = input.value;
                                                                        }
                                                                        SetStaticValue(document.getElementById('staticValueInput'));
                                                                    </script>
                                                                    <apex:outputText rendered="{!OR(currentResponseType == '4XX', currentResponseType == '5XX')}" escape="false" value="{!$Label.d_wh__Inbound_Response_Error_Help}" />
                                                                </div>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="none" rendered="{!JSONEditItem.node.d_wh__Node_Type__c == 'Array'}">
                                                            <div class="slds-form-element">
                                                                <label class="slds-form-element__label">
                                                                    {!$Label.Enter_Value_Array}
                                                                </label>
                                                                <div class="slds-form-element__control">
                                                                    <textArea id="staticValueInput2" styleClass="slds-input" onchange="SetStaticValue2(this);" class="slds-input">{!JSONEditItem.node.d_wh__Static_Value__c}</textArea>
                                                                    <apex:inputHidden value="{!JSONEditItem.node.d_wh__Static_Value__c}" id="staticValueHidden2" />
                                                                    <!-- To avoid an ugly Visualforce issue -->
                                                                    <script>
                                                                        function SetStaticValue2(input) {
                                                                            document.getElementById('{!$Component.staticValueHidden2}').value = input.value;
                                                                        }
                                                                        SetStaticValue2(document.getElementById('staticValueInput2'));
                                                                    </script>
                                                                    <apex:outputText rendered="{!OR(currentResponseType == '4XX', currentResponseType == '5XX')}" escape="false" value="{!$Label.d_wh__Inbound_Response_Error_Help}" />
                                                                </div>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <br />
                                                    </apex:outputPanel> 

                                                    <apex:outputPanel layout="none" rendered="{!JSONEditItem.node.d_wh__Value_Source__c == 'Field'}">
                                                        <apex:outputPanel layout="none" rendered="{!callout.d_wh__Object__c != null}">
                                                            <apex:outputPanel layout="none" rendered="{!JSONEditItem.currentObject != null}">
                                                                <div class="slds-form-element">
                                                                    <label class="slds-form-element__label">
                                                                        {!$Label.d_wh__Select_field} ({!JSONEditItem.currentObject}):
                                                                    </label>
                                                                    <div class="slds-form-element__control">
                                                                        <apex:inputHidden id="fieldValHidden" value="{!JSONEditItem.node.d_wh__Field_Reference__c}" />
                                                                        <apex:actionFunction name="DoNothing" reRender="modalForm" action="{!DoNothing}" status="actionStatus" />
                                                                        <c:FieldSelector listType="{!JSONEditItem.FieldSelectorType}" objectName="{!JSONEditItem.currentObject}" fieldPath="{!JSONEditItem.node.d_wh__Field_Reference__c}" inputValueId="{!$Component.fieldValHidden}" methodToCall="DoNothing" />
                                                                    </div>
                                                                </div>
                                                                <br />
                                                                <apex:outputPanel layout="none" rendered="{!JSONEditItem.IsBlobField}">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">
                                                                            {!$Label.d_wh__Blob_Field_Format}
                                                                        </label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:selectList size="1" multiselect="false" value="{!JSONEditItem.node.d_wh__Blob_Format__c}" styleClass="slds-input">
                                                                                <apex:selectOption itemValue="Base64" itemLabel="{!$Label.d_wh__Base64}" />
                                                                                <apex:selectOption itemValue="Hex" itemLabel="{!$Label.d_wh__Hex}" />
                                                                                <apex:selectOption itemValue="Raw" itemLabel="{!$Label.d_wh__Raw_if_possible}" />
                                                                            </apex:selectList>
                                                                        </div>
                                                                    </div>
                                                                    <br />
                                                                </apex:outputPanel>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="none" rendered="{!JSONEditItem.currentObject == null}">
                                                                <b>{!$Label.d_wh__Cannot_select_field}</b>
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="none" rendered="{!callout.d_wh__Object__c == null}">
                                                            <b>{!$Label.d_wh__You_cannot_select_a_field_reference_to_map_if_you_didn_t_match_an_Object}</b>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>

                                                    <apex:outputPanel layout="none" rendered="{!JSONEditItem.node.d_wh__Value_Source__c == 'Formula'}">
                                                        <apex:outputPanel layout="none" rendered="{!callout.d_wh__Object__c != null}">
                                                            <apex:outputPanel layout="none" rendered="{!JSONEditItem.currentObject != null}">
                                                                <div class="slds-form-element">
                                                                    <label class="slds-form-element__label">
                                                                        {!$Label.d_wh__Formula}
                                                                    </label>
                                                                    <div class="slds-form-element__control">
                                                                        <apex:inputTextarea id="fieldFormulaHidden" value="{!JSONEditItem.node.d_wh__Static_Value__c}" style="height: 0px; border: 0px; padding: 0px; margin: 0px; display: block;" />
                                                                        <c:FormulaEditor objectName="{!JSONEditItem.currentObject}" formula="{!JSONEditItem.node.d_wh__Static_Value__c}" inputValueId="{!$Component.fieldFormulaHidden}" />
                                                                    </div>
                                                                </div>
                                                                <br />
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="none" rendered="{!JSONEditItem.currentObject == null}">
                                                                <b>{!$Label.d_wh__Cannot_use_formula}</b>
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="none" rendered="{!callout.d_wh__Object__c == null}">
                                                            <b>{!$Label.d_wh__You_cannot_use_a_formula_if_you_didn_t_select_a_Main_Object}</b>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>

                                                    <apex:outputPanel layout="none" rendered="{!JSONEditItem.node.d_wh__Value_Source__c == 'Metadata'}">
                                                        <div class="slds-form-element">
                                                            <label class="slds-form-element__label">
                                                                {!$Label.d_wh__Select_Custom_Metadata_Value}
                                                            </label>
                                                            <div class="slds-form-element__control">
                                                                <apex:inputHidden id="metadataField1" value="{!JSONEditItem.node.d_wh__Static_Value__c}" />
                                                                <c:MetadataSelector inputValueId="{!$Component.metadataField1}" selectedValue="{!JSONEditItem.node.d_wh__Static_Value__c}" />
                                                            </div>
                                                        </div>
                                                        <br />
                                                    </apex:outputPanel>
    
                                                    <apex:outputPanel layout="none" rendered="{!JSONEditItem.node.d_wh__Value_Source__c == 'Setting'}">
                                                        <div class="slds-form-element">
                                                            <label class="slds-form-element__label">
                                                                {!$Label.d_wh__Select_Custom_Setting_Value}
                                                            </label>
                                                            <div class="slds-form-element__control">
                                                                <apex:inputHidden id="settingField1" value="{!JSONEditItem.node.d_wh__Static_Value__c}" />
                                                                <c:CustomSettingsSelector inputValueId="{!$Component.settingField1}" selectedValue="{!JSONEditItem.node.d_wh__Static_Value__c}" />
                                                            </div>
                                                        </div>
                                                        <br />
                                                    </apex:outputPanel>
                                                    
                                                </apex:outputPanel>
                                            </apex:outputPanel>

                                            <apex:outputPanel layout="none" rendered="{!JSONEditItem.node.d_wh__Node_Type__c == 'Apex'}">
                                                <div class="slds-form-element">
                                                    <label class="slds-form-element__label">
                                                        {!$Label.d_wh__Apex_Class_Name} <span style="color: red;">*</span>
                                                    </label>
                                                    <div class="slds-form-element__control">
                                                        <apex:inputField value="{!JSONEditItem.node.d_wh__Apex_Class_Name__c}" styleClass="slds-input" />
                                                    </div>
                                                </div>
                                                <br />

                                                <apex:outputText escape="false" value="{!$Label.d_wh__JSON_Node_Apex_Help}" />
                                                <br />
                                            </apex:outputPanel>
                                        </apex:outputPanel>

                                        <div class="vf-message-wrapper">
                                            <apex:pageMessages />
                                        </div>

                                    </apex:outputPanel>
                                
                            </div>
                            <footer class="slds-modal__footer">
                                <apex:commandButton styleClass="slds-button slds-button_brand" value="{!$Label.d_wh__Done}" reRender="mainForm" action="{!SaveEditNode}" status="actionStatus" />
                                <apex:commandButton styleClass="slds-button slds-button_neutral" value="{!$Label.d_wh__Cancel}" reRender="mainForm" action="{!CancelEditNode}" status="actionStatus" immediate="true" />
                            </footer>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel layout="none" rendered="{!AND(callout.d_wh__Request_Body_Format__c == 'application/x-www-form-urlencoded', step == 2)}">
                        <div class="slds-modal__container">
                            <header class="slds-modal__header">
                                <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">{!$Label.Edit_Item_Details}</h2>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                                <apex:outputPanel layout="block" id="modalForm1">

                                    <apex:outputPanel rendered="{!!JSONEditItem.mainObject}">
                                        <div class="slds-form-element">
                                            <label class="slds-form-element__label">
                                                {!$Label.d_wh__Item_Name} <span style="color: red;">*</span>
                                            </label>
                                            <div class="slds-form-element__control">
                                                <apex:inputText value="{!JSONEditItem.node.Name}" styleClass="slds-input" />
                                            </div>
                                        </div>
                                        <br />
                                    </apex:outputPanel>

                                    <div class="vf-message-wrapper">
                                        <apex:pageMessages />
                                    </div>

                                </apex:outputPanel>
                                
                            </div>
                            <footer class="slds-modal__footer">
                                <apex:commandButton styleClass="slds-button slds-button_brand" value="{!$Label.d_wh__Done}" reRender="mainForm" action="{!SaveEditNode}" status="actionStatus" />
                                <apex:commandButton styleClass="slds-button slds-button_neutral" value="{!$Label.d_wh__Cancel}" reRender="mainForm" action="{!CancelEditNode}" status="actionStatus" immediate="true" />
                            </footer>
                        </div>
                    </apex:outputPanel>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </apex:outputPanel>

            <apex:outputPanel layout="none" rendered="{!JSONExampleFormOpen}">
                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container">
                        <header class="slds-modal__header">
                            <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">{!$Label.Create_from_example_JSON_request}</h2>
                        </header>
                        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                            <apex:outputPanel layout="block" id="modalForm2">

                                <div class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_warning" role="alert">
                                    <span class="slds-assistive-text">{!$Label.Warning}</span>
                                    <h2><b>{!$Label.Warning}:</b> {!$Label.This_action_will_override_the_existing_JSON_structure}</h2>
                                </div>
                                <br /><br />

                                <div class="slds-form-element">
                                    <label class="slds-form-element__label">
                                        {!$Label.Copy_and_paste_the_example_JSON_here}:
                                    </label>
                                    <div class="slds-form-element__control">
                                        <apex:inputTextArea value="{!ExampleJSONString}" styleClass="slds-input" />
                                    </div>
                                </div>
                                <br />

                                <div class="vf-message-wrapper">
                                    <apex:pageMessages />
                                </div>

                            </apex:outputPanel>
                            
                        </div>
                        <footer class="slds-modal__footer">
                            <apex:commandButton styleClass="slds-button slds-button_neutral" value="{!$Label.d_wh__Cancel}" reRender="mainForm" action="{!CloseJSONExampleForm}" status="actionStatus" />
                            <apex:commandButton styleClass="slds-button slds-button_brand" value="{!$Label.d_wh__Generate}" reRender="mainForm" action="{!GenerateJSONExample}" status="actionStatus" />
                        </footer>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </apex:outputPanel>

            <apex:outputPanel layout="none" rendered="{!JSONSObjectFormOpen}">
                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container">
                        <header class="slds-modal__header">
                            <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">{!$Label.d_wh__Create_from_fields_of_Main_Object}</h2>
                        </header>
                        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                            <apex:outputPanel layout="block" id="modalForm7">

                                <div class="slds-notify slds-notify_alert slds-theme_alert-texture slds-theme_warning" role="alert">
                                    <span class="slds-assistive-text">{!$Label.Warning}</span>
                                    <h2><b>{!$Label.Warning}:</b> {!$Label.This_action_will_override_the_existing_JSON_structure}</h2>
                                </div>
                                <br /><br />

                                <div style="max-height: 500px; overflow-y: auto;">
                                    <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                                        <tbody>
                                            <apex:variable var="counter" value="{!0}" />
                                            <apex:repeat value="{!fieldsOptions.groups}" var="fieldOptionGroup">
                                                <apex:variable var="counter" value="{!counter + 1}" />
                                                <tr>
                                                    <td style="background-color: rgb(243, 243, 243);">
                                                        <input type="checkbox" checked="checked" onchange="ToggleCheckFields(this, '{!counter}');" />
                                                    </td>
                                                    <td style="background-color: rgb(243, 243, 243);">
                                                        <b>{!fieldOptionGroup.label}</b>
                                                    </td>
                                                </tr>
                                                <apex:repeat value="{!fieldOptionGroup.items}" var="fieldOptionItem">
                                                    <tr class="slds-hint-parent">
                                                        <td>
                                                            <apex:inputCheckbox value="{!fieldOptionItem.selected}" styleClass="sobj-fld-{!counter}" />
                                                        </td>
                                                        <td data-label="{!$Label.d_wh__Field}">
                                                            <div class="slds-truncate" title="{!fieldOptionItem.label}">
                                                                {!fieldOptionItem.label}
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </apex:repeat>
                                            </apex:repeat>
                                        </tbody>
                                    </table>

                                    <script>
                                        function ToggleCheckFields(ctrl, fieldGroup) {
                                            let aInputs = document.getElementsByClassName('sobj-fld-' + fieldGroup);
                                            for (let i = 0; i < aInputs.length; i++) {
                                                aInputs[i].checked = ctrl.checked;
                                            }
                                        }
                                    </script>
                                </div>

                                <div class="vf-message-wrapper">
                                    <apex:pageMessages />
                                </div>

                            </apex:outputPanel>
                            
                        </div>
                        <footer class="slds-modal__footer">
                            <apex:commandButton styleClass="slds-button slds-button_neutral" value="{!$Label.d_wh__Cancel}" reRender="mainForm" action="{!CloseJSONSObjectForm}" status="actionStatus" />
                            <apex:commandButton styleClass="slds-button slds-button_brand" value="{!$Label.d_wh__Generate}" reRender="mainForm" action="{!GenerateJSONSObject}" status="actionStatus" />
                        </footer>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </apex:outputPanel>

            <apex:outputPanel layout="none" rendered="{!JSONSelectorOpened}">
                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                    <apex:outputPanel layout="none" rendered="{!callout.d_wh__Request_Body_Format__c == 'application/json'}">
                        <div class="slds-modal__container" style="max-width: 90%;">
                            <header class="slds-modal__header">
                                <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">{!$Label.Select_JSON_Mapping}</h2>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                                <apex:outputPanel layout="block" id="modalForm3" style="overflow: auto;">

                                    <apex:inputHidden value="{!JSONSelectorJSONValue}" id="selectedItem" />
                                    <c:JSONSelectorInb rootNode="{!bodyItemsTree}" inputValueId="{!$Component.selectedItem}" selectedActionFunction="JSONNodeSelected" selectionType="{!IF(JSONSelectorFieldGuid == 'list', 'Lists', 'Values')}" startNode="{!JSONSelectorStartNode}" />
                                    <apex:actionFunction name="JSONNodeSelected" reRender="mainForm" action="{!CloseJSONSelector}" status="actionStatus" />

                                    <div class="vf-message-wrapper">
                                        <apex:pageMessages />
                                    </div>

                                </apex:outputPanel>
                                
                            </div>
                            <footer class="slds-modal__footer">
                                <apex:commandButton styleClass="slds-button slds-button_neutral" value="{!$Label.d_wh__Cancel}" reRender="mainForm" action="{!CloseJSONSelector}" status="actionStatus" />
                            </footer>
                        </div>
                    </apex:outputPanel>

                    <apex:outputPanel layout="none" rendered="{!callout.d_wh__Request_Body_Format__c == 'application/x-www-form-urlencoded'}">
                        <div class="slds-modal__container" style="max-width: 90%;">
                            <header class="slds-modal__header">
                                <h2 id="modal-heading-01" class="slds-modal__title slds-hyphenate">{!$Label.Select_Incoming_Body_Element_To_Map}</h2>
                            </header>
                            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                                <apex:outputPanel layout="block" id="modalForm4" style="overflow: auto;">

                                    <apex:inputHidden value="{!JSONSelectorJSONValue}" id="selectedItemForm" />
                                    <c:FormSelectorInb rootNode="{!bodyItemsTree}" inputValueId="{!$Component.selectedItemForm}" selectedActionFunction="JSONNodeSelectedForm" />
                                    <apex:actionFunction name="JSONNodeSelectedForm" reRender="mainForm" action="{!CloseJSONSelector}" status="actionStatus" />

                                    <div class="vf-message-wrapper">
                                        <apex:pageMessages />
                                    </div>

                                </apex:outputPanel>
                                
                            </div>
                            <footer class="slds-modal__footer">
                                <apex:commandButton styleClass="slds-button slds-button_neutral" value="{!$Label.d_wh__Cancel}" reRender="mainForm" action="{!CloseJSONSelector}" status="actionStatus" />
                            </footer>
                        </div>
                    </apex:outputPanel>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </apex:outputPanel>

        </apex:form>

    </div>

</apex:page>