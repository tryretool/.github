<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>57.0</apiVersion>
    <assignments>
        <name>Assign_First_Name</name>
        <label>Assign First Name</label>
        <locationX>1427</locationX>
        <locationY>273</locationY>
        <assignmentItems>
            <assignToReference>Get_Contact.FirstName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.First_Name__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Contact</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Full_Name</name>
        <label>Assign Full Name</label>
        <locationX>1424</locationX>
        <locationY>50</locationY>
        <assignmentItems>
            <assignToReference>Get_Contact.FirstName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.First_Name__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Get_Contact.LastName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Last_Name__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Contact</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Last_Name</name>
        <label>Assign Last Name</label>
        <locationX>1429</locationX>
        <locationY>445</locationY>
        <assignmentItems>
            <assignToReference>Get_Contact.LastName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Last_Name__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Contact</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Most_Recent_Sign_Up</name>
        <label>Assign Most Recent Sign Up</label>
        <locationX>1016</locationX>
        <locationY>393</locationY>
        <assignmentItems>
            <assignToReference>Get_Contact.Most_Recent_Retool_Signup_At__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Created_At__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Contact_Name_Unknown</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Contact_ID_from_Created_Contact</name>
        <label>Contact ID from Created Contact</label>
        <locationX>1543</locationX>
        <locationY>1422</locationY>
        <assignmentItems>
            <assignToReference>ContactID</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Create_contact</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Retool_User_Reguar</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>ContactID_from_Found_Converted_Regular</name>
        <label>ContactID from Found Converted Regular</label>
        <locationX>1243</locationX>
        <locationY>1094</locationY>
        <assignmentItems>
            <assignToReference>ContactID</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Search_for_Lead_Regular.ConvertedContactId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Retool_User_Reguar</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>LeadId_from_Created</name>
        <label>LeadId from Created</label>
        <locationX>1676</locationX>
        <locationY>1536</locationY>
        <assignmentItems>
            <assignToReference>LeadID</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Create_Lead</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Retool_User_Reguar</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>LeadID_from_Unconverted_Regular</name>
        <label>LeadID from Unconverted Regular</label>
        <locationX>1406</locationX>
        <locationY>1289</locationY>
        <assignmentItems>
            <assignToReference>LeadID</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Search_for_Lead_Regular.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Retool_User_Reguar</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Contact_Name_Unknown</name>
        <label>Contact Name Unknown?</label>
        <locationX>1143</locationX>
        <locationY>215</locationY>
        <defaultConnector>
            <targetReference>Update_Contact</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Name is known</defaultConnectorLabel>
        <rules>
            <name>Full_Name_Unknown</name>
            <conditionLogic>(1 OR 2 OR 7) AND (3 OR 4) AND 5 AND 6</conditionLogic>
            <conditions>
                <leftValueReference>Get_Contact.FirstName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>[not provided]</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Contact.FirstName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>[[unknown]]</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Contact.LastName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>[not provided]</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Contact.LastName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>[[unknown]]</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.First_Name__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Last_Name__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Contact.FirstName</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Full_Name</targetReference>
            </connector>
            <label>Full Name Unknown</label>
        </rules>
        <rules>
            <name>First_Name_Unknown</name>
            <conditionLogic>(1 OR 2 OR 4) AND 3</conditionLogic>
            <conditions>
                <leftValueReference>Get_Contact.FirstName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>[not provided]</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Contact.FirstName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>[[unknown]]</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.First_Name__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Contact.FirstName</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_First_Name</targetReference>
            </connector>
            <label>First Name Unknown</label>
        </rules>
        <rules>
            <name>Last_Name_Unknown</name>
            <conditionLogic>(1 OR 2) AND 3</conditionLogic>
            <conditions>
                <leftValueReference>Get_Contact.LastName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>[not provided]</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Contact.LastName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>[[unknown]]</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Last_Name__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Last_Name</targetReference>
            </connector>
            <label>Last Name Unknown</label>
        </rules>
    </decisions>
    <decisions>
        <name>External_Customer</name>
        <label>External Customer?</label>
        <locationX>2284</locationX>
        <locationY>846</locationY>
        <defaultConnector>
            <targetReference>Create_Moment</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not External</defaultConnectorLabel>
        <rules>
            <name>Is_External</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Is_External_Customer__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>Is External?</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_contact</name>
        <label>Has contact or lead?</label>
        <locationX>650</locationX>
        <locationY>761</locationY>
        <defaultConnector>
            <targetReference>Search_for_Lead_Regular</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_Contact</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Contact__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Contact</targetReference>
            </connector>
            <label>Yes Contact</label>
        </rules>
        <rules>
            <name>Yes_Lead</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Lead__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_New</targetReference>
            </connector>
            <label>Yes Lead</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_a_domain_map_populated</name>
        <label>Is a domain map account identified</label>
        <locationX>827</locationX>
        <locationY>1722</locationY>
        <defaultConnector>
            <targetReference>Create_Lead</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No account identified</defaultConnectorLabel>
        <rules>
            <name>Yes_domain_map</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Email_Domain_Map__r.Matched_Account__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_contact</targetReference>
            </connector>
            <label>Yes, domain account identified</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_New</name>
        <label>Connected to a Moment?</label>
        <locationX>1718</locationX>
        <locationY>850</locationY>
        <defaultConnectorLabel>Not New User</defaultConnectorLabel>
        <rules>
            <name>New_User</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Moment__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Created_At__c</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <dateTimeValue>2023-06-01T07:00:00.000Z</dateTimeValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>signup_created</targetReference>
            </connector>
            <label>No Moment, This Year</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Suppressed</name>
        <label>Is Suppressed?</label>
        <locationX>653</locationX>
        <locationY>567</locationY>
        <defaultConnector>
            <targetReference>Has_contact</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not Suppressed</defaultConnectorLabel>
        <rules>
            <name>Suppressed</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.OPS_Suppress_from_Flows__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Email__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>bugcrowdninja.com</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Email__c</leftValueReference>
                <operator>EndsWith</operator>
                <rightValue>
                    <stringValue>+archived</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Email__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Email__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>-archived</stringValue>
                </rightValue>
            </conditions>
            <label>Suppressed</label>
        </rules>
    </decisions>
    <decisions>
        <name>signup_created</name>
        <label>When was signup created?</label>
        <locationX>2020</locationX>
        <locationY>845</locationY>
        <defaultConnector>
            <targetReference>External_Customer</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Post 2024-1-1</defaultConnectorLabel>
        <rules>
            <name>Created_prior_to_2024_1_1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Created_At__c</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <dateTimeValue>2024-01-01T08:00:00.000Z</dateTimeValue>
                </rightValue>
            </conditions>
            <label>Created prior to 2024-1-1</label>
        </rules>
    </decisions>
    <decisions>
        <name>Update_Most_Recent_Signup_Date</name>
        <label>Update Most Recent Signup Date?</label>
        <locationX>1267</locationX>
        <locationY>581</locationY>
        <defaultConnector>
            <targetReference>Contact_Name_Unknown</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Ignore</defaultConnectorLabel>
        <rules>
            <name>Created_at_Current_Sign_Up</name>
            <conditionLogic>(1 OR 2) AND (3 OR 4) AND 5</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Created_At__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <elementReference>Get_Contact.Most_Recent_Retool_Signup_At__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Contact.Most_Recent_Retool_Signup_At__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Is_Builder__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Is_Admin__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Is_External_Customer__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Most_Recent_Sign_Up</targetReference>
            </connector>
            <label>Created at &lt; Current Sign Up</label>
        </rules>
    </decisions>
    <decisions>
        <name>Was_Lead_Found</name>
        <label>Was Lead Found?</label>
        <locationX>849</locationX>
        <locationY>1292</locationY>
        <defaultConnector>
            <targetReference>Is_a_domain_map_populated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Lead Not Found</defaultConnectorLabel>
        <rules>
            <name>Converted_Lead_Found_Regular</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Search_for_Lead_Regular.ConvertedContactId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>ContactID_from_Found_Converted_Regular</targetReference>
            </connector>
            <label>Converted Lead Found (Regular)</label>
        </rules>
        <rules>
            <name>Lead_Found_Regular</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Search_for_Lead_Regular.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>LeadID_from_Unconverted_Regular</targetReference>
            </connector>
            <label>Lead Found (Regular)</label>
        </rules>
    </decisions>
    <description>- Removing â€˜External Customer` check from `Is Suppressed?` so new contacts can be created.
- Adding External Customer checks in `Update Most Recent Signup Date?` node, and before creating new moments.</description>
    <environments>Default</environments>
    <formulas>
        <name>AdminorEditor</name>
        <dataType>String</dataType>
        <expression>IF( {!$Record.Is_Admin__c} = TRUE, &quot;admin&quot;, IF( {!$Record.Is_Builder__c} = TRUE, &quot;builder&quot;, &quot;user&quot;))</expression>
    </formulas>
    <formulas>
        <name>Clean_Company_Name</name>
        <dataType>String</dataType>
        <expression>LEFT({!$Record.Retool_Org__r.Name}, FIND(&quot; - &quot;, {!$Record.Retool_Org__r.Name}) - 1)</expression>
    </formulas>
    <formulas>
        <name>FirstName</name>
        <dataType>String</dataType>
        <expression>IF( LEN({!$Record.First_Name__c}) &gt;40, LEFT({!$Record.First_Name__c}, 40), {!$Record.First_Name__c})</expression>
    </formulas>
    <formulas>
        <name>LastNamePlug</name>
        <dataType>String</dataType>
        <expression>BLANKVALUE(IF( LEN({!$Record.Last_Name__c}) &gt;40, LEFT({!$Record.Last_Name__c}, 40), {!$Record.Last_Name__c}), &quot;[[unknown]]&quot;)</expression>
    </formulas>
    <formulas>
        <name>MomentContext</name>
        <dataType>String</dataType>
        <expression>IF({!$Record.Retool_Org__r.Hostname__c}=&quot;&quot;, &quot;&quot;, &quot;Hostname: &quot;&amp;{!$Record.Retool_Org__r.Hostname__c})</expression>
    </formulas>
    <formulas>
        <name>MomentDescription</name>
        <dataType>String</dataType>
        <expression>IF( DATEVALUE({!$Record.Created_At__c}) &lt;= DATE(2023,08,21), 
     IF( {!$Record.Organization_Join_Order__c} = 1, &quot;New &quot;&amp;{!AdminorEditor}&amp;&quot; at new org&quot;,  &quot;New &quot;&amp;{!AdminorEditor}&amp;&quot; at existing org&quot;) ,
IF( {!$Record.Organization_Join_Order__c} = 1, &quot;New &quot;&amp;{!AdminorEditor}&amp;&quot; at new org&quot;&amp;IF({!$Record.Retool_Org__r.Active_Trial__c}= TRUE, &quot; (trial)&quot;, &quot;&quot;), 
IF( {!$Record.Retool_Org__r.Retool_License__c} =&quot;&quot;, 
IF( {!$Record.Retool_Org__r.Subscription_Type__c} = &quot;Committed&quot;, &quot;New &quot;&amp;{!AdminorEditor}&amp;&quot; at existing committed org&quot;, 
IF( {!$Record.Retool_Org__r.Subscription_Type__c} = &quot;Self Service&quot;, &quot;New &quot;&amp;{!AdminorEditor}&amp;&quot; at existing self service org&quot;, &quot;New &quot;&amp;{!AdminorEditor}&amp;&quot; at existing unpaid org&quot;)), IF({!$Record.Retool_Org__r.Retool_License__r.Billing_Type__c}=&quot;trial&quot;, &quot;New &quot;&amp;{!AdminorEditor}&amp;&quot; at existing unpaid org&quot;, &quot;New &quot;&amp;{!AdminorEditor}&amp;&quot; at existing paid org&quot;))
))</expression>
    </formulas>
    <formulas>
        <name>weeksago2</name>
        <dataType>Date</dataType>
        <expression>TODAY() - 14</expression>
    </formulas>
    <interviewLabel>Retool User - After Save Automations {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Retool User - After Save Automations</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_contact</name>
        <label>Create contact</label>
        <locationX>1033</locationX>
        <locationY>1636</locationY>
        <connector>
            <targetReference>Contact_ID_from_Created_Contact</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Is_New</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>$Record.Email_Domain_Map__r.Matched_Account__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Email</field>
            <value>
                <elementReference>$Record.Email__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FirstName</field>
            <value>
                <elementReference>FirstName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HasOptedOutOfEmail</field>
            <value>
                <elementReference>$Record.Is_Email_Anonymized__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>LastName</field>
            <value>
                <elementReference>LastNamePlug</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Most_Recent_Retool_Signup_At__c</field>
            <value>
                <elementReference>$Record.Created_At__c</elementReference>
            </value>
        </inputAssignments>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Lead</name>
        <label>Create Lead</label>
        <locationX>1792</locationX>
        <locationY>1725</locationY>
        <connector>
            <targetReference>LeadId_from_Created</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Is_New</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Company</field>
            <value>
                <stringValue>Orphan Orgs</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Email</field>
            <value>
                <elementReference>$Record.Email__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>FirstName</field>
            <value>
                <elementReference>FirstName</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>HasOptedOutOfEmail</field>
            <value>
                <elementReference>$Record.Is_Email_Anonymized__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>LastName</field>
            <value>
                <elementReference>LastNamePlug</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>LeadSource</field>
            <value>
                <stringValue>Product Signup</stringValue>
            </value>
        </inputAssignments>
        <object>Lead</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Moment</name>
        <label>Create Moment</label>
        <locationX>2579</locationX>
        <locationY>840</locationY>
        <connector>
            <targetReference>Update_Retool_User_with_Moment</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Create_Moment_No_Email</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Account__c</field>
            <value>
                <elementReference>$Record.Contact__r.AccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Check_MQL__c</field>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Contact__c</field>
            <value>
                <elementReference>$Record.Contact__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Created_From_Detail__c</field>
            <value>
                <stringValue>Retool User After Save Automations</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Created_From__c</field>
            <value>
                <stringValue>Retool User</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Email_at_Moment__c</field>
            <value>
                <elementReference>$Record.Email__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lead__c</field>
            <value>
                <elementReference>$Record.Lead__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Moment_Context__c</field>
            <value>
                <elementReference>MomentContext</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Moment_Description__c</field>
            <value>
                <elementReference>MomentDescription</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Moment_Occurred_At__c</field>
            <value>
                <elementReference>$Record.Created_At__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Moment_Type__c</field>
            <value>
                <stringValue>Product Signup</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Retool_User__c</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Moment__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_Moment_No_Email</name>
        <label>Create Moment No Email</label>
        <locationX>2680</locationX>
        <locationY>1003</locationY>
        <connector>
            <targetReference>Update_Retool_User_with_Moment</targetReference>
        </connector>
        <inputAssignments>
            <field>Account__c</field>
            <value>
                <elementReference>$Record.Contact__r.AccountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Check_MQL__c</field>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Contact__c</field>
            <value>
                <elementReference>$Record.Contact__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Created_From_Detail__c</field>
            <value>
                <stringValue>Retool User After Save Automations</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Created_From__c</field>
            <value>
                <stringValue>Retool User</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lead__c</field>
            <value>
                <elementReference>$Record.Lead__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Moment_Context__c</field>
            <value>
                <elementReference>MomentContext</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Moment_Description__c</field>
            <value>
                <elementReference>MomentDescription</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Moment_Occurred_At__c</field>
            <value>
                <elementReference>$Record.Created_At__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Moment_Type__c</field>
            <value>
                <stringValue>Product Signup</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Retool_User__c</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <object>Moment__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_Contact</name>
        <label>Get Contact</label>
        <locationX>1275</locationX>
        <locationY>752</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Update_Most_Recent_Signup_Date</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Is_New</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Contact__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>Most_Recent_Retool_Signup_At__c</queriedFields>
        <queriedFields>FirstName</queriedFields>
        <queriedFields>LastName</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Search_for_Lead_Regular</name>
        <label>Search for Lead (Regular)</label>
        <locationX>659</locationX>
        <locationY>1071</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Was_Lead_Found</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Is_New</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Email</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Email__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>IsDeleted</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Lead</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>ConvertedContactId</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Contact</name>
        <label>Update Contact</label>
        <locationX>1726</locationX>
        <locationY>218</locationY>
        <connector>
            <targetReference>Is_New</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Is_New</targetReference>
        </faultConnector>
        <inputReference>Get_Contact</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Retool_User_Reguar</name>
        <label>Update Retool User w Found Contact (Regular)</label>
        <locationX>1573</locationX>
        <locationY>954</locationY>
        <connector>
            <targetReference>Has_contact</targetReference>
        </connector>
        <inputAssignments>
            <field>Contact__c</field>
            <value>
                <elementReference>ContactID</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lead__c</field>
            <value>
                <elementReference>LeadID</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Retool_User_with_Moment</name>
        <label>Update Retool User with Moment</label>
        <locationX>2782</locationX>
        <locationY>840</locationY>
        <inputAssignments>
            <field>Moment__c</field>
            <value>
                <elementReference>Create_Moment</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>535</locationX>
        <locationY>245</locationY>
        <connector>
            <targetReference>Is_Suppressed</targetReference>
        </connector>
        <object>Retool_User__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <variables>
        <name>CheckMQL</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>ContactID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>LeadID</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
