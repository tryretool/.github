<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>60.0</apiVersion>
    <assignments>
        <name>Add_parent_lead</name>
        <label>Add parent lead</label>
        <locationX>3126</locationX>
        <locationY>2698</locationY>
        <assignmentItems>
            <assignToReference>$Record.Parent_Lead__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Look_for_previous_partner_lead.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Has_parent_lead</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Account_from_Contact</name>
        <label>Set Account from Contact</label>
        <locationX>1491</locationX>
        <locationY>2694</locationY>
        <assignmentItems>
            <assignToReference>$Record.Prospect_Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Contact__r.AccountId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Account_is</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Account_from_Domain</name>
        <label>Set Account from Domain</label>
        <locationX>1978</locationX>
        <locationY>2892</locationY>
        <assignmentItems>
            <assignToReference>$Record.Prospect_Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Search_for_Domain.Matched_Account__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Account_is</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_attribution_date</name>
        <label>Set attribution date</label>
        <locationX>1419</locationX>
        <locationY>1090</locationY>
        <assignmentItems>
            <assignToReference>$Record.Attribution_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Type_is</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Contact</name>
        <label>Set Contact</label>
        <locationX>837</locationX>
        <locationY>2643</locationY>
        <assignmentItems>
            <assignToReference>$Record.Contact__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Contact_by_Email.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_account_by</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_create_stamps</name>
        <label>Set create stamps</label>
        <locationX>2342</locationX>
        <locationY>2656</locationY>
        <assignmentItems>
            <assignToReference>$Record.Employees_at_Create__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Prospect_Account__r.NumberOfEmployees</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Segment_at_Create__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Prospect_Account__r.Segment__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Record_Isf</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_defaults</name>
        <label>Set defaults</label>
        <locationX>991</locationX>
        <locationY>885</locationY>
        <assignmentItems>
            <assignToReference>$Record.Trigger__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_partner_type_setting.Label</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Attribution_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_partner_type_setting.Attribution_Type__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Partner_Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Partner_Relationship__r.Account__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Submitted_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Submitted_At__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>standard_name</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Record_is</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_defaults_from_partner_relationship_referral</name>
        <label>Set defaults from partner relationship (referral)</label>
        <locationX>1400</locationX>
        <locationY>1645</locationY>
        <assignmentItems>
            <assignToReference>$Record.Referral_First_Submit_Effective_Days__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Partner_Relationship__r.Referral_First_Submit_Effective_Days__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Referral_Resubmit_Effective_Days_c__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_fallback_referral_partner_relationship.Referral_Resubmit_Effective_Days__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_Last_Name_Populated</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_details_from_opportunity</name>
        <label>Set details from opportunity</label>
        <locationX>1449</locationX>
        <locationY>2535</locationY>
        <assignmentItems>
            <assignToReference>$Record.Prospect_Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Opportunity__r.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Business_Unit__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Opportunity__r.Business_Unit__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Account_is</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_is_resubmit</name>
        <label>Set is resubmit</label>
        <locationX>3519</locationX>
        <locationY>2901</locationY>
        <assignmentItems>
            <assignToReference>$Record.Referral_Is_Resubmission__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_partner_relationship_to_referral_triage</name>
        <label>Set partner relationship to referral triage</label>
        <locationX>1176</locationX>
        <locationY>741</locationY>
        <assignmentItems>
            <assignToReference>$Record.Partner_Relationship__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_fallback_referral_partner_relationship.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_partner_type_setting</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Split_Full_Name</name>
        <label>Split Full Name</label>
        <locationX>806</locationX>
        <locationY>2248</locationY>
        <assignmentItems>
            <assignToReference>$Record.Contact_Last_Name__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Calc_Last_Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Contact_First_Name__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Calc_First_Name</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_Contact_Blank</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Account_is</name>
        <label>Account is</label>
        <locationX>1974</locationX>
        <locationY>2690</locationY>
        <defaultConnector>
            <targetReference>Record_Isf</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>Set</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Prospect_Account__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.Prospect_Account__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_create_stamps</targetReference>
            </connector>
            <label>Set</label>
        </rules>
        <rules>
            <name>Changed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Prospect_Account__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_create_stamps</targetReference>
            </connector>
            <label>Changed</label>
        </rules>
    </decisions>
    <decisions>
        <name>Found_previous_partner_lead</name>
        <label>Found previous partner lead?</label>
        <locationX>2867</locationX>
        <locationY>2863</locationY>
        <defaultConnector>
            <targetReference>Has_parent_lead</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Look_for_previous_partner_lead</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_parent_lead</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_parent_lead</name>
        <label>Has parent lead?</label>
        <locationX>3266</locationX>
        <locationY>3000</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_has_parent</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Parent_Lead__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_is_resubmit</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Contact_Blank</name>
        <label>Is Contact Blank?</label>
        <locationX>986</locationX>
        <locationY>2343</locationY>
        <defaultConnector>
            <targetReference>Set_account_by</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Contact Populated</defaultConnectorLabel>
        <rules>
            <name>Created_from_Partner_Button</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Create_Method__c</leftValueReference>
                <operator>StartsWith</operator>
                <rightValue>
                    <stringValue>Opportunity - Partner Button</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_account_by</targetReference>
            </connector>
            <label>Created from Partner Button</label>
        </rules>
        <rules>
            <name>Contact_Blank</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Contact__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Contact_Email__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Contact_by_Email</targetReference>
            </connector>
            <label>Contact Blank</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Last_Name_Populated</name>
        <label>Is Last Name Populated?</label>
        <locationX>985</locationX>
        <locationY>2093</locationY>
        <defaultConnector>
            <targetReference>Is_Contact_Blank</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Last Name Populated</defaultConnectorLabel>
        <rules>
            <name>Last_Name_Blank</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Contact_Last_Name__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Contact_Full_Name__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Split_Full_Name</targetReference>
            </connector>
            <label>Last Name Blank</label>
        </rules>
    </decisions>
    <decisions>
        <name>New_from_Partner_Portal</name>
        <label>New from Partner Portal</label>
        <locationX>998</locationX>
        <locationY>334</locationY>
        <defaultConnector>
            <targetReference>Get_partner_type_setting</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CreatedById</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>005Du000000KCjxIAG</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_fallback_referral_partner_relationship</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Record_is</name>
        <label>Record is</label>
        <locationX>983</locationX>
        <locationY>1168</locationY>
        <defaultConnector>
            <targetReference>Is_Last_Name_Populated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Updated</defaultConnectorLabel>
        <rules>
            <name>New</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_attribution_date</targetReference>
            </connector>
            <label>New</label>
        </rules>
        <rules>
            <name>Partner_Relationship_Updated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Partner_Relationship__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Type_is</targetReference>
            </connector>
            <label>Partner Relationship Updated</label>
        </rules>
    </decisions>
    <decisions>
        <name>Record_Isf</name>
        <label>Record Is</label>
        <locationX>2393</locationX>
        <locationY>2999</locationY>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>New_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Referral</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Partner_Lead_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Submitted</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Contact__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Look_for_previous_partner_lead</targetReference>
            </connector>
            <label>Submitted Referral</label>
        </rules>
        <rules>
            <name>Any_Referral</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Referral</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Has_parent_lead</targetReference>
            </connector>
            <label>Any Referral</label>
        </rules>
    </decisions>
    <decisions>
        <name>Set_account_by</name>
        <label>Set account by</label>
        <locationX>997</locationX>
        <locationY>2925</locationY>
        <defaultConnector>
            <targetReference>Record_Isf</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Do not set</defaultConnectorLabel>
        <rules>
            <name>Opportunity</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Opportunity__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_details_from_opportunity</targetReference>
            </connector>
            <label>Opportunity</label>
        </rules>
        <rules>
            <name>Contact</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Contact__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Account_from_Contact</targetReference>
            </connector>
            <label>Contact</label>
        </rules>
        <rules>
            <name>Submitted_Email_Domain</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Contact_Email__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Search_for_Domain</targetReference>
            </connector>
            <label>Submitted Email Domain</label>
        </rules>
    </decisions>
    <decisions>
        <name>Type_is</name>
        <label>Type is</label>
        <locationX>1210</locationX>
        <locationY>1556</locationY>
        <defaultConnector>
            <targetReference>Is_Last_Name_Populated</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>Referral</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Referral</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_defaults_from_partner_relationship_referral</targetReference>
            </connector>
            <label>Referral</label>
        </rules>
    </decisions>
    <decisions>
        <name>Was_Contact_Found</name>
        <label>Was Contact Found?</label>
        <locationX>582</locationX>
        <locationY>2717</locationY>
        <defaultConnector>
            <targetReference>Set_account_by</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Contact Found</defaultConnectorLabel>
        <rules>
            <name>Contact_Found</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Contact_by_Email.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Contact</targetReference>
            </connector>
            <label>Contact Found</label>
        </rules>
    </decisions>
    <decisions>
        <name>Was_Domain_Map_Found</name>
        <label>Was Domain Map Found?</label>
        <locationX>1717</locationX>
        <locationY>2839</locationY>
        <defaultConnector>
            <targetReference>Account_is</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Domain Map Found</defaultConnectorLabel>
        <rules>
            <name>Found_Domain_Map</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Search_for_Domain.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Account_from_Domain</targetReference>
            </connector>
            <label>Found Domain Map</label>
        </rules>
    </decisions>
    <description>Adding attribution taxonomy</description>
    <environments>Default</environments>
    <formulas>
        <name>Calc_First_Name</name>
        <dataType>String</dataType>
        <expression>LEFT({!$Record.Contact_Full_Name__c}, FIND( &quot; &quot;, {!$Record.Contact_Full_Name__c} ) -1 )</expression>
    </formulas>
    <formulas>
        <name>Calc_Last_Name</name>
        <dataType>String</dataType>
        <expression>IF({!Calc_First_Name} = {!$Record.Contact_Full_Name__c}, &quot;[unknown]&quot;,
RIGHT({!$Record.Contact_Full_Name__c}, LEN({!$Record.Contact_Full_Name__c}) - FIND(&quot; &quot;, {!$Record.Contact_Full_Name__c})))</expression>
    </formulas>
    <formulas>
        <name>Convert_Website_To_Domain</name>
        <dataType>String</dataType>
        <expression>SUBSTITUTE(
    IF(
        FIND(
            &quot;/&quot;,
            IF(
                FIND(&quot;www.&quot;, {!$Record.Company_Website__c}) &gt; 0,
                IF(
                    FIND(&quot;//&quot;, {!$Record.Company_Website__c}) &gt; 0,
                    SUBSTITUTE({!$Record.Company_Website__c}, LEFT({!$Record.Company_Website__c}, FIND(&quot;//www.&quot;, {!$Record.Company_Website__c}) + 5), NULL),
                    {!$Record.Company_Website__c}
                ),
                IF(
                    FIND(&quot;//&quot;, {!$Record.Company_Website__c}) &gt; 0,
                    SUBSTITUTE({!$Record.Company_Website__c}, LEFT({!$Record.Company_Website__c}, FIND(&quot;//&quot;, {!$Record.Company_Website__c}) + 1), NULL),
                    {!$Record.Company_Website__c}
                )
            )
        ) &gt; 0, 
        LEFT(
            IF(
                FIND(&quot;www.&quot;, {!$Record.Company_Website__c}) &gt; 0,
                IF(
                    FIND(&quot;//&quot;, {!$Record.Company_Website__c}) &gt; 0,
                    SUBSTITUTE({!$Record.Company_Website__c}, LEFT({!$Record.Company_Website__c}, FIND(&quot;//www.&quot;,{!$Record.Company_Website__c}) + 5), NULL),
                    {!$Record.Company_Website__c}
                ),
                IF(
                    FIND(&quot;//&quot;, {!$Record.Company_Website__c}) &gt; 0,
                    SUBSTITUTE({!$Record.Company_Website__c}, LEFT({!$Record.Company_Website__c}, FIND(&quot;//&quot;,{!$Record.Company_Website__c}) + 1), NULL),
                    {!$Record.Company_Website__c}
                )
            ),
            FIND(
                &quot;/&quot;,
                IF(
                    FIND(&quot;www.&quot;, {!$Record.Company_Website__c}) &gt; 0,
                    IF(
                        FIND(&quot;//&quot;, {!$Record.Company_Website__c}) &gt; 0,
                        SUBSTITUTE({!$Record.Company_Website__c}, LEFT({!$Record.Company_Website__c}, FIND(&quot;//www.&quot;,{!$Record.Company_Website__c}) + 5), NULL),
                        {!$Record.Company_Website__c}
                    ),
                    IF(
                        FIND(&quot;//&quot;, {!$Record.Company_Website__c}) &gt; 0,
                        SUBSTITUTE({!$Record.Company_Website__c}, LEFT({!$Record.Company_Website__c}, FIND(&quot;//&quot;, {!$Record.Company_Website__c}) + 1), NULL),
                        {!$Record.Company_Website__c}
                    )
                )
            ) - 1
        ),
        IF(
            FIND(&quot;www.&quot;, {!$Record.Company_Website__c}) &gt; 0,
            IF(
                FIND(&quot;//&quot;, {!$Record.Company_Website__c}) &gt; 0,
                SUBSTITUTE({!$Record.Company_Website__c}, LEFT({!$Record.Company_Website__c}, FIND(&quot;//www.&quot;, {!$Record.Company_Website__c}) + 5), NULL),
                {!$Record.Company_Website__c}
            ),
            IF(
                FIND(&quot;//&quot;, {!$Record.Company_Website__c}) &gt; 0,
                SUBSTITUTE({!$Record.Company_Website__c}, LEFT({!$Record.Company_Website__c}, FIND(&quot;//&quot;, {!$Record.Company_Website__c}) + 1), NULL),
                {!$Record.Company_Website__c}
            )
        )
    ),
    &#39;www.&#39;, 
    &#39;&#39;
)</expression>
    </formulas>
    <formulas>
        <name>standard_name</name>
        <dataType>String</dataType>
        <expression>IF({!$Record.Partner_Relationship__r.Is_Triage_Fallback__c},&quot;Unknown&quot;,{!$Record.Partner_Relationship__r.Partner_DBA_Name__c})
&amp;&quot; (&quot;&amp;{!Get_partner_type_setting.Type_Short_Name__c}&amp;&quot;) - &quot;&amp;
LEFT(IF(ISBLANK({!$Record.Prospect_Account__c}),{!$Record.Company_Name__c},{!$Record.Prospect_Account__r.Name}),30)&amp;&quot; &quot;&amp;TEXT(MONTH({!$Record.Attribution_Date__c}))&amp;&quot;/&quot;&amp;TEXT(YEAR({!$Record.Attribution_Date__c}))</expression>
    </formulas>
    <interviewLabel>Partner Lead: Before Save Automations {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Partner Lead - Before Save Automations</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Contact_by_Email</name>
        <label>Get Contact by Email</label>
        <locationX>715</locationX>
        <locationY>2477</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Was_Contact_Found</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Email</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Contact_Email__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>AccountId</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_fallback_referral_partner_relationship</name>
        <label>Get fallback referral partner relationship</label>
        <locationX>1196</locationX>
        <locationY>496</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_partner_relationship_to_referral_triage</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Partner_Relationship_Record_Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Referral</stringValue>
            </value>
        </filters>
        <filters>
            <field>Is_Triage_Fallback__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Partner_Relationship__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_partner_type_setting</name>
        <label>Get partner type setting</label>
        <locationX>991</locationX>
        <locationY>729</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Set_defaults</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Record_Type_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Partner_Relationship__r.RecordTypeId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Partner_Type_Setting__mdt</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Look_for_previous_partner_lead</name>
        <label>Look for previous partner lead</label>
        <locationX>2667</locationX>
        <locationY>2846</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Found_previous_partner_lead</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Contact__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Contact__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Partner_Lead_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Approved</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Partner_Lead__c</object>
        <sortField>Submitted_Date__c</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Search_for_Domain</name>
        <label>Search for Domain</label>
        <locationX>1527</locationX>
        <locationY>2856</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Was_Domain_Map_Found</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Convert_Website_To_Domain</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Domain_Map__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>886</locationX>
        <locationY>50</locationY>
        <connector>
            <targetReference>New_from_Partner_Portal</targetReference>
        </connector>
        <object>Partner_Lead__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordBeforeSave</triggerType>
    </start>
    <status>Active</status>
</Flow>
