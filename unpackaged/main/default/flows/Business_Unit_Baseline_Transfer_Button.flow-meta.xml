<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>61.0</apiVersion>
    <assignments>
        <name>Build_baseline_in</name>
        <label>Build baseline in</label>
        <locationX>871</locationX>
        <locationY>1546</locationY>
        <assignmentItems>
            <assignToReference>opp_transfer_in.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>0055A00000ApunnQAB</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Owner_Role__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.User_Role__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Owner_Department__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Department__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Owner_Team__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Team__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Owner_Subteam__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Subteam__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Owner_Level__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Level__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Owner_Territory__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Territory__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Owner_Segment__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Opportunity_Segment__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Owner_Region__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Region__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Owner_Subregion__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Subregion__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Subtype__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Baseline Transfer - In</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.StageName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Closed Won</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Create_Method__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Baseline Transfer Button</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>0125A000001YaKtQAK</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Booking_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Standard</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.CloseDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Effective_Date</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Permission_Check__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Close_Method__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Baseline Transfer Button</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Originating_Opportunity__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_destination_booking_base.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Term_Number__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_destination_booking_base.Term_Number__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.AccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_destination_booking_base.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Segment__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_destination_booking_base.Segment__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Total_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Debook_Putback_Group_ID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Type</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Existing Business</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Business_Unit__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_destination_booking_base.Business_Unit__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Debook_Putback_Reason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Baseline Transfer</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Debook_Putback_Details__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Baseline_Transfer_Reason</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_in.Renewal_Baseline_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>transfer_amount_out</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_baseline_transfer_out</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Build_baseline_out</name>
        <label>Build baseline out</label>
        <locationX>843</locationX>
        <locationY>1377</locationY>
        <assignmentItems>
            <assignToReference>opp_transfer_out.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>0055A00000ApunnQAB</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Owner_Role__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.User_Role__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Owner_Department__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Department__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Owner_Team__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Team__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Owner_Subteam__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Subteam__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Owner_Level__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Level__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Owner_Territory__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Territory__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Owner_Segment__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Opportunity_Segment__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Owner_Region__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Region__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Owner_Subregion__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>roe_attribution.Subregion__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Subtype__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Baseline Transfer - Out</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.StageName</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Closed Won</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Create_Method__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Baseline Transfer Button</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>0125A000001YaKtQAK</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Booking_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Standard</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.CloseDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Effective_Date</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Permission_Check__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Close_Method__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Baseline Transfer Button</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Originating_Opportunity__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>origin_renewal.firstSelectedRow.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Term_Number__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>origin_renewal.firstSelectedRow.Term_Number__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.AccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>origin_renewal.firstSelectedRow.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Segment__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>origin_renewal.firstSelectedRow.Segment__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Total_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>transfer_amount_out</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Debook_Putback_Group_ID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Type</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Existing Business</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Business_Unit__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Debook_Putback_Reason__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Baseline Transfer</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opp_transfer_out.Debook_Putback_Details__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Baseline_Transfer_Reason</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Build_baseline_in</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Found_destination_booking</name>
        <label>Found destination booking?</label>
        <locationX>834</locationX>
        <locationY>1114</locationY>
        <defaultConnector>
            <targetReference>Did_not_find_valid_destination_opp</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_foun</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_destination_booking_base</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Found_destination_opp</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Origin_BU_has_open_renewal</name>
        <label>Origin BU has open renewal?</label>
        <locationX>1422</locationX>
        <locationY>1675</locationY>
        <defaultConnector>
            <targetReference>Origin_BU_has_open_renewal_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_origin_has_open_renewal</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>recordId.Open_Renewal__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Calc_baselines_origin_BU</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Origin_BU_has_open_renewal_0</name>
        <label>Origin BU has open renewal?</label>
        <locationX>1793</locationX>
        <locationY>1672</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_origin_has_open_renewal_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_destination_booking_base.Business_Unit__r.Open_Renewal__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Calc_baselines_destination_BU</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <dynamicChoiceSets>
        <name>all_active_bus</name>
        <dataType>String</dataType>
        <displayField>Name</displayField>
        <filterLogic>and</filterLogic>
        <filters>
            <field>BU_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Active</stringValue>
            </value>
        </filters>
        <filters>
            <field>Id</field>
            <operator>NotEqualTo</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </filters>
        <object>Business_Unit__c</object>
        <valueField>Id</valueField>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>choice_all_active_BUs</name>
        <collectionReference>Get_all_active_BUs</collectionReference>
        <dataType>String</dataType>
        <displayField>Name</displayField>
        <object>Business_Unit__c</object>
        <valueField>Id</valueField>
    </dynamicChoiceSets>
    <environments>Default</environments>
    <formulas>
        <name>transfer_amount_out</name>
        <dataType>Currency</dataType>
        <expression>{!Amount_of_Baseline_Transfer}*-1</expression>
        <scale>2</scale>
    </formulas>
    <interviewLabel>Business Unit - Baseline Transfer Button {!$Flow.CurrentDateTime}</interviewLabel>
    <label>BU - Baseline Transfer Button</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Create_baseline_transfer_in</name>
        <label>Create baseline transfer in</label>
        <locationX>1084</locationX>
        <locationY>1735</locationY>
        <connector>
            <targetReference>Success</targetReference>
        </connector>
        <inputReference>opp_transfer_in</inputReference>
    </recordCreates>
    <recordCreates>
        <name>Create_baseline_transfer_out</name>
        <label>Create baseline transfer out</label>
        <locationX>817</locationX>
        <locationY>1739</locationY>
        <connector>
            <targetReference>Create_baseline_transfer_in</targetReference>
        </connector>
        <inputReference>opp_transfer_out</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_active_ROE_rules</name>
        <label>Get active ROE rules</label>
        <locationX>868</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_renewal_opps_from_origin_BU</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Active</stringValue>
            </value>
        </filters>
        <filters>
            <field>Can_Own_Accounts__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>ROE_Rule__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_all_active_BUs</name>
        <label>Get all active BUs</label>
        <locationX>649</locationX>
        <locationY>655</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Configure_Baseline_Transfer</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>NotEqualTo</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>BU_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Active</stringValue>
            </value>
        </filters>
        <filters>
            <field>Business_Line__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Committed</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Business_Unit__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_destination_booking_base</name>
        <label>Get destination booking base</label>
        <locationX>843</locationX>
        <locationY>918</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Found_destination_booking</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Is_Booking_Base__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Business_Unit__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>destination_bu.selectedChoiceValues</elementReference>
            </value>
        </filters>
        <filters>
            <field>Term_Start_Date__c</field>
            <operator>LessThanOrEqualTo</operator>
            <value>
                <elementReference>Effective_Date</elementReference>
            </value>
        </filters>
        <filters>
            <field>Contract_End_Date__c</field>
            <operator>GreaterThanOrEqualTo</operator>
            <value>
                <elementReference>Effective_Date</elementReference>
            </value>
        </filters>
        <filters>
            <field>Debooked_deal__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Booking_Type__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Debook</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Opportunity</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_renewal_opps_from_origin_BU</name>
        <label>Get renewal opps from origin BU</label>
        <locationX>844</locationX>
        <locationY>564</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_all_active_BUs</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Business_Unit__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Is_Committed_Booking__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>StageName</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Churn</stringValue>
            </value>
        </filters>
        <filters>
            <field>Opportunity_Record_Type_Name__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Renewal</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Opportunity</object>
        <sortField>Term_Number__c</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <screens>
        <name>Configure_Baseline_Transfer</name>
        <label>Configure Baseline Transfer</label>
        <locationX>847</locationX>
        <locationY>752</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Get_destination_booking_base</targetReference>
        </connector>
        <fields>
            <name>header</name>
            <fieldText>&lt;p&gt;&lt;strong&gt;Origin Business Unit:&lt;/strong&gt; {!recordId.Name}&lt;/p&gt;&lt;p&gt;&lt;strong&gt;ARR:&lt;/strong&gt; ${!recordId.ARR__c}&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Account Owner:&lt;/strong&gt; {!recordId.Account__r.Owner.Full_Name_with_Role__c}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Configure_Baseline_Transfer_Section1</name>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Configure_Baseline_Transfer_Section1_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>Amount_of_Baseline_Transfer</name>
                    <dataType>Currency</dataType>
                    <defaultValue>
                        <elementReference>recordId.ARR__c</elementReference>
                    </defaultValue>
                    <fieldText>Amount of Baseline Transfer</fieldText>
                    <fieldType>InputField</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <scale>2</scale>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <fields>
                <name>Configure_Baseline_Transfer_Section1_Column2</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>Effective_Date</name>
                    <dataType>Date</dataType>
                    <defaultValue>
                        <elementReference>$Flow.CurrentDate</elementReference>
                    </defaultValue>
                    <fieldText>Effective Date</fieldText>
                    <fieldType>InputField</fieldType>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>6</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithoutHeader</regionContainerType>
        </fields>
        <fields>
            <name>Baseline_Transfer_Reason</name>
            <dataType>String</dataType>
            <fieldText>Baseline Transfer Reason</fieldText>
            <fieldType>InputField</fieldType>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Origin</name>
            <fieldText>Origin</fieldText>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Origin_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>origin_renewal</name>
                    <dataTypeMappings>
                        <typeName>T</typeName>
                        <typeValue>Opportunity</typeValue>
                    </dataTypeMappings>
                    <extensionName>flowruntime:datatable</extensionName>
                    <fieldType>ComponentInstance</fieldType>
                    <inputParameters>
                        <name>label</name>
                        <value>
                            <stringValue>Select renewal term</stringValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>selectionMode</name>
                        <value>
                            <stringValue>SINGLE_SELECT</stringValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>minRowSelection</name>
                        <value>
                            <numberValue>1.0</numberValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>shouldDisplayLabel</name>
                        <value>
                            <booleanValue>true</booleanValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>tableData</name>
                        <value>
                            <elementReference>Get_renewal_opps_from_origin_BU</elementReference>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>maxRowSelection</name>
                        <value>
                            <numberValue>1.0</numberValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>columns</name>
                        <value>
                            <stringValue>[{&quot;apiName&quot;:&quot;Name&quot;,&quot;guid&quot;:&quot;column-b27f&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:false,&quot;customHeaderLabel&quot;:&quot;&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;Name&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;Term_Number__c&quot;,&quot;guid&quot;:&quot;column-42fa&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Term #&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Term Number&quot;,&quot;type&quot;:&quot;number&quot;},{&quot;apiName&quot;:&quot;Term_Start_Date__c&quot;,&quot;guid&quot;:&quot;column-058c&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Start Date&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;Term Start Date&quot;,&quot;type&quot;:&quot;date-local&quot;},{&quot;apiName&quot;:&quot;Contract_End_Date__c&quot;,&quot;guid&quot;:&quot;column-359b&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;End Date&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:3,&quot;label&quot;:&quot;Term End Date&quot;,&quot;type&quot;:&quot;date-local&quot;}]</stringValue>
                        </value>
                    </inputParameters>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <storeOutputAutomatically>true</storeOutputAutomatically>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>12</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithHeader</regionContainerType>
        </fields>
        <fields>
            <name>Destination</name>
            <fieldText>Destination</fieldText>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Destination_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>destination_bu</name>
                    <choiceReferences>choice_all_active_BUs</choiceReferences>
                    <extensionName>flowruntime:choiceLookup</extensionName>
                    <fieldText>Select destination BU</fieldText>
                    <fieldType>ComponentChoice</fieldType>
                    <inputParameters>
                        <name>placeholder</name>
                        <value>
                            <stringValue>Pick destination BU...</stringValue>
                        </value>
                    </inputParameters>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <storeOutputAutomatically>true</storeOutputAutomatically>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>12</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithHeader</regionContainerType>
        </fields>
        <fields>
            <name>Attribution</name>
            <fieldText>Attribution</fieldText>
            <fieldType>RegionContainer</fieldType>
            <fields>
                <name>Attribution_Column1</name>
                <fieldType>Region</fieldType>
                <fields>
                    <name>manual_attribution</name>
                    <dataTypeMappings>
                        <typeName>T</typeName>
                        <typeValue>ROE_Rule__c</typeValue>
                    </dataTypeMappings>
                    <extensionName>flowruntime:datatable</extensionName>
                    <fieldType>ComponentInstance</fieldType>
                    <inputParameters>
                        <name>label</name>
                        <value>
                            <stringValue>Select the role to which this booking should be attributed</stringValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>selectionMode</name>
                        <value>
                            <stringValue>SINGLE_SELECT</stringValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>minRowSelection</name>
                        <value>
                            <numberValue>1.0</numberValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>tableData</name>
                        <value>
                            <elementReference>Get_active_ROE_rules</elementReference>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>shouldDisplayLabel</name>
                        <value>
                            <booleanValue>true</booleanValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>isShowSearchBar</name>
                        <value>
                            <booleanValue>true</booleanValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>maxRowSelection</name>
                        <value>
                            <numberValue>1.0</numberValue>
                        </value>
                    </inputParameters>
                    <inputParameters>
                        <name>columns</name>
                        <value>
                            <stringValue>[{&quot;apiName&quot;:&quot;Name&quot;,&quot;guid&quot;:&quot;column-6098&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Role Name&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:0,&quot;label&quot;:&quot;ROE Rules Name&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;Team__c&quot;,&quot;guid&quot;:&quot;column-f5bc&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Team&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:1,&quot;label&quot;:&quot;Team&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;Subteam__c&quot;,&quot;guid&quot;:&quot;column-b32d&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Subteam&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:2,&quot;label&quot;:&quot;Subteam&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;Level__c&quot;,&quot;guid&quot;:&quot;column-73c8&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Level&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:3,&quot;label&quot;:&quot;Level&quot;,&quot;type&quot;:&quot;text&quot;},{&quot;apiName&quot;:&quot;Territory__c&quot;,&quot;guid&quot;:&quot;column-6a05&quot;,&quot;editable&quot;:false,&quot;hasCustomHeaderLabel&quot;:true,&quot;customHeaderLabel&quot;:&quot;Territory&quot;,&quot;wrapText&quot;:true,&quot;order&quot;:4,&quot;label&quot;:&quot;Territory&quot;,&quot;type&quot;:&quot;text&quot;}]</stringValue>
                        </value>
                    </inputParameters>
                    <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
                    <isRequired>true</isRequired>
                    <outputParameters>
                        <assignToReference>roe_attribution</assignToReference>
                        <name>firstSelectedRow</name>
                    </outputParameters>
                </fields>
                <inputParameters>
                    <name>width</name>
                    <value>
                        <stringValue>12</stringValue>
                    </value>
                </inputParameters>
                <isRequired>false</isRequired>
            </fields>
            <isRequired>false</isRequired>
            <regionContainerType>SectionWithHeader</regionContainerType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Did_not_find_valid_destination_opp</name>
        <label>Did not find valid destination opp</label>
        <locationX>1101</locationX>
        <locationY>1106</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>not_found_header</name>
            <fieldText>&lt;p&gt;&lt;strong&gt;Error:&lt;/strong&gt; Could not find booking base on Business Unit ({!destination_bu.selectedChoiceValues}) where effective date ({!Effective_Date}) is between the start and end date.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Found_destination_opp</name>
        <label>Found destination opp</label>
        <locationX>697</locationX>
        <locationY>1241</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Build_baseline_out</targetReference>
        </connector>
        <fields>
            <name>found_opp</name>
            <fieldText>&lt;p&gt;The following destination booking base was found:&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://retool.lightning.force.com/{!Get_destination_booking_base.Id}&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;{!Get_destination_booking_base.Name}&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Proceed with baseline transfer to this booking?&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Success</name>
        <label>Success</label>
        <locationX>1301</locationX>
        <locationY>1684</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Origin_BU_has_open_renewal</targetReference>
        </connector>
        <fields>
            <name>Success_Screen</name>
            <fieldText>&lt;p&gt;Successfully created two opportunities:&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://retool.lightning.force.com/{!opp_transfer_out.Id}&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;Baseline Transfer - Out&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://retool.lightning.force.com/{!opp_transfer_in.Id}&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;Baseline Transfer - In&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>next_header</name>
            <fieldText>&lt;p&gt;Click &lt;strong&gt;Next&lt;/strong&gt; to re-calculate baselines on open renewals.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>743</locationX>
        <locationY>205</locationY>
        <connector>
            <targetReference>Get_active_ROE_rules</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Calc_baselines_destination_BU</name>
        <label>Calc baselines (destination BU)</label>
        <locationX>2023</locationX>
        <locationY>1559</locationY>
        <flowName>Opportunity_Update_Renewal_Baselines</flowName>
        <inputAssignments>
            <name>OppId</name>
            <value>
                <elementReference>Get_destination_booking_base.Business_Unit__r.Open_Renewal__c</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <subflows>
        <name>Calc_baselines_origin_BU</name>
        <label>Calc baselines (origin BU)</label>
        <locationX>1618</locationX>
        <locationY>1572</locationY>
        <connector>
            <targetReference>Origin_BU_has_open_renewal_0</targetReference>
        </connector>
        <flowName>Opportunity_Update_Renewal_Baselines</flowName>
        <inputAssignments>
            <name>OppId</name>
            <value>
                <elementReference>recordId.Open_Renewal__c</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <variables>
        <name>opp_transfer_in</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <name>opp_transfer_out</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Business_Unit__c</objectType>
    </variables>
    <variables>
        <name>roe_attribution</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ROE_Rule__c</objectType>
    </variables>
</Flow>
