<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>56.0</apiVersion>
    <assignments>
        <name>Clear_delivery_partner</name>
        <label>Clear delivery partner</label>
        <locationX>3393</locationX>
        <locationY>552</locationY>
        <assignmentItems>
            <assignToReference>$Record.Services_Project_Delivery_Partner__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Has_project_ID</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_defaults</name>
        <label>Set defaults</label>
        <locationX>489</locationX>
        <locationY>441</locationY>
        <assignmentItems>
            <assignToReference>$Record.Product_Tags__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Product2.Product_Tags__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Trigger__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Product__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Product2Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Product_Family__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Product2.Family</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Line_item_creator</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>set_defaults_legacy</name>
        <label>Set Legacy defaults</label>
        <locationX>1305</locationX>
        <locationY>167</locationY>
        <assignmentItems>
            <assignToReference>$Record.Term_Precision__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>0</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Included_Unit_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Default_platform_unit_type</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Manual_dates_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>set_defaults_revops</name>
        <label>Set RevOps defaults</label>
        <locationX>1316</locationX>
        <locationY>651</locationY>
        <assignmentItems>
            <assignToReference>$Record.Term_Precision__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>1</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Pricing_tiers</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_delivery_partner_d</name>
        <label>Set delivery partner</label>
        <locationX>3662</locationX>
        <locationY>305</locationY>
        <assignmentItems>
            <assignToReference>$Record.Services_Project_Delivery_Partner__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_partner_relationship.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Has_project_ID</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_included_units_to_default</name>
        <label>Set included units to default</label>
        <locationX>2825</locationX>
        <locationY>151</locationY>
        <assignmentItems>
            <assignToReference>$Record.Included_Units__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Product2.Included_Units__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Included_Unit_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Product2.Unit_Type__c</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_line_item_BU</name>
        <label>Set line item BU</label>
        <locationX>2371</locationX>
        <locationY>367</locationY>
        <assignmentItems>
            <assignToReference>$Record.Business_Unit__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Opportunity.Business_Unit__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_platform_line_item_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_project</name>
        <label>Set project</label>
        <locationX>4474</locationX>
        <locationY>192</locationY>
        <assignmentItems>
            <assignToReference>$Record.Services_Project__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Look_for_services_projects_by_ID.Id</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_project_ID</name>
        <label>Set project ID</label>
        <locationX>4222</locationX>
        <locationY>587</locationY>
        <assignmentItems>
            <assignToReference>$Record.Services_Project_Project_ID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Services_Project__r.Project_ID__c</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Set_term</name>
        <label>Set term</label>
        <locationX>2130</locationX>
        <locationY>372</locationY>
        <assignmentItems>
            <assignToReference>$Record.Term_mo__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Calculated_Term</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Opp_has_BU</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_start_end_dates</name>
        <label>Update start/end dates</label>
        <locationX>1549</locationX>
        <locationY>163</locationY>
        <assignmentItems>
            <assignToReference>$Record.ServiceDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Opportunity.Term_Start_Date__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.End_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Opportunity.Contract_End_Date__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_precision_manual</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_start_end_dates_0</name>
        <label>Update start/end dates</label>
        <locationX>1734</locationX>
        <locationY>780</locationY>
        <assignmentItems>
            <assignToReference>$Record.ServiceDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Opportunity.Term_Start_Date__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.End_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Opportunity.Contract_End_Date__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_precision_manual</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Found_partner_relationship</name>
        <label>Found partner relationship?</label>
        <locationX>3504</locationX>
        <locationY>327</locationY>
        <defaultConnector>
            <targetReference>Clear_delivery_partner</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_found_pr</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_partner_relationship</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_delivery_partner_d</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Found_project_by_ID</name>
        <label>Found project by ID?</label>
        <locationX>4236</locationX>
        <locationY>320</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_found_by_ID</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Look_for_services_projects_by_ID</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_project</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_delivery_partner_ID</name>
        <label>Has delivery partner ID?</label>
        <locationX>3167</locationX>
        <locationY>472</locationY>
        <defaultConnector>
            <targetReference>Clear_delivery_partner</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_partner_id</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Services_Project_Delivery_Partner_ID__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_partner_relationship</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_project_ID</name>
        <label>Has project ID?</label>
        <locationX>3719</locationX>
        <locationY>468</locationY>
        <defaultConnector>
            <targetReference>Has_Services_project</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Exclude</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Services_Project_Project_ID__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>EXCLUDE</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Has_Services_project</targetReference>
            </connector>
            <label>Exclude</label>
        </rules>
        <rules>
            <name>Yes_has_project_ID</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Services_Project_Project_ID__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Look_for_services_projects_by_ID</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Has_Services_project</name>
        <label>Has Services project?</label>
        <locationX>3997</locationX>
        <locationY>554</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_has_services_project</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Services_Project__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_project_ID</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Included_units_blank</name>
        <label>Included units blank?</label>
        <locationX>2571</locationX>
        <locationY>246</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_IU_blank</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Included_Units__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_included_units_to_default</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_new</name>
        <label>Is new?</label>
        <locationX>1124</locationX>
        <locationY>576</locationY>
        <defaultConnector>
            <targetReference>Is_precision_manual</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Existing</defaultConnectorLabel>
        <rules>
            <name>Is_new_record</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>set_defaults_revops</targetReference>
            </connector>
            <label>New</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_new_0</name>
        <label>Is new?</label>
        <locationX>1157</locationX>
        <locationY>284</locationY>
        <defaultConnector>
            <targetReference>Manual_dates_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Existing</defaultConnectorLabel>
        <rules>
            <name>Is_new_record_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>set_defaults_legacy</targetReference>
            </connector>
            <label>New</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_platform_line_item_0</name>
        <label>Is platform line item?</label>
        <locationX>2512</locationX>
        <locationY>478</locationY>
        <defaultConnector>
            <targetReference>Is_PS</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Product2.Product_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Platform</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Included_units_blank</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_precision_manual</name>
        <label>Is precision manual?</label>
        <locationX>1922</locationX>
        <locationY>478</locationY>
        <defaultConnector>
            <targetReference>Set_term</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_manual_precision</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Term_Precision__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Manual</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Opp_has_BU</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_PS</name>
        <label>Is PS?</label>
        <locationX>2906</locationX>
        <locationY>465</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Product_Family__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Professional Services</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Has_delivery_partner_ID</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Line_item_creator</name>
        <label>Line item creator?</label>
        <locationX>940</locationX>
        <locationY>437</locationY>
        <defaultConnector>
            <targetReference>Is_new_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Other</defaultConnectorLabel>
        <rules>
            <name>RevOps</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.CreatedById</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>0056e00000CnoAXAAZ</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_new</targetReference>
            </connector>
            <label>RevOps</label>
        </rules>
    </decisions>
    <decisions>
        <name>Manual_dates_0</name>
        <label>Manual dates?</label>
        <locationX>1437</locationX>
        <locationY>284</locationY>
        <defaultConnector>
            <targetReference>Update_start_end_dates</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_manual_dates_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Manual_Dates__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_precision_manual</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Opp_has_BU</name>
        <label>Opp has BU?</label>
        <locationX>2266</locationX>
        <locationY>483</locationY>
        <defaultConnector>
            <targetReference>Is_platform_line_item_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_opp_BU</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Opportunity.Business_Unit__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_line_item_BU</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Pricing_tiers</name>
        <label>Pricing tiers?</label>
        <locationX>1486</locationX>
        <locationY>658</locationY>
        <defaultConnector>
            <targetReference>Is_precision_manual</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_pricing</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Product2.Product_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Pricing Tiers</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_start_end_dates_0</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>Calculated_Term</name>
        <dataType>Number</dataType>
        <expression>ROUND(
 ({!$Record.End_Date__c}-{!$Record.ServiceDate}+1)/30.43685,
 VALUE(TEXT({!$Record.Term_Precision__c}))
)</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>Default_platform_unit_type</name>
        <dataType>String</dataType>
        <expression>IF(
ISPICKVAL({!$Record.Product2.Product_Type__c},&quot;Platform&quot;) &amp;&amp; ISPICKVAL({!$Record.Included_Unit_Type__c},&quot;&quot;),
&quot;users&quot;,
TEXT({!$Record.Included_Unit_Type__c})
)</expression>
    </formulas>
    <formulas>
        <name>opportunity_product</name>
        <dataType>String</dataType>
        <expression>{!$Record.OpportunityId}&amp;{!$Record.Product2Id}</expression>
    </formulas>
    <interviewLabel>Opportunity Product - Before Save Automations {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Opportunity Product - Before Save Automations</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_partner_relationship</name>
        <label>Get partner relationship</label>
        <locationX>3381</locationX>
        <locationY>324</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Found_partner_relationship</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Services_Project_Delivery_Partner_ID__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Partner_Relationship__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Look_for_services_projects_by_ID</name>
        <label>Look for services projects by ID</label>
        <locationX>3999</locationX>
        <locationY>343</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Found_project_by_ID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Project_ID__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Services_Project_Project_ID__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Services_Project__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>49</locationX>
        <locationY>371</locationY>
        <connector>
            <targetReference>Set_defaults</targetReference>
        </connector>
        <object>OpportunityLineItem</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordBeforeSave</triggerType>
    </start>
    <status>Active</status>
</Flow>
