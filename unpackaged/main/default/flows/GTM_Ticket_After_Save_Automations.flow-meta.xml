<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Post_to_slack</name>
        <label>Post to slack</label>
        <locationX>2951</locationX>
        <locationY>457</locationY>
        <actionName>Centro__NotifyFlow</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>buttons</name>
            <value>
                <stringValue>[{&quot;label&quot;:&quot;Watch ðŸ‘€&quot;,&quot;name&quot;:&quot;Watch&quot;,&quot;URL&quot;:&quot;{!slack_watch_button_url}&quot;,&quot;id&quot;:&quot;0.48811603400741044&quot;,&quot;invocation&quot;:&quot;REPLACE_ME&quot;,&quot;delete&quot;:false,&quot;deleteBtn&quot;:false,&quot;event&quot;:false,&quot;auth&quot;:true}]</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>channelId</name>
            <value>
                <stringValue>{!target_channel_id}</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>InterviewGuid</name>
            <value>
                <stringValue>{!$Flow.InterviewGuid}</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>message</name>
            <value>
                <stringValue>{!update_watchers_slack}</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>pinMessage</name>
            <value>
                <stringValue>false</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>postReply</name>
            <value>
                <stringValue>true</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>replyMessageTs</name>
            <value>
                <elementReference>target_message_ts</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>showCompactLayout</name>
            <value>
                <stringValue>false</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>startThread</name>
            <value>
                <stringValue>false</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>updateMessage</name>
            <value>
                <stringValue>false</stringValue>
            </value>
        </inputParameters>
        <nameSegment>Centro__NotifyFlow</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>Post_to_slack_0</name>
        <label>Post to slack</label>
        <locationX>2956</locationX>
        <locationY>640</locationY>
        <actionName>Centro__NotifyFlow</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>buttons</name>
            <value>
                <stringValue>[{&quot;label&quot;:&quot;Watch ðŸ‘€&quot;,&quot;name&quot;:&quot;Watch&quot;,&quot;URL&quot;:&quot;{!slack_watch_button_url}&quot;,&quot;id&quot;:&quot;0.7262544972181939&quot;,&quot;invocation&quot;:&quot;REPLACE_ME&quot;,&quot;delete&quot;:false,&quot;deleteBtn&quot;:false,&quot;event&quot;:false,&quot;auth&quot;:true}]</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>channelId</name>
            <value>
                <stringValue>{!target_channel_id}</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>InterviewGuid</name>
            <value>
                <stringValue>{!$Flow.InterviewGuid}</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>message</name>
            <value>
                <stringValue>{!update_watchers_slack}</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>pinMessage</name>
            <value>
                <stringValue>false</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>postReply</name>
            <value>
                <stringValue>false</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>showCompactLayout</name>
            <value>
                <stringValue>false</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>startThread</name>
            <value>
                <stringValue>false</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>updateMessage</name>
            <value>
                <stringValue>false</stringValue>
            </value>
        </inputParameters>
        <nameSegment>Centro__NotifyFlow</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <apiVersion>57.0</apiVersion>
    <assignments>
        <name>Add_watcher_to_list_0</name>
        <label>Add watcher to list</label>
        <locationX>2184</locationX>
        <locationY>380</locationY>
        <assignmentItems>
            <assignToReference>slack_follower_list</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>current_watcher_slack_with_space</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>slack_channel_invitees</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_through_watchers_0.User__r.Slack_ID__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_through_watchers_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Owner</name>
        <label>Assign Owner</label>
        <locationX>875</locationX>
        <locationY>220</locationY>
        <assignmentItems>
            <assignToReference>$Record.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Owner_User_Id.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Look_for_requestor_in_sharing</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Requestor</name>
        <label>Assign Requestor</label>
        <locationX>1311</locationX>
        <locationY>483</locationY>
        <assignmentItems>
            <assignToReference>$Record.Requestor__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Request_User_Id.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Owner_User_Id</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_channel_and_TS</name>
        <label>Set channel and TS</label>
        <locationX>2567</locationX>
        <locationY>554</locationY>
        <assignmentItems>
            <assignToReference>target_channel_id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Linked_Channel_ID__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>target_message_ts</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Linked_Message_TS__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Reply_to_thread_or_channel</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_defaults</name>
        <label>Set defaults</label>
        <locationX>552</locationX>
        <locationY>603</locationY>
        <assignmentItems>
            <assignToReference>$Record.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ticket_name</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Record_is</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Found_linked_conversation</name>
        <label>Found linked conversation?</label>
        <locationX>2351</locationX>
        <locationY>557</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_found_linked</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Linked_Channel_ID__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Complete</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_channel_and_TS</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_watcher_requestor_or_owner_0</name>
        <label>Is watcher requestor or owner?</label>
        <locationX>2011</locationX>
        <locationY>381</locationY>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_skip_0</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>Loop_through_watchers_0.User__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>$Record.OwnerId</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Loop_through_watchers_0.User__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>$Record.Requestor__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_watcher_to_list_0</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Owner_Found</name>
        <label>Owner Found?</label>
        <locationX>1091</locationX>
        <locationY>173</locationY>
        <defaultConnector>
            <targetReference>Assign_Owner</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Yes</defaultConnectorLabel>
        <rules>
            <name>No_Owner</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Owner_User_Id.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Look_for_requestor_in_sharing</targetReference>
            </connector>
            <label>No</label>
        </rules>
    </decisions>
    <decisions>
        <name>Post_to_slack_dec_0</name>
        <label>Post to slack?</label>
        <locationX>1775</locationX>
        <locationY>606</locationY>
        <defaultConnectorLabel>None</defaultConnectorLabel>
        <rules>
            <name>Run_new_ticket_slack_automations_dec</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Run_New_Ticket_Slack_Automations__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>Run new ticket slack automations?</label>
        </rules>
        <rules>
            <name>Major_Change_post</name>
            <conditionLogic>(1 AND 4) OR (2 AND 3)</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Is_Blocked__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Is_Blocked__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Complete</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_watchers_immediate</targetReference>
            </connector>
            <label>Major Change</label>
        </rules>
    </decisions>
    <decisions>
        <name>Record_is</name>
        <label>Record is</label>
        <locationX>679</locationX>
        <locationY>605</locationY>
        <defaultConnector>
            <targetReference>Update_record_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Updated</defaultConnectorLabel>
        <rules>
            <name>Requestor_Owner_Is_Centro</name>
            <conditionLogic>(1 AND 2) OR (3 AND 4)</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Requestor__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>0056e00000CgOFmAAN</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Requestor_Slack_ID__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.OwnerId</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>0056e00000CgOFmAAN</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Owner_Slack_ID__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Request_User_Id</targetReference>
            </connector>
            <label>Requestor/Owner Is Centro</label>
        </rules>
        <rules>
            <name>New</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Look_for_requestor_in_sharing</targetReference>
            </connector>
            <label>New</label>
        </rules>
        <rules>
            <name>Requestor_Updated</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Requestor__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Look_for_requestor_in_sharing</targetReference>
            </connector>
            <label>Requestor Updated</label>
        </rules>
        <rules>
            <name>Completed_Contract_Restructure</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Complete</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Status__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Subtype__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Contract Restructure</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Debook_Putback_Ticket</targetReference>
            </connector>
            <label>Completed Contract Restructure</label>
        </rules>
    </decisions>
    <decisions>
        <name>Reply_to_thread_or_channel</name>
        <label>Reply to thread or channel?</label>
        <locationX>2731</locationX>
        <locationY>556</locationY>
        <defaultConnector>
            <targetReference>Post_to_slack_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Channel</defaultConnectorLabel>
        <rules>
            <name>Thread</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Linked_Message_TS__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Post_to_slack</targetReference>
            </connector>
            <label>Thread</label>
        </rules>
    </decisions>
    <decisions>
        <name>Requestor_already_has_sharing</name>
        <label>Requestor already has sharing?</label>
        <locationX>1442</locationX>
        <locationY>50</locationY>
        <defaultConnector>
            <targetReference>Create_sharing_record_for_requestor</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Look_for_requestor_in_sharing</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_record_0</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Requestor_Found</name>
        <label>Requestor Found?</label>
        <locationX>1087</locationX>
        <locationY>429</locationY>
        <defaultConnector>
            <targetReference>Assign_Requestor</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Yes</defaultConnectorLabel>
        <rules>
            <name>No_Requestor</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Request_User_Id.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Owner_User_Id</targetReference>
            </connector>
            <label>No</label>
        </rules>
    </decisions>
    <description>Adding truncation logic to prevent &#39;STRING TOO LONG&#39; errors when creating debook/putback tickets.</description>
    <environments>Default</environments>
    <formulas>
        <name>current_month_year</name>
        <dataType>String</dataType>
        <expression>CASE(MONTH({!$Flow.CurrentDate}),
1,&quot;jan&quot;,
2,&quot;feb&quot;,
3,&quot;mar&quot;,
4,&quot;apr&quot;,
5,&quot;may&quot;,
6,&quot;jun&quot;,
7,&quot;jul&quot;,
8,&quot;aug&quot;,
9,&quot;sep&quot;,
10,&quot;oct&quot;,
11,&quot;nov&quot;,
12,&quot;dec&quot;,
NULL
)&amp;RIGHT(TEXT(YEAR({!$Flow.CurrentDate})),2)</expression>
    </formulas>
    <formulas>
        <name>current_watcher_slack_with_space</name>
        <dataType>String</dataType>
        <expression>{!Loop_through_watchers_0.User__r.Slack_Mention_Handle_Only__c}&amp;&quot; &quot;</expression>
    </formulas>
    <formulas>
        <name>debook_putback_name</name>
        <dataType>String</dataType>
        <expression>&quot;Debook/Putback: &quot; + IF( LEN( {!$Record.Opportunity__r.Name} ) &gt; 34, LEFT( {!$Record.Opportunity__r.Account.Account_Name_Compiled__c}, 34) , {!$Record.Opportunity__r.Name} )</expression>
    </formulas>
    <formulas>
        <name>due_date_formatted</name>
        <dataType>String</dataType>
        <expression>TEXT(MONTH({!$Record.Due_Date__c}))&amp;&quot;/&quot;&amp;TEXT(DAY({!$Record.Due_Date__c}))&amp;&quot;/&quot;&amp;TEXT(YEAR({!$Record.Due_Date__c}))</expression>
    </formulas>
    <formulas>
        <name>due_date_formatted_text</name>
        <dataType>String</dataType>
        <expression>IF(
 {!$Record.Days_Until_Due__c}=0,
 &quot;:exclamation: due today&quot;,
 IF(
  {!$Record.Days_Until_Due__c}&lt;0,
  &quot;:exclamation: due &quot;&amp;TEXT({!$Record.Days_Until_Due__c}*-1)&amp;&quot; days ago&quot;,
  &quot;due in &quot;&amp;TEXT({!$Record.Days_Until_Due__c})&amp;&quot; days&quot;
 )
)</expression>
    </formulas>
    <formulas>
        <name>due_date_prior_formatted</name>
        <dataType>String</dataType>
        <expression>TEXT(MONTH({!$Record__Prior.Due_Date__c}))&amp;&quot;/&quot;&amp;TEXT(DAY({!$Record__Prior.Due_Date__c}))&amp;&quot;/&quot;&amp;TEXT(YEAR({!$Record__Prior.Due_Date__c}))</expression>
    </formulas>
    <formulas>
        <name>is_private_channel</name>
        <dataType>Boolean</dataType>
        <expression>IF(CASE({!$Record.Ticket_Definition__r.Channel_Visibility_Default__c},
 &quot;Private&quot;,1,
 &quot;Public&quot;,0,
 0
)=1,TRUE,FALSE)</expression>
    </formulas>
    <formulas>
        <name>next_step_date_formatted</name>
        <dataType>String</dataType>
        <expression>IF(ISBLANK({!$Record.Next_Step_Date__c}),NULL,
TEXT(MONTH({!$Record.Next_Step_Date__c}))&amp;&quot;/&quot;&amp;TEXT(DAY({!$Record.Next_Step_Date__c}))&amp;&quot;/&quot;&amp;TEXT(YEAR({!$Record.Next_Step_Date__c})))</expression>
    </formulas>
    <formulas>
        <name>private_slack_channel_name</name>
        <dataType>String</dataType>
        <expression>LOWER(&quot;GT&quot;&amp;{!$Record.Index__c}&amp;&quot;-&quot;&amp;{!$Record.Ticket_Definition__r.Type_Short_Name__c}&amp;&quot;-&quot;&amp;{!current_month_year}&amp;&quot;-&quot;&amp;{!$Record.Short_Name__c})</expression>
    </formulas>
    <formulas>
        <name>slack_account</name>
        <dataType>String</dataType>
        <expression>IF(
  NOT(ISBLANK({!$Record.Account__c})),
  &quot;*Account:* &quot; &amp; &quot;&lt;https://retool.lightning.force.com/&quot; &amp;{!$Record.Account__c}&amp;&quot; | &quot;&amp;{!$Record.Account__r.Account_Name_Compiled__c} &amp; &quot;&gt; &quot; &amp; TEXT({!$Record.Account__r.Segment__c})&amp;BR(),
  NULL
)</expression>
    </formulas>
    <formulas>
        <name>slack_blockers</name>
        <dataType>String</dataType>
        <expression>IF({!$Record.Is_Blocked__c},&quot;*Blockers:* &quot;&amp;{!$Record.Blockers__c}&amp;BR(),NULL)</expression>
    </formulas>
    <formulas>
        <name>slack_due_date</name>
        <dataType>String</dataType>
        <expression>&quot;*Due Date:* &quot;&amp;
IF(ISCHANGED({!$Record.Due_Date__c}),{!due_date_prior_formatted}&amp;&quot; :arrow_right: &quot;,NULL) &amp;
{!due_date_formatted}</expression>
    </formulas>
    <formulas>
        <name>slack_followers_formatted</name>
        <dataType>String</dataType>
        <expression>&quot;cc: &quot;&amp;{!slack_follower_list}</expression>
    </formulas>
    <formulas>
        <name>slack_opportunity</name>
        <dataType>String</dataType>
        <expression>IF(
  NOT(ISBLANK({!$Record.Opportunity__c})),
  &quot;*Opportunity:* &quot; &amp; &quot;&lt;https://retool.lightning.force.com/&quot; &amp;{!$Record.Opportunity__r.Id}&amp;&quot; | &quot;&amp;{!$Record.Opportunity__r.Name} &amp; &quot;&gt; (&quot; &amp; TEXT({!$Record.Opportunity__r.Segment__c})&amp;&quot;) &quot;&amp;IF(ISBLANK({!$Record.Deal_Desk_Link__c}),NULL,&quot;(&lt;&quot;&amp;{!$Record.Deal_Desk_Link__c}&amp;&quot;|Deal Desk Link&gt;)&quot;)&amp;BR(),
NULL
)</expression>
    </formulas>
    <formulas>
        <name>slack_owner</name>
        <dataType>String</dataType>
        <expression>&quot;*Owner:* &quot;&amp;
IF(ISCHANGED({!$Record.OwnerId}),{!$Record__Prior.Owner:User.Slack_Mention_With_Role_Full_Name__c}&amp;&quot; :arrow_right: &quot;,NULL) &amp;
{!$Record.Owner:User.Slack_Mention_With_Role_Full_Name__c}</expression>
    </formulas>
    <formulas>
        <name>slack_priority</name>
        <dataType>String</dataType>
        <expression>&quot;*Priority:* &quot;&amp;
IF(ISCHANGED({!$Record.Priority__c}),TEXT({!$Record__Prior.Priority__c})&amp;&quot; :arrow_right: &quot;,NULL) &amp;
TEXT({!$Record.Priority__c})</expression>
    </formulas>
    <formulas>
        <name>slack_requestor</name>
        <dataType>String</dataType>
        <expression>&quot;*Requestor:* &quot;&amp;
IF(ISCHANGED({!$Record.OwnerId}),{!$Record__Prior.Requestor__r.Slack_Mention_With_Role_Full_Name__c}&amp;&quot; :arrow_right: &quot;,NULL) &amp;
{!$Record.Requestor__r.Slack_Mention_With_Role_Full_Name__c}</expression>
    </formulas>
    <formulas>
        <name>slack_status</name>
        <dataType>String</dataType>
        <expression>&quot;*Status:* &quot;&amp;
IF(ISCHANGED({!$Record.Status__c}),TEXT({!$Record__Prior.Status__c})&amp;&quot; :arrow_right: &quot;,NULL) &amp;
TEXT({!$Record.Status__c})</expression>
    </formulas>
    <formulas>
        <name>slack_watch_button_url</name>
        <dataType>String</dataType>
        <expression>&quot;https://retool.lightning.force.com/flow/GTM_Ticket_Watch_Button?gtm_ticket_id=&quot;&amp;{!$Record.Id}</expression>
    </formulas>
    <formulas>
        <name>ticket_name</name>
        <dataType>String</dataType>
        <expression>&quot;GT&quot;&amp;{!$Record.Index__c}&amp;&quot;-&quot;&amp;{!$Record.Type_Short_Name__c}&amp;&quot; &quot;&amp;IF(NOT(ISBLANK({!$Record.Blockers__c})),&quot;[B] &quot;,NULL)&amp;&quot; &quot;&amp;{!$Record.Short_Name__c}&amp;&quot; &quot;&amp;TEXT(MONTH({!$Record.Close_Date__c}))&amp;&quot;/&quot;&amp;TEXT(YEAR({!$Record.Close_Date__c}))</expression>
    </formulas>
    <interviewLabel>GTM Ticket - After Save Automations {!$Flow.CurrentDateTime} {!$Record.Name}</interviewLabel>
    <label>GTM Ticket - After Save Automations</label>
    <loops>
        <name>Loop_through_watchers_0</name>
        <label>Loop through watchers</label>
        <locationX>2108</locationX>
        <locationY>608</locationY>
        <collectionReference>Get_watchers_immediate</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Is_watcher_requestor_or_owner_0</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Found_linked_conversation</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Debook_Putback_Ticket</name>
        <label>Create Debook/Putback Ticket</label>
        <locationX>1265</locationX>
        <locationY>781</locationY>
        <connector>
            <targetReference>Update_record_0</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Update_record_0</targetReference>
        </faultConnector>
        <inputAssignments>
            <field>Account__c</field>
            <value>
                <elementReference>$Record.Account__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Beneficiary_Teams__c</field>
            <value>
                <elementReference>$Record.Beneficiary_Teams__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Close_Date__c</field>
            <value>
                <elementReference>$Record.Opportunity__r.Term_Start_Date__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Due_Date__c</field>
            <value>
                <elementReference>$Record.Opportunity__r.Term_Start_Date__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Estimated_Sprint__c</field>
            <value>
                <elementReference>$Record.Estimated_Sprint__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Linked_Channel_ID__c</field>
            <value>
                <stringValue>C053RGH9KT3</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Opportunity__c</field>
            <value>
                <elementReference>$Record.Opportunity__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>$Record.OwnerId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Problem__c</field>
            <value>
                <elementReference>debook_putback_context</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Requestor__c</field>
            <value>
                <elementReference>$Record.Requestor__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Name__c</field>
            <value>
                <elementReference>debook_putback_name</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Story_Points__c</field>
            <value>
                <stringValue>1</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subtype__c</field>
            <value>
                <stringValue>Debook/Putback</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Ticket_Definition__c</field>
            <value>
                <stringValue>a51Qo00000NLE1CIAX</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type__c</field>
            <value>
                <stringValue>Deal Desk</stringValue>
            </value>
        </inputAssignments>
        <object>GTM_Ticket__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Create_sharing_record_for_requestor</name>
        <label>Create sharing record for requestor</label>
        <locationX>1765</locationX>
        <locationY>341</locationY>
        <connector>
            <targetReference>Update_record_0</targetReference>
        </connector>
        <inputAssignments>
            <field>AccessLevel</field>
            <value>
                <stringValue>Edit</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ParentId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RowCause</field>
            <value>
                <stringValue>Manual</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UserOrGroupId</field>
            <value>
                <elementReference>$Record.Requestor__c</elementReference>
            </value>
        </inputAssignments>
        <object>GTM_Ticket__Share</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_Owner_User_Id</name>
        <label>Get Owner User Id</label>
        <locationX>1303</locationX>
        <locationY>172</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Owner_Found</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Centro__Slack_UserId__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Owner_Slack_ID__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Request_User_Id</name>
        <label>Get Request User Id</label>
        <locationX>930</locationX>
        <locationY>427</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Requestor_Found</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Centro__Slack_UserId__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Requestor_Slack_ID__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_watchers_immediate</name>
        <label>Get watchers</label>
        <locationX>1963</locationX>
        <locationY>608</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_through_watchers_0</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>GTM_Ticket__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Notify__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>GTM_Ticket_Watcher__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Look_for_requestor_in_sharing</name>
        <label>Look for requestor in sharing</label>
        <locationX>686</locationX>
        <locationY>59</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Requestor_already_has_sharing</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ParentId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>UserOrGroupId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Requestor__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>GTM_Ticket__Share</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_record_0</name>
        <label>Update record</label>
        <locationX>1652</locationX>
        <locationY>604</locationY>
        <connector>
            <targetReference>Post_to_slack_dec_0</targetReference>
        </connector>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>50</locationX>
        <locationY>784</locationY>
        <connector>
            <targetReference>Set_defaults</targetReference>
        </connector>
        <object>GTM_Ticket__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <textTemplates>
        <name>call_subflow_json</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>{ 
 &quot;channel_name&quot; : &quot;{!private_slack_channel_name}&quot;,
 &quot;invitee_list&quot; : &quot;{!slack_channel_invitees}&quot;,
 &quot;is_private&quot; : {!is_private_channel},
 &quot;record_id_to_link&quot; : &quot;{!$Record.Id}&quot;
}</text>
    </textTemplates>
    <textTemplates>
        <name>debook_putback_context</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>Process Debook/Putback for the contract restructure if the deal in question is closed won. If the deal is still open, please work with the sales rep to reconfigure the renewal dates if the contract restructure has been pushed out, or reset the renewal dates if the contract restructure is no longer applicable.
Contract Restructure Context:
{!$Record.Problem__c}</text>
    </textTemplates>
    <textTemplates>
        <name>new_ticket_slack</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>:page_with_curl: *New GTM Ticket:* &lt;https://retool.lightning.force.com/{!$Record.Id}|{!$Record.Name}&gt; :page_with_curl:
*{!$Record.Type__c} | {!$Record.Subtype__c} | {!$Record.Priority__c} | {!$Record.Size__c}*
{!slack_account}{!slack_opportunity}
*Due Date*: {!due_date_formatted} {!due_date_formatted_text})
*Requestor:* {!$Record.Requestor__r.Slack_Mention_With_Role_Full_Name__c}
*Assigned:* {!$Record.Owner:User.Slack_Mention_With_Role_Full_Name__c}</text>
    </textTemplates>
    <textTemplates>
        <name>update_watchers_slack</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>:bulb: *Ticket Updated:* &lt;https://retool.lightning.force.com/{!$Record.Id}|{!$Record.Name}&gt; :bulb:
{!slack_owner}
{!slack_requestor}
{!slack_status}
{!slack_priority}
{!slack_due_date}
*Next Step ({!next_step_date_formatted}):* {!$Record.Next_Step__c}
{!slack_blockers}{!slack_followers_formatted}</text>
    </textTemplates>
    <triggerOrder>1</triggerOrder>
    <variables>
        <name>slack_channel_invitees</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>slack_follower_list</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>target_channel_id</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>target_message_ts</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
